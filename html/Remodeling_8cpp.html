<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: users_modules/bone_remodelling/src/impl/Remodeling.cpp File Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <script>
    window.MathJax = {
      tex: {
        tags: 'all', // Enables equation numbering
      },
      loader: {
        load: ['[tex]/boldsymbol']
      }
    };
  </script>
  <script type="text/javascript " src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.15.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4fdd23f46654bee42f0ef7ae5010b806.html">users_modules</a></li><li class="navelem"><a class="el" href="dir_fb5c63dd700118cee7b42961855ef6af.html">bone_remodelling</a></li><li class="navelem"><a class="el" href="dir_46976321b0dc8f099143d0820ca48a24.html">src</a></li><li class="navelem"><a class="el" href="dir_be9e7437eb0455efa75463390a29e909.html">impl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle"><div class="title">Remodeling.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;boost/program_options.hpp&gt;</code><br />
<code>#include &lt;<a class="el" href="BasicFiniteElements_8hpp_source.html">BasicFiniteElements.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="ElasticMaterials_8hpp_source.html">ElasticMaterials.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="Remodeling_8hpp_source.html">Remodeling.hpp</a>&gt;</code><br />
</div>
<p><a href="Remodeling_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceBoneRemodeling" id="r_namespaceBoneRemodeling"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBoneRemodeling.html">BoneRemodeling</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0acc90838d2c5c8e49a09305d488779a" id="r_a0acc90838d2c5c8e49a09305d488779a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Remodeling_8cpp.html#a0acc90838d2c5c8e49a09305d488779a">TENSOR1_VEC_PTR</a>(VEC)&#160;&#160;&#160;&amp;VEC[0], &amp;VEC[1], &amp;VEC[2]</td></tr>
<tr class="separator:a0acc90838d2c5c8e49a09305d488779a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a882b61442aebc50fe467fe15a09ee85c" id="r_a882b61442aebc50fe467fe15a09ee85c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Remodeling_8cpp.html#a882b61442aebc50fe467fe15a09ee85c">SYMMETRIC_TENSOR4_MAT_PTR</a>(MAT)</td></tr>
<tr class="separator:a882b61442aebc50fe467fe15a09ee85c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff752f795f2d1fdbee680e2e1630d50c" id="r_aff752f795f2d1fdbee680e2e1630d50c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Remodeling_8cpp.html#aff752f795f2d1fdbee680e2e1630d50c">TENSOR4_MAT_PTR</a>(MAT)&#160;&#160;&#160;&amp;MAT(0, 0), MAT.size2()</td></tr>
<tr class="separator:aff752f795f2d1fdbee680e2e1630d50c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a582835fd072f2ee1a3370455cf2b57cc" id="r_a582835fd072f2ee1a3370455cf2b57cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Remodeling_8cpp.html#a582835fd072f2ee1a3370455cf2b57cc">TENSOR2_MAT_PTR</a>(MAT)</td></tr>
<tr class="separator:a582835fd072f2ee1a3370455cf2b57cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f20638920306c93091822d641af4749" id="r_a4f20638920306c93091822d641af4749"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Remodeling_8cpp.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a>(MAT)&#160;&#160;&#160;  &amp;MAT(0, 0), &amp;MAT(0, 1), &amp;MAT(0, 2), &amp;MAT(0, 3), &amp;MAT(0, 4), &amp;MAT(0, 5)</td></tr>
<tr class="separator:a4f20638920306c93091822d641af4749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a80843c43c1fe98a79754f2051a2001" id="r_a0a80843c43c1fe98a79754f2051a2001"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Remodeling_8cpp.html#a0a80843c43c1fe98a79754f2051a2001">SYMMETRIC_TENSOR2_VEC_PTR</a>(VEC)&#160;&#160;&#160;  &amp;VEC[0], &amp;VEC[1], &amp;VEC[2], &amp;VEC[3], &amp;VEC[4], &amp;VEC[5]</td></tr>
<tr class="separator:a0a80843c43c1fe98a79754f2051a2001"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4f20638920306c93091822d641af4749" name="a4f20638920306c93091822d641af4749"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f20638920306c93091822d641af4749">&#9670;&#160;</a></span>SYMMETRIC_TENSOR2_MAT_PTR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SYMMETRIC_TENSOR2_MAT_PTR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">MAT</td><td>)</td>
          <td>&#160;&#160;&#160;  &amp;MAT(0, 0), &amp;MAT(0, 1), &amp;MAT(0, 2), &amp;MAT(0, 3), &amp;MAT(0, 4), &amp;MAT(0, 5)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Remodeling_8cpp_source.html#l00054">54</a> of file <a class="el" href="Remodeling_8cpp_source.html">Remodeling.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   59</span>                         {</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::CommonData::getParameters() {</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  PetscBool flg_config = PETSC_FALSE;</div>
<div class="line"><span class="lineno">   64</span>  is_atom_testing = PETSC_FALSE;</div>
<div class="line"><span class="lineno">   65</span>  with_adol_c = PETSC_FALSE;</div>
<div class="line"><span class="lineno">   66</span>  <span class="keywordtype">char</span> my_config_file_name[255];</div>
<div class="line"><span class="lineno">   67</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a> = 5.0e+9; <span class="comment">// Set here some typical value for bone 5 GPa</span></div>
<div class="line"><span class="lineno">   68</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a> = 0.3;    <span class="comment">// Set here some typical value for bone</span></div>
<div class="line"><span class="lineno">   69</span>  <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = 4.0e-5;       <span class="comment">// Set here some typical value for bone. days/ m2 // this</span></div>
<div class="line"><span class="lineno">   70</span>                    <span class="comment">// parameters governs how fast we can achieve equilibrium</span></div>
<div class="line"><span class="lineno">   71</span>  <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> = 3.25;         <span class="comment">// Set some parameter typical for bone</span></div>
<div class="line"><span class="lineno">   72</span>  <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = 2.25;         <span class="comment">// Set Some parameter typical for bone</span></div>
<div class="line"><span class="lineno">   73</span>  rHo_ref = 1000;   <span class="comment">// Set Some parameter typical for bone. kg/m3</span></div>
<div class="line"><span class="lineno">   74</span>  pSi_ref = 2.75e4; <span class="comment">// Set Some parameter typical for bone. energy / volume unit</span></div>
<div class="line"><span class="lineno">   75</span>                    <span class="comment">// J/m3 = Pa</span></div>
<div class="line"><span class="lineno">   76</span>  rHo_max = rHo_ref + 0.5 * rHo_ref;</div>
<div class="line"><span class="lineno">   77</span>  rHo_min = rHo_ref - 0.5 * rHo_ref;</div>
<div class="line"><span class="lineno">   78</span>  b = 0;</div>
<div class="line"><span class="lineno">   79</span>  R0 = 0.0; <span class="comment">// Set Some parameter typical for bone.</span></div>
<div class="line"><span class="lineno">   80</span>  cUrrent_psi = 0.0;</div>
<div class="line"><span class="lineno">   81</span>  cUrrent_mass = 0.0;</div>
<div class="line"><span class="lineno">   82</span>  nOremodellingBlock = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   83</span>  less_post_proc = PETSC_FALSE;</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">   86</span>  PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Bone remodeling parameters&quot;</span>,</div>
<div class="line"><span class="lineno">   87</span>                           <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>  <span class="comment">// config file</span></div>
<div class="line"><span class="lineno">   90</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsString(<span class="stringliteral">&quot;-my_config&quot;</span>, <span class="stringliteral">&quot;configuration file name&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">   91</span>                            <span class="stringliteral">&quot;my_config.in&quot;</span>, my_config_file_name, 255,</div>
<div class="line"><span class="lineno">   92</span>                            &amp;flg_config);</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordflow">if</span> (flg_config) {</div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Config file: %s loaded.\n&quot;</span>,</div>
<div class="line"><span class="lineno">   96</span>                       my_config_file_name);</div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">   98</span>      ifstream ini_file(my_config_file_name);</div>
<div class="line"><span class="lineno">   99</span>      <span class="keywordflow">if</span> (!ini_file.is_open()) {</div>
<div class="line"><span class="lineno">  100</span>        SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;*** -my_config does not exist ***&quot;</span>);</div>
<div class="line"><span class="lineno">  101</span>      }</div>
<div class="line"><span class="lineno">  102</span>      po::variables_map vm;</div>
<div class="line"><span class="lineno">  103</span>      po::options_description config_file_options;</div>
<div class="line"><span class="lineno">  104</span>      <span class="comment">// std::cout &lt;&lt; my_config_file_name &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>      config_file_options.add_options()(</div>
<div class="line"><span class="lineno">  107</span>          <span class="stringliteral">&quot;young_modulus&quot;</span>, po::value&lt;double&gt;(&amp;<a class="code hl_variable" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  108</span>      config_file_options.add_options()(</div>
<div class="line"><span class="lineno">  109</span>          <span class="stringliteral">&quot;poisson_ratio&quot;</span>, po::value&lt;double&gt;(&amp;<a class="code hl_variable" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  110</span>      config_file_options.add_options()(</div>
<div class="line"><span class="lineno">  111</span>          <span class="stringliteral">&quot;c&quot;</span>, po::value&lt;double&gt;(&amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  112</span>      config_file_options.add_options()(</div>
<div class="line"><span class="lineno">  113</span>          <span class="stringliteral">&quot;m&quot;</span>, po::value&lt;double&gt;(&amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  114</span>      config_file_options.add_options()(</div>
<div class="line"><span class="lineno">  115</span>          <span class="stringliteral">&quot;n&quot;</span>, po::value&lt;double&gt;(&amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  116</span>      config_file_options.add_options()(</div>
<div class="line"><span class="lineno">  117</span>          <span class="stringliteral">&quot;rHo_ref&quot;</span>, po::value&lt;double&gt;(&amp;rHo_ref)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  118</span>      config_file_options.add_options()(</div>
<div class="line"><span class="lineno">  119</span>          <span class="stringliteral">&quot;pSi_ref&quot;</span>, po::value&lt;double&gt;(&amp;pSi_ref)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  120</span>      config_file_options.add_options()(</div>
<div class="line"><span class="lineno">  121</span>          <span class="stringliteral">&quot;R0&quot;</span>, po::value&lt;double&gt;(&amp;R0)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>      po::parsed_options parsed =</div>
<div class="line"><span class="lineno">  124</span>          parse_config_file(ini_file, config_file_options, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  125</span>      store(parsed, vm);</div>
<div class="line"><span class="lineno">  126</span>      po::notify(vm);</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;ex) {</div>
<div class="line"><span class="lineno">  129</span>      std::ostringstream ss;</div>
<div class="line"><span class="lineno">  130</span>      ss &lt;&lt; ex.what() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  131</span>      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec">MOFEM_STD_EXCEPTION_THROW</a>, ss.str().c_str());</div>
<div class="line"><span class="lineno">  132</span>    }</div>
<div class="line"><span class="lineno">  133</span>  }</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-young_modulus&quot;</span>, <span class="stringliteral">&quot;get young modulus&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  136</span>                            <a class="code hl_variable" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, &amp;<a class="code hl_variable" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, PETSC_NULL);</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-poisson_ratio&quot;</span>, <span class="stringliteral">&quot;get poisson_ratio&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  139</span>                            <a class="code hl_variable" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>, &amp;<a class="code hl_variable" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>, PETSC_NULL);</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-c&quot;</span>, <span class="stringliteral">&quot;density evolution (growth) velocity [d/m^2]&quot;</span>,</div>
<div class="line"><span class="lineno">  142</span>                            <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>, &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>, PETSC_NULL);</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-m&quot;</span>, <span class="stringliteral">&quot;algorithmic exponent&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>,</div>
<div class="line"><span class="lineno">  145</span>                            PETSC_NULL);</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-n&quot;</span>, <span class="stringliteral">&quot;porosity exponent&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, PETSC_NULL);</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-b&quot;</span>, <span class="stringliteral">&quot;bell function exponent&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, b, &amp;b, PETSC_NULL);</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-rho_ref&quot;</span>, <span class="stringliteral">&quot;reference bone density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, rHo_ref,</div>
<div class="line"><span class="lineno">  152</span>                            &amp;rHo_ref, PETSC_NULL);</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-rho_max&quot;</span>, <span class="stringliteral">&quot;reference bone density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, rHo_max,</div>
<div class="line"><span class="lineno">  155</span>                            &amp;rHo_max, PETSC_NULL);</div>
<div class="line"><span class="lineno">  156</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-rho_min&quot;</span>, <span class="stringliteral">&quot;reference bone density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, rHo_min,</div>
<div class="line"><span class="lineno">  157</span>                            &amp;rHo_min, PETSC_NULL);</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-psi_ref&quot;</span>, <span class="stringliteral">&quot;reference energy density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, pSi_ref,</div>
<div class="line"><span class="lineno">  160</span>                            &amp;pSi_ref, PETSC_NULL);</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-r0&quot;</span>, <span class="stringliteral">&quot;mass source&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, R0, &amp;R0, PETSC_NULL);</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-my_is_atom_test&quot;</span>,</div>
<div class="line"><span class="lineno">  165</span>                          <span class="stringliteral">&quot;is used with testing, exit with error when diverged&quot;</span>,</div>
<div class="line"><span class="lineno">  166</span>                          <span class="stringliteral">&quot;&quot;</span>, is_atom_testing, &amp;is_atom_testing, PETSC_NULL);</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-less_post_proc&quot;</span>,</div>
<div class="line"><span class="lineno">  169</span>                          <span class="stringliteral">&quot;is used to reduce output file size&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  170</span>                          less_post_proc, &amp;less_post_proc, PETSC_NULL);</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(</div>
<div class="line"><span class="lineno">  173</span>      <span class="stringliteral">&quot;-with_adolc&quot;</span>,</div>
<div class="line"><span class="lineno">  174</span>      <span class="stringliteral">&quot;calculate the material tangent with automatic differentiation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  175</span>      with_adol_c, &amp;with_adol_c, PETSC_NULL);</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>  <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> = <a class="code hl_define" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>(<a class="code hl_variable" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, <a class="code hl_variable" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line"><span class="lineno">  178</span>  <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> = <a class="code hl_define" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>(<a class="code hl_variable" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, <a class="code hl_variable" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  181</span>                     <span class="stringliteral">&quot;Young&#39;s modulus E[Pa]:                %4.3g\n&quot;</span>,</div>
<div class="line"><span class="lineno">  182</span>                     <a class="code hl_variable" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>);</div>
<div class="line"><span class="lineno">  183</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  184</span>                     <span class="stringliteral">&quot;Poisson ratio nu[-]                   %4.3g\n&quot;</span>,</div>
<div class="line"><span class="lineno">  185</span>                     <a class="code hl_variable" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line"><span class="lineno">  186</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  187</span>                     <span class="stringliteral">&quot;Lame coefficient lambda[Pa]:          %4.3g\n&quot;</span>, <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>);</div>
<div class="line"><span class="lineno">  188</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  189</span>                     <span class="stringliteral">&quot;Lame coefficient mu[Pa]:              %4.3g\n&quot;</span>, <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>);</div>
<div class="line"><span class="lineno">  190</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  191</span>                     <span class="stringliteral">&quot;Density growth velocity [d/m2]        %4.3g\n&quot;</span>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>);</div>
<div class="line"><span class="lineno">  192</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  193</span>                     <span class="stringliteral">&quot;Algorithmic exponent m[-]:            %4.3g\n&quot;</span>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>);</div>
<div class="line"><span class="lineno">  194</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  195</span>                     <span class="stringliteral">&quot;Porosity exponent n[-]:               %4.3g\n&quot;</span>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line"><span class="lineno">  196</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  197</span>                     <span class="stringliteral">&quot;Reference density rHo_ref[kg/m3]:     %4.3g\n&quot;</span>, rHo_ref);</div>
<div class="line"><span class="lineno">  198</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  199</span>                     <span class="stringliteral">&quot;Reference energy pSi_ref[Pa]:         %4.3g\n&quot;</span>, pSi_ref);</div>
<div class="line"><span class="lineno">  200</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  201</span>                     <span class="stringliteral">&quot;Mass conduction R0[kg/m3s]:           %4.3g\n&quot;</span>, R0);</div>
<div class="line"><span class="lineno">  202</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  203</span>                     <span class="stringliteral">&quot;Bell function coefficent b[-]:        %4.3g\n&quot;</span>, b);</div>
<div class="line"><span class="lineno">  204</span>  <span class="keywordflow">if</span> (b != 0) {</div>
<div class="line"><span class="lineno">  205</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  206</span>                       <span class="stringliteral">&quot;Max density rHo_max[kg/m3]:         %4.3g\n&quot;</span>, rHo_max);</div>
<div class="line"><span class="lineno">  207</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  208</span>                       <span class="stringliteral">&quot;Min density rHo_min[kg/m3]:         %4.3g\n&quot;</span>, rHo_min);</div>
<div class="line"><span class="lineno">  209</span>  }</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>  PetscOptionsEnd();</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  214</span>}</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span><span class="keyword">inline</span> <span class="keywordtype">double</span> Remodeling::CommonData::getCFromDensity(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>) {</div>
<div class="line"><span class="lineno">  217</span>  <span class="keywordtype">double</span> mid_rho = 0.5 * (rHo_max + rHo_min);</div>
<div class="line"><span class="lineno">  218</span>  <span class="keywordtype">double</span> var_h = (<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> - mid_rho) / (rHo_max - mid_rho);</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>  <span class="keywordflow">return</span> 1 / (1 + (b != 0) * pow(var_h, 2 * b));</div>
<div class="line"><span class="lineno">  221</span>}</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span><span class="keyword">inline</span> <span class="keywordtype">double</span> Remodeling::CommonData::getCFromDensityDiff(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>) {</div>
<div class="line"><span class="lineno">  224</span>  <span class="keywordtype">double</span> mid_rho = 0.5 * (rHo_max + rHo_min);</div>
<div class="line"><span class="lineno">  225</span>  <span class="keywordtype">double</span> var_h = (<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> - mid_rho) / (rHo_max - mid_rho);</div>
<div class="line"><span class="lineno">  226</span>  <span class="keywordflow">return</span> (b != 0) * (-2) * b * pow(var_h, 2 * b - 1) /</div>
<div class="line"><span class="lineno">  227</span>         ((rHo_max - mid_rho) * pow(pow(var_h, 2 * b) + 1, 2));</div>
<div class="line"><span class="lineno">  228</span>}</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>OpGetRhoTimeDirevative::OpGetRhoTimeDirevative(</div>
<div class="line"><span class="lineno">  231</span>    Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno">  232</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno">  233</span>          <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line"><span class="lineno">  234</span>      commonData(common_data) {}</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  237</span>OpGetRhoTimeDirevative::doWork(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line"><span class="lineno">  238</span>                               DataForcesAndSourcesCore::EntData &amp;data) {</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line"><span class="lineno">  243</span>  <span class="keywordflow">if</span> (!nb_gauss_pts)</div>
<div class="line"><span class="lineno">  244</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  245</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_base_functions = data.getN().size2();</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>  <span class="keyword">auto</span> base_function = data.getFTensor0N();</div>
<div class="line"><span class="lineno">  248</span>  commonData.data.vecRhoDt.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  249</span>  <span class="keywordflow">if</span> (type == MBVERTEX) {</div>
<div class="line"><span class="lineno">  250</span>    commonData.data.vecRhoDt.clear();</div>
<div class="line"><span class="lineno">  251</span>  }</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>  <span class="keywordtype">int</span> nb_dofs = data.getIndices().size();</div>
<div class="line"><span class="lineno">  254</span>  <span class="keywordflow">if</span> (nb_dofs == 0)</div>
<div class="line"><span class="lineno">  255</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  256</span>  <span class="keywordtype">double</span> *array;</div>
<div class="line"><span class="lineno">  257</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArray(getFEMethod()-&gt;ts_u_t, &amp;array);</div>
<div class="line"><span class="lineno">  258</span>  <span class="keyword">auto</span> drho_dt = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecRhoDt);</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg &lt; nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordtype">int</span> bb = 0;</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">for</span> (; bb &lt; nb_dofs; bb++) {</div>
<div class="line"><span class="lineno">  263</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> field_data = array[data.getLocalIndices()[bb]];</div>
<div class="line"><span class="lineno">  264</span>      drho_dt += field_data * base_function;</div>
<div class="line"><span class="lineno">  265</span>      ++base_function;</div>
<div class="line"><span class="lineno">  266</span>    }</div>
<div class="line"><span class="lineno">  267</span>    <span class="comment">// It is possible to have more base functions than dofs</span></div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordflow">for</span> (; bb != nb_base_functions; bb++)</div>
<div class="line"><span class="lineno">  269</span>      ++base_function;</div>
<div class="line"><span class="lineno">  270</span>    ++drho_dt;</div>
<div class="line"><span class="lineno">  271</span>  }</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArray(getFEMethod()-&gt;ts_u_t, &amp;array);</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  276</span>}</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span><a class="code hl_function" href="structOpCalculateStress.html#aa8fb336855ab8b3de4fa7c8d739a0728">OpCalculateStress::OpCalculateStress</a>(Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno">  279</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno">  280</span>          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line"><span class="lineno">  281</span>      commonData(common_data) {</div>
<div class="line"><span class="lineno">  282</span>  <span class="comment">// Set that this operator is executed only for vertices on element</span></div>
<div class="line"><span class="lineno">  283</span>  doVertices = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  284</span>  doEdges = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  285</span>  doQuads = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  286</span>  doTris = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  287</span>  doTets = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  288</span>  doPrisms = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  289</span>}</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  292</span><a class="code hl_function" href="structOpCalculateStress.html#a9bc89d8801014833b9aebda666bac8ed">OpCalculateStress::doWork</a>(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line"><span class="lineno">  293</span>                          DataForcesAndSourcesCore::EntData &amp;data) {</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>  <span class="keywordflow">if</span> (type != MBVERTEX)</div>
<div class="line"><span class="lineno">  298</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(9);</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>  <span class="keywordflow">if</span> (!commonData.data.gradDispPtr) {</div>
<div class="line"><span class="lineno">  301</span>    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><span class="lineno">  302</span>            <span class="stringliteral">&quot;Gradient at integration points of displacement is not calculated&quot;</span>);</div>
<div class="line"><span class="lineno">  303</span>  }</div>
<div class="line"><span class="lineno">  304</span>  <span class="keyword">auto</span> grad = getFTensor2FromMat&lt;3, 3&gt;(*commonData.data.gradDispPtr);</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = commonData.data.gradDispPtr-&gt;size2();</div>
<div class="line"><span class="lineno">  307</span>  <span class="keywordflow">if</span> (!commonData.data.rhoPtr) {</div>
<div class="line"><span class="lineno">  308</span>    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><span class="lineno">  309</span>            <span class="stringliteral">&quot;Density at integration points is not calculated&quot;</span>);</div>
<div class="line"><span class="lineno">  310</span>  }</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>  commonData.data.vecPsi.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  315</span>  <span class="keyword">auto</span> psi = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line"><span class="lineno">  316</span>  commonData.data.vecR.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  317</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecR);</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>  commonData.data.matInvF.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  320</span>  <span class="keyword">auto</span> invF = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matInvF);</div>
<div class="line"><span class="lineno">  321</span>  commonData.data.vecDetF.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  322</span>  <span class="keyword">auto</span> det_f = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecDetF);</div>
<div class="line"><span class="lineno">  323</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;matS = commonData.data.matS;</div>
<div class="line"><span class="lineno">  324</span>  matS.resize(nb_gauss_pts, 6, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  325</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a> S(<a class="code hl_define" href="definitions_8h.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a>(matS), 6);</div>
<div class="line"><span class="lineno">  326</span>  commonData.data.matP.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  327</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line"><span class="lineno">  328</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;matF = commonData.data.matGradientOfDeformation;</div>
<div class="line"><span class="lineno">  329</span>  matF.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  330</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_define" href="definitions_8h.html#a582835fd072f2ee1a3370455cf2b57cc">TENSOR2_MAT_PTR</a>(matF));</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = commonData.c;</div>
<div class="line"><span class="lineno">  333</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = commonData.n;</div>
<div class="line"><span class="lineno">  334</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> = commonData.m;</div>
<div class="line"><span class="lineno">  335</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line"><span class="lineno">  336</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> psi_ref = commonData.pSi_ref;</div>
<div class="line"><span class="lineno">  337</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> = commonData.lambda;</div>
<div class="line"><span class="lineno">  338</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> = commonData.mu;</div>
<div class="line"><span class="lineno">  339</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  340</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;I&#39;</span>, 3&gt; <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"><span class="lineno">  341</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;J&#39;</span>, 3&gt; <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    <span class="comment">// Get deformation gradient</span></div>
<div class="line"><span class="lineno">  346</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = grad(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"><span class="lineno">  347</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(0, 0) += 1;</div>
<div class="line"><span class="lineno">  348</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(1, 1) += 1;</div>
<div class="line"><span class="lineno">  349</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(2, 2) += 1;</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#ae3a0416ae2eb4b327e43ef2dfc21a15a">determinantTensor3by3</a>(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, det_f);</div>
<div class="line"><span class="lineno">  352</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a7064ec9e939c81c212cc726272c0e088">invertTensor3by3</a>(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, det_f, invF);</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> log_det = log(det_f);</div>
<div class="line"><span class="lineno">  355</span>    psi = <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) * <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) - 3 - 2 * log_det;</div>
<div class="line"><span class="lineno">  356</span>    psi *= 0.5 * <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  357</span>    psi += 0.5 * <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * log_det * log_det;</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> coef = <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * log_det - <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  360</span>    <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> * <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) + coef * invF(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno">  361</span>    S(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = invF(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) ^ <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> kp = commonData.getCFromDensity(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line"><span class="lineno">  364</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> = <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * kp * (pow(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> - <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) * psi - psi_ref);</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    ++det_f;</div>
<div class="line"><span class="lineno">  367</span>    ++invF;</div>
<div class="line"><span class="lineno">  368</span>    ++grad;</div>
<div class="line"><span class="lineno">  369</span>    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno">  370</span>    ++psi;</div>
<div class="line"><span class="lineno">  371</span>    ++S;</div>
<div class="line"><span class="lineno">  372</span>    ++<a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line"><span class="lineno">  373</span>    ++<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>;</div>
<div class="line"><span class="lineno">  374</span>    ++<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line"><span class="lineno">  375</span>  }</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  378</span>}</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>OpCalculateStressTangentWithAdolc::OpCalculateStressTangentWithAdolc(</div>
<div class="line"><span class="lineno">  381</span>    Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno">  382</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno">  383</span>          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line"><span class="lineno">  384</span>      commonData(common_data) {</div>
<div class="line"><span class="lineno">  385</span>  <span class="comment">// Set that this operator is executed only for vertices on element</span></div>
<div class="line"><span class="lineno">  386</span>  doVertices = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  387</span>  doEdges = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  388</span>  doQuads = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  389</span>  doTris = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  390</span>  doTets = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  391</span>  doPrisms = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  392</span>}</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> OpCalculateStressTangentWithAdolc::doWork(</div>
<div class="line"><span class="lineno">  395</span>    <span class="keywordtype">int</span> side, EntityType type, DataForcesAndSourcesCore::EntData &amp;data) {</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>  <span class="keywordflow">if</span> (type != MBVERTEX)</div>
<div class="line"><span class="lineno">  400</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>  <span class="keyword">auto</span> grad = getFTensor2FromMat&lt;3, 3&gt;(*commonData.data.gradDispPtr);</div>
<div class="line"><span class="lineno">  403</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = commonData.data.gradDispPtr-&gt;size2();</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>  vecC.resize(6, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  406</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a> C(<a class="code hl_define" href="Remodeling_8cpp.html#a0a80843c43c1fe98a79754f2051a2001">SYMMETRIC_TENSOR2_VEC_PTR</a>(vecC));</div>
<div class="line"><span class="lineno">  407</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;dS_dC = commonData.data.matMaterialTangent;</div>
<div class="line"><span class="lineno">  408</span>  dS_dC.resize(6, 6 * nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  409</span>  dS_dC.clear();</div>
<div class="line"><span class="lineno">  410</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;double *, 3, 3&gt;</a> D1(<a class="code hl_define" href="Remodeling_8cpp.html#a882b61442aebc50fe467fe15a09ee85c">SYMMETRIC_TENSOR4_MAT_PTR</a>(dS_dC), 6);</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;matS = commonData.data.matS;</div>
<div class="line"><span class="lineno">  413</span>  matS.resize(nb_gauss_pts, 6, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  414</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a> S(<a class="code hl_define" href="Remodeling_8cpp.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a>(matS), 6);</div>
<div class="line"><span class="lineno">  415</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;dP_dF = commonData.data.matPushedMaterialTangent;</div>
<div class="line"><span class="lineno">  416</span>  dP_dF.resize(81, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  417</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;matF = commonData.data.matGradientOfDeformation;</div>
<div class="line"><span class="lineno">  418</span>  matF.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  419</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_define" href="Remodeling_8cpp.html#a582835fd072f2ee1a3370455cf2b57cc">TENSOR2_MAT_PTR</a>(matF));</div>
<div class="line"><span class="lineno">  420</span>  <a class="code hl_class" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;double *, 3, 3, 3, 3&gt;</a> D2(<a class="code hl_define" href="Remodeling_8cpp.html#aff752f795f2d1fdbee680e2e1630d50c">TENSOR4_MAT_PTR</a>(dP_dF));</div>
<div class="line"><span class="lineno">  421</span>  commonData.data.matP.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  422</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line"><span class="lineno">  423</span>  commonData.data.vecPsi.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  424</span>  <span class="keyword">auto</span> psi = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  427</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno">  428</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;I&#39;</span>, 3&gt; <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"><span class="lineno">  429</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;J&#39;</span>, 3&gt; <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line"><span class="lineno">  430</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;K&#39;</span>, 3&gt; <a class="code hl_variable" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>;</div>
<div class="line"><span class="lineno">  431</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;L&#39;</span>, 3&gt; <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>;</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>    <span class="comment">// Get deformation gradient</span></div>
<div class="line"><span class="lineno">  436</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = grad(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"><span class="lineno">  437</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(0, 0) += 1;</div>
<div class="line"><span class="lineno">  438</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(1, 1) += 1;</div>
<div class="line"><span class="lineno">  439</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(2, 2) += 1;</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>    <span class="comment">// Calculate Green defamation Tensor0</span></div>
<div class="line"><span class="lineno">  442</span>    <span class="comment">// ^ that means multiplication of Tensor 2 which result in symmetric Tensor</span></div>
<div class="line"><span class="lineno">  443</span>    <span class="comment">// rank 2.</span></div>
<div class="line"><span class="lineno">  444</span>    C(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) ^ <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>    <span class="comment">// Calculate free energy</span></div>
<div class="line"><span class="lineno">  447</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> recordFreeEnergy_dC&lt;FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;&gt;,</div>
<div class="line"><span class="lineno">  448</span>                               <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a>&gt;(</div>
<div class="line"><span class="lineno">  449</span>        commonData, C, psi);</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    <span class="keywordtype">int</span> r_g = ::gradient(commonData.tAg, 6, &amp;vecC[0], &amp;matS(gg, 0));</div>
<div class="line"><span class="lineno">  452</span>    <span class="keywordflow">if</span> (r_g &lt; 0) {</div>
<div class="line"><span class="lineno">  453</span>      <span class="comment">// That means that energy function is not smooth and derivative</span></div>
<div class="line"><span class="lineno">  454</span>      <span class="comment">// can not be calculated,</span></div>
<div class="line"><span class="lineno">  455</span>      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>,</div>
<div class="line"><span class="lineno">  456</span>              <span class="stringliteral">&quot;ADOL-C function evaluation with error&quot;</span>);</div>
<div class="line"><span class="lineno">  457</span>    }</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>    <span class="comment">// Scale energy density and 2nd Piola Stress</span></div>
<div class="line"><span class="lineno">  460</span>    S(0, 0) *= 2;</div>
<div class="line"><span class="lineno">  461</span>    S(1, 1) *= 2;</div>
<div class="line"><span class="lineno">  462</span>    S(2, 2) *= 2;</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>    <span class="comment">// Calculate 1st Piola-Stress tensor</span></div>
<div class="line"><span class="lineno">  465</span>    <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * S(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> is = 6 * gg;</div>
<div class="line"><span class="lineno">  468</span>    <span class="keywordtype">double</span> *hessian_ptr[6] = {&amp;dS_dC(0, is), &amp;dS_dC(1, is), &amp;dS_dC(2, is),</div>
<div class="line"><span class="lineno">  469</span>                              &amp;dS_dC(3, is), &amp;dS_dC(4, is), &amp;dS_dC(5, is)};</div>
<div class="line"><span class="lineno">  470</span>    <span class="keywordtype">int</span> r_h = ::hessian(commonData.tAg, 6, &amp;vecC[0], hessian_ptr);</div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">if</span> (r_h &lt; 0) {</div>
<div class="line"><span class="lineno">  472</span>      <span class="comment">// That means that energy function is not smooth and derivative</span></div>
<div class="line"><span class="lineno">  473</span>      <span class="comment">// can not be calculated,</span></div>
<div class="line"><span class="lineno">  474</span>      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>,</div>
<div class="line"><span class="lineno">  475</span>              <span class="stringliteral">&quot;ADOL-C function evaluation with error&quot;</span>);</div>
<div class="line"><span class="lineno">  476</span>    }</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>    <span class="comment">// FIXME: TODO: Here tensor 4 with two minor symmetries is used, since</span></div>
<div class="line"><span class="lineno">  479</span>    <span class="comment">// \psi_{,ijkl} = \psi_{,klij} = \psi_{,lkji} = ... there is additional</span></div>
<div class="line"><span class="lineno">  480</span>    <span class="comment">// major symmetry. That is 21 independent components not 36 how is now</span></div>
<div class="line"><span class="lineno">  481</span>    <span class="comment">// implemented using Tenso4_ddg.</span></div>
<div class="line"><span class="lineno">  482</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  483</span>    <span class="comment">// That way we have to fill off-diagonal part for dS_dC. In future that</span></div>
<div class="line"><span class="lineno">  484</span>    <span class="comment">// need to be fixed by implementation of Tenso4 with additional major</span></div>
<div class="line"><span class="lineno">  485</span>    <span class="comment">// symmetries. Pleas consider doing such implementation by yourself. You</span></div>
<div class="line"><span class="lineno">  486</span>    <span class="comment">// have support of MoFEM developing team to guide you through this process.</span></div>
<div class="line"><span class="lineno">  487</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  488</span>    <span class="comment">// This deteriorate efficiency.</span></div>
<div class="line"><span class="lineno">  489</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  490</span>    <span class="comment">// TODO: Implement matrix with more symmetries.</span></div>
<div class="line"><span class="lineno">  491</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 6; ii++) {</div>
<div class="line"><span class="lineno">  493</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt; ii; jj++) {</div>
<div class="line"><span class="lineno">  494</span>        dS_dC(jj, is + ii) = dS_dC(ii, is + jj);</div>
<div class="line"><span class="lineno">  495</span>      }</div>
<div class="line"><span class="lineno">  496</span>    }</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>    <span class="comment">// As result that symmetry of deformation gradient C is used, terms which</span></div>
<div class="line"><span class="lineno">  499</span>    <span class="comment">// have mixed indices are two time to big, and terms which has two times</span></div>
<div class="line"><span class="lineno">  500</span>    <span class="comment">// midxed index are four times to big. Those terms are not multiplied.</span></div>
<div class="line"><span class="lineno">  501</span>    D1(0, 0, 0, 0) *= 4;</div>
<div class="line"><span class="lineno">  502</span>    D1(1, 1, 1, 1) *= 4;</div>
<div class="line"><span class="lineno">  503</span>    D1(2, 2, 2, 2) *= 4;</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>    D1(0, 0, 1, 1) *= 4;</div>
<div class="line"><span class="lineno">  506</span>    D1(1, 1, 0, 0) *= 4;</div>
<div class="line"><span class="lineno">  507</span>    D1(1, 1, 2, 2) *= 4;</div>
<div class="line"><span class="lineno">  508</span>    D1(2, 2, 1, 1) *= 4;</div>
<div class="line"><span class="lineno">  509</span>    D1(0, 0, 2, 2) *= 4;</div>
<div class="line"><span class="lineno">  510</span>    D1(2, 2, 0, 0) *= 4;</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>    D1(0, 0, 0, 1) *= 2;</div>
<div class="line"><span class="lineno">  513</span>    D1(0, 0, 0, 2) *= 2;</div>
<div class="line"><span class="lineno">  514</span>    D1(0, 0, 1, 2) *= 2;</div>
<div class="line"><span class="lineno">  515</span>    D1(0, 1, 0, 0) *= 2;</div>
<div class="line"><span class="lineno">  516</span>    D1(0, 2, 0, 0) *= 2;</div>
<div class="line"><span class="lineno">  517</span>    D1(1, 2, 0, 0) *= 2;</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>    D1(1, 1, 0, 1) *= 2;</div>
<div class="line"><span class="lineno">  520</span>    D1(1, 1, 0, 2) *= 2;</div>
<div class="line"><span class="lineno">  521</span>    D1(1, 1, 1, 2) *= 2;</div>
<div class="line"><span class="lineno">  522</span>    D1(0, 1, 1, 1) *= 2;</div>
<div class="line"><span class="lineno">  523</span>    D1(0, 2, 1, 1) *= 2;</div>
<div class="line"><span class="lineno">  524</span>    D1(1, 2, 1, 1) *= 2;</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>    D1(2, 2, 0, 1) *= 2;</div>
<div class="line"><span class="lineno">  527</span>    D1(2, 2, 0, 2) *= 2;</div>
<div class="line"><span class="lineno">  528</span>    D1(2, 2, 1, 2) *= 2;</div>
<div class="line"><span class="lineno">  529</span>    D1(0, 1, 2, 2) *= 2;</div>
<div class="line"><span class="lineno">  530</span>    D1(0, 2, 2, 2) *= 2;</div>
<div class="line"><span class="lineno">  531</span>    D1(1, 2, 2, 2) *= 2;</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>    D2(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) = (<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * (D1(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) * <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>)));</div>
<div class="line"><span class="lineno">  534</span>    <span class="comment">// D2(i, J, k, L) += I(i, k) * S(J, L);</span></div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    ++grad;</div>
<div class="line"><span class="lineno">  537</span>    ++S;</div>
<div class="line"><span class="lineno">  538</span>    ++<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line"><span class="lineno">  539</span>    ++D1;</div>
<div class="line"><span class="lineno">  540</span>    ++D2;</div>
<div class="line"><span class="lineno">  541</span>    ++<a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line"><span class="lineno">  542</span>    ++psi;</div>
<div class="line"><span class="lineno">  543</span>  }</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  546</span>}</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span><a class="code hl_function" href="structOpPostProcStress.html#a0f791f1e62ed3fc3a7a72dc3946490fc">OpPostProcStress::OpPostProcStress</a>(moab::Interface &amp;post_proc_mesh,</div>
<div class="line"><span class="lineno">  549</span>                                   std::vector&lt;EntityHandle&gt; &amp;map_gauss_pts,</div>
<div class="line"><span class="lineno">  550</span>                                   Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno">  551</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno">  552</span>          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line"><span class="lineno">  553</span>      commonData(common_data), postProcMesh(post_proc_mesh),</div>
<div class="line"><span class="lineno">  554</span>      mapGaussPts(map_gauss_pts) {</div>
<div class="line"><span class="lineno">  555</span>  <span class="comment">// Set that this operator is executed only for vertices on element</span></div>
<div class="line"><span class="lineno">  556</span>  doVertices = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  557</span>  doEdges = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  558</span>  doQuads = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  559</span>  doTris = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  560</span>  doTets = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  561</span>  doPrisms = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  562</span>}</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  565</span><a class="code hl_function" href="structOpPostProcStress.html#adc555582171e7be6434277c8808a3395">OpPostProcStress::doWork</a>(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line"><span class="lineno">  566</span>                         DataForcesAndSourcesCore::EntData &amp;data) {</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>  <span class="keywordflow">if</span> (type != MBVERTEX)</div>
<div class="line"><span class="lineno">  571</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(9);</div>
<div class="line"><span class="lineno">  572</span>  <span class="keywordtype">double</span> def_VAL[9];</div>
<div class="line"><span class="lineno">  573</span>  bzero(def_VAL, 9 * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>  Tag th_piola2;</div>
<div class="line"><span class="lineno">  576</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_get_handle(<span class="stringliteral">&quot;Piola_Stress2&quot;</span>, 9, MB_TYPE_DOUBLE,</div>
<div class="line"><span class="lineno">  577</span>                                     th_piola2, MB_TAG_CREAT | MB_TAG_SPARSE,</div>
<div class="line"><span class="lineno">  578</span>                                     def_VAL);</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>  Tag th_psi;</div>
<div class="line"><span class="lineno">  581</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_get_handle(<span class="stringliteral">&quot;psi&quot;</span>, 1, MB_TYPE_DOUBLE, th_psi,</div>
<div class="line"><span class="lineno">  582</span>                                     MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>  Tag th_rho;</div>
<div class="line"><span class="lineno">  585</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_get_handle(<span class="stringliteral">&quot;RHO&quot;</span>, 1, MB_TYPE_DOUBLE, th_rho,</div>
<div class="line"><span class="lineno">  586</span>                                     MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>  Tag th_piola1;</div>
<div class="line"><span class="lineno">  589</span>  Tag principal;</div>
<div class="line"><span class="lineno">  590</span>  Tag th_prin_stress_vect1, th_prin_stress_vect2, th_prin_stress_vect3;</div>
<div class="line"><span class="lineno">  591</span>  Tag th_R;</div>
<div class="line"><span class="lineno">  592</span>  Tag th_grad_rho;</div>
<div class="line"><span class="lineno">  593</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structOpPostProcStress.html#a6ac9440f4ce87fbed4e71d4ed780a7e9">commonData</a>.less_post_proc) {</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_get_handle(<span class="stringliteral">&quot;Piola_Stress1&quot;</span>, 9, MB_TYPE_DOUBLE,</div>
<div class="line"><span class="lineno">  596</span>                                       th_piola1, MB_TAG_CREAT | MB_TAG_SPARSE,</div>
<div class="line"><span class="lineno">  597</span>                                       def_VAL);</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_get_handle(<span class="stringliteral">&quot;Principal_stress&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line"><span class="lineno">  600</span>                                       principal, MB_TAG_CREAT | MB_TAG_SPARSE,</div>
<div class="line"><span class="lineno">  601</span>                                       def_VAL);</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_get_handle(<span class="stringliteral">&quot;Principal_stress_S1&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line"><span class="lineno">  604</span>                                       th_prin_stress_vect1,</div>
<div class="line"><span class="lineno">  605</span>                                       MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"><span class="lineno">  606</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_get_handle(<span class="stringliteral">&quot;Principal_stress_S2&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line"><span class="lineno">  607</span>                                       th_prin_stress_vect2,</div>
<div class="line"><span class="lineno">  608</span>                                       MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"><span class="lineno">  609</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_get_handle(<span class="stringliteral">&quot;Principal_stress_S3&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line"><span class="lineno">  610</span>                                       th_prin_stress_vect3,</div>
<div class="line"><span class="lineno">  611</span>                                       MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_get_handle(<span class="stringliteral">&quot;R&quot;</span>, 1, MB_TYPE_DOUBLE, th_R,</div>
<div class="line"><span class="lineno">  614</span>                                       MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_get_handle(<span class="stringliteral">&quot;grad_rho&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line"><span class="lineno">  617</span>                                       th_grad_rho,</div>
<div class="line"><span class="lineno">  618</span>                                       MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"><span class="lineno">  619</span>  }</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = <a class="code hl_variable" href="structOpPostProcStress.html#a6ac9440f4ce87fbed4e71d4ed780a7e9">commonData</a>.data.<a class="code hl_variable" href="structDataAtIntegrationPts.html#a16743a784469bd2c5de896d50aba85b3">gradDispPtr</a>-&gt;size2();</div>
<div class="line"><span class="lineno">  622</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;matS = <a class="code hl_variable" href="structOpPostProcStress.html#a6ac9440f4ce87fbed4e71d4ed780a7e9">commonData</a>.data.matS;</div>
<div class="line"><span class="lineno">  623</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a> S(<a class="code hl_define" href="definitions_8h.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a>(matS), 6);</div>
<div class="line"><span class="lineno">  624</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(<a class="code hl_variable" href="structOpPostProcStress.html#a6ac9440f4ce87fbed4e71d4ed780a7e9">commonData</a>.data.matP);</div>
<div class="line"><span class="lineno">  625</span>  <span class="keyword">auto</span> psi = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(<a class="code hl_variable" href="structOpPostProcStress.html#a6ac9440f4ce87fbed4e71d4ed780a7e9">commonData</a>.data.vecPsi);</div>
<div class="line"><span class="lineno">  626</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(<a class="code hl_variable" href="structOpPostProcStress.html#a6ac9440f4ce87fbed4e71d4ed780a7e9">commonData</a>.data.vecR);</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*<a class="code hl_variable" href="structOpPostProcStress.html#a6ac9440f4ce87fbed4e71d4ed780a7e9">commonData</a>.data.rhoPtr);</div>
<div class="line"><span class="lineno">  629</span>  <span class="keyword">auto</span> grad_rho = getFTensor1FromMat&lt;3&gt;(*<a class="code hl_variable" href="structOpPostProcStress.html#a6ac9440f4ce87fbed4e71d4ed780a7e9">commonData</a>.data.gradRhoPtr);</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>  <a class="code hl_class" href="classMatrixBoundedArray_3_01double_00_019_01_4.html">MatrixDouble3by3</a> stress(3, 3);</div>
<div class="line"><span class="lineno">  632</span>  <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> eigen_values(3);</div>
<div class="line"><span class="lineno">  633</span>  <a class="code hl_class" href="classMatrixBoundedArray_3_01double_00_019_01_4.html">MatrixDouble3by3</a> eigen_vectors(3, 3);</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>    <span class="keywordtype">double</span> val = psi;</div>
<div class="line"><span class="lineno">  638</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_set_data(th_psi, &amp;<a class="code hl_variable" href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">mapGaussPts</a>[gg], 1, &amp;val);</div>
<div class="line"><span class="lineno">  639</span>    val = <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno">  640</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_set_data(th_rho, &amp;<a class="code hl_variable" href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">mapGaussPts</a>[gg], 1, &amp;val);</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>    <span class="comment">// S is symmetric tensor, need to map it to non-symmetric tensor to save it</span></div>
<div class="line"><span class="lineno">  643</span>    <span class="comment">// on moab tag to be viable in paraview.</span></div>
<div class="line"><span class="lineno">  644</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ii++) {</div>
<div class="line"><span class="lineno">  645</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; jj++) {</div>
<div class="line"><span class="lineno">  646</span>        stress(ii, jj) = S(ii, jj);</div>
<div class="line"><span class="lineno">  647</span>      }</div>
<div class="line"><span class="lineno">  648</span>    }</div>
<div class="line"><span class="lineno">  649</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_set_data(th_piola2, &amp;<a class="code hl_variable" href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">mapGaussPts</a>[gg], 1,</div>
<div class="line"><span class="lineno">  650</span>                                     &amp;stress(0, 0));</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structOpPostProcStress.html#a6ac9440f4ce87fbed4e71d4ed780a7e9">commonData</a>.less_post_proc) {</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ii++) {</div>
<div class="line"><span class="lineno">  655</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; jj++) {</div>
<div class="line"><span class="lineno">  656</span>          stress(ii, jj) = <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(ii, jj);</div>
<div class="line"><span class="lineno">  657</span>        }</div>
<div class="line"><span class="lineno">  658</span>      }</div>
<div class="line"><span class="lineno">  659</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_set_data(th_piola1, &amp;<a class="code hl_variable" href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">mapGaussPts</a>[gg], 1,</div>
<div class="line"><span class="lineno">  660</span>                                       &amp;stress(0, 0));</div>
<div class="line"><span class="lineno">  661</span>      val = <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>;</div>
<div class="line"><span class="lineno">  662</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_set_data(th_R, &amp;<a class="code hl_variable" href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">mapGaussPts</a>[gg], 1, &amp;val);</div>
<div class="line"><span class="lineno">  663</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> t2[] = {grad_rho(0), grad_rho(1), grad_rho(2)};</div>
<div class="line"><span class="lineno">  664</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_set_data(th_grad_rho, &amp;<a class="code hl_variable" href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">mapGaussPts</a>[gg], 1, t2);</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>      <span class="comment">// Add calculation of eigen values, i.e. prinple stresses.</span></div>
<div class="line"><span class="lineno">  667</span>      noalias(eigen_vectors) = stress;</div>
<div class="line"><span class="lineno">  668</span>      <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> prin_stress_vect1(3);</div>
<div class="line"><span class="lineno">  669</span>      <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> prin_stress_vect2(3);</div>
<div class="line"><span class="lineno">  670</span>      <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> prin_stress_vect3(3);</div>
<div class="line"><span class="lineno">  671</span>      <span class="comment">// LAPACK - eigenvalues and vectors. Applied twice for initial creates</span></div>
<div class="line"><span class="lineno">  672</span>      <span class="comment">// memory space</span></div>
<div class="line"><span class="lineno">  673</span>      <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = 3, lda = 3, info, lwork = -1;</div>
<div class="line"><span class="lineno">  674</span>      <span class="keywordtype">double</span> wkopt;</div>
<div class="line"><span class="lineno">  675</span>      info = <a class="code hl_function" href="lapack__wrap_8h.html#a9d34be2f8a6a32580830207f2b827529">lapack_dsyev</a>(<span class="charliteral">&#39;V&#39;</span>, <span class="charliteral">&#39;U&#39;</span>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, &amp;(eigen_vectors.data()[0]), lda,</div>
<div class="line"><span class="lineno">  676</span>                          &amp;(eigen_values.data()[0]), &amp;wkopt, lwork);</div>
<div class="line"><span class="lineno">  677</span>      <span class="keywordflow">if</span> (info != 0)</div>
<div class="line"><span class="lineno">  678</span>        SETERRQ1(PETSC_COMM_SELF, 1,</div>
<div class="line"><span class="lineno">  679</span>                 <span class="stringliteral">&quot;something is wrong with lapack_dsyev info = %d&quot;</span>, info);</div>
<div class="line"><span class="lineno">  680</span>      lwork = (<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>)wkopt;</div>
<div class="line"><span class="lineno">  681</span>      <span class="keywordtype">double</span> work[lwork];</div>
<div class="line"><span class="lineno">  682</span>      info = <a class="code hl_function" href="lapack__wrap_8h.html#a9d34be2f8a6a32580830207f2b827529">lapack_dsyev</a>(<span class="charliteral">&#39;V&#39;</span>, <span class="charliteral">&#39;U&#39;</span>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, &amp;(eigen_vectors.data()[0]), lda,</div>
<div class="line"><span class="lineno">  683</span>                          &amp;(eigen_values.data()[0]), work, lwork);</div>
<div class="line"><span class="lineno">  684</span>      <span class="keywordflow">if</span> (info != 0)</div>
<div class="line"><span class="lineno">  685</span>        SETERRQ1(PETSC_COMM_SELF, 1,</div>
<div class="line"><span class="lineno">  686</span>                 <span class="stringliteral">&quot;something is wrong with lapack_dsyev info = %d&quot;</span>, info);</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 3; ii++) {</div>
<div class="line"><span class="lineno">  689</span>        prin_stress_vect1[ii] = eigen_vectors(0, ii);</div>
<div class="line"><span class="lineno">  690</span>        prin_stress_vect2[ii] = eigen_vectors(1, ii);</div>
<div class="line"><span class="lineno">  691</span>        prin_stress_vect3[ii] = eigen_vectors(2, ii);</div>
<div class="line"><span class="lineno">  692</span>      }</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_set_data(principal, &amp;<a class="code hl_variable" href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">mapGaussPts</a>[gg], 1,</div>
<div class="line"><span class="lineno">  695</span>                                       &amp;eigen_values[0]);</div>
<div class="line"><span class="lineno">  696</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_set_data(th_prin_stress_vect1, &amp;<a class="code hl_variable" href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">mapGaussPts</a>[gg],</div>
<div class="line"><span class="lineno">  697</span>                                       1, &amp;*prin_stress_vect1.begin());</div>
<div class="line"><span class="lineno">  698</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_set_data(th_prin_stress_vect2, &amp;<a class="code hl_variable" href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">mapGaussPts</a>[gg],</div>
<div class="line"><span class="lineno">  699</span>                                       1, &amp;*prin_stress_vect2.begin());</div>
<div class="line"><span class="lineno">  700</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">postProcMesh</a>.tag_set_data(th_prin_stress_vect3, &amp;<a class="code hl_variable" href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">mapGaussPts</a>[gg],</div>
<div class="line"><span class="lineno">  701</span>                                       1, &amp;*prin_stress_vect3.begin());</div>
<div class="line"><span class="lineno">  702</span>    }</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    ++S;</div>
<div class="line"><span class="lineno">  705</span>    ++<a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line"><span class="lineno">  706</span>    ++psi;</div>
<div class="line"><span class="lineno">  707</span>    ++<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>;</div>
<div class="line"><span class="lineno">  708</span>    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno">  709</span>    ++grad_rho;</div>
<div class="line"><span class="lineno">  710</span>  }</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  713</span>}</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span>OpCalculateStressTangent::OpCalculateStressTangent(</div>
<div class="line"><span class="lineno">  716</span>    Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno">  717</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno">  718</span>          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line"><span class="lineno">  719</span>      commonData(common_data) {</div>
<div class="line"><span class="lineno">  720</span>  <span class="comment">// Set that this operator is executed only for vertices on element</span></div>
<div class="line"><span class="lineno">  721</span>  doVertices = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  722</span>  doEdges = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  723</span>  doQuads = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  724</span>  doTris = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  725</span>  doTets = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  726</span>  doPrisms = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  727</span>}</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  730</span>OpCalculateStressTangent::doWork(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line"><span class="lineno">  731</span>                                DataForcesAndSourcesCore::EntData &amp;data) {</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>  <span class="keywordflow">if</span> (type != MBVERTEX)</div>
<div class="line"><span class="lineno">  736</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>  <span class="keyword">auto</span> grad = getFTensor2FromMat&lt;3, 3&gt;(*commonData.data.gradDispPtr);</div>
<div class="line"><span class="lineno">  739</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = commonData.data.gradDispPtr-&gt;size2();</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>  commonData.data.matInvF.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  742</span>  <span class="keyword">auto</span> invF = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matInvF);</div>
<div class="line"><span class="lineno">  743</span>  commonData.data.vecDetF.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  744</span>  <span class="keyword">auto</span> det_f = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecDetF);</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;dP_dF = commonData.data.matPushedMaterialTangent;</div>
<div class="line"><span class="lineno">  747</span>  dP_dF.resize(81, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  748</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;matF = commonData.data.matGradientOfDeformation;</div>
<div class="line"><span class="lineno">  749</span>  matF.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  750</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_define" href="Remodeling_8cpp.html#a582835fd072f2ee1a3370455cf2b57cc">TENSOR2_MAT_PTR</a>(matF));</div>
<div class="line"><span class="lineno">  751</span>  <a class="code hl_class" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;double *, 3, 3, 3, 3&gt;</a> D2(<a class="code hl_define" href="Remodeling_8cpp.html#aff752f795f2d1fdbee680e2e1630d50c">TENSOR4_MAT_PTR</a>(dP_dF));</div>
<div class="line"><span class="lineno">  752</span>  commonData.data.matP.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  753</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line"><span class="lineno">  754</span>  commonData.data.vecPsi.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  755</span>  <span class="keyword">auto</span> psi = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line"><span class="lineno">  756</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  757</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno">  758</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;I&#39;</span>, 3&gt; <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"><span class="lineno">  759</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;J&#39;</span>, 3&gt; <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line"><span class="lineno">  760</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;K&#39;</span>, 3&gt; <a class="code hl_variable" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>;</div>
<div class="line"><span class="lineno">  761</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;L&#39;</span>, 3&gt; <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>;</div>
<div class="line"><span class="lineno">  762</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> = commonData.lambda;</div>
<div class="line"><span class="lineno">  763</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> = commonData.mu;</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    <span class="comment">// Get deformation gradient</span></div>
<div class="line"><span class="lineno">  768</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = grad(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"><span class="lineno">  769</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(0, 0) += 1;</div>
<div class="line"><span class="lineno">  770</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(1, 1) += 1;</div>
<div class="line"><span class="lineno">  771</span>    <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(2, 2) += 1;</div>
<div class="line"><span class="lineno">  772</span> </div>
<div class="line"><span class="lineno">  773</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#ae3a0416ae2eb4b327e43ef2dfc21a15a">determinantTensor3by3</a>(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, det_f);</div>
<div class="line"><span class="lineno">  774</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a7064ec9e939c81c212cc726272c0e088">invertTensor3by3</a>(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, det_f, invF);</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> log_det = log(det_f);</div>
<div class="line"><span class="lineno">  777</span>    psi = <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) * <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) - 3 - 2 * log_det;</div>
<div class="line"><span class="lineno">  778</span>    psi *= 0.5 * <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  779</span>    psi += 0.5 * <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * log_det * log_det;</div>
<div class="line"><span class="lineno">  780</span> </div>
<div class="line"><span class="lineno">  781</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> var = <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * log_det - <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  782</span>    <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> * <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) + var * invF(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> coef = <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> - <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * log_det;</div>
<div class="line"><span class="lineno">  785</span>    <span class="comment">// TODO: This can be improved by utilising the symmetries of the D2 tensor</span></div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>    D2(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) =</div>
<div class="line"><span class="lineno">  788</span>        invF(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * (invF(<a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>) + invF(<a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * (invF(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * coef);</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>    D2(0, 0, 0, 0) += <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  791</span>    D2(0, 1, 0, 1) += <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  792</span>    D2(0, 2, 0, 2) += <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  793</span>    D2(1, 0, 1, 0) += <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  794</span>    D2(1, 1, 1, 1) += <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  795</span>    D2(1, 2, 1, 2) += <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  796</span>    D2(2, 0, 2, 0) += <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  797</span>    D2(2, 1, 2, 1) += <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  798</span>    D2(2, 2, 2, 2) += <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>    ++det_f;</div>
<div class="line"><span class="lineno">  801</span>    ++invF;</div>
<div class="line"><span class="lineno">  802</span>    ++grad;</div>
<div class="line"><span class="lineno">  803</span>    ++<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line"><span class="lineno">  804</span>    ++D2;</div>
<div class="line"><span class="lineno">  805</span>    ++<a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line"><span class="lineno">  806</span>    ++psi;</div>
<div class="line"><span class="lineno">  807</span>  }</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  810</span>}</div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span>OpAssmbleStressRhs::OpAssmbleStressRhs(Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno">  813</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno">  814</span>          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line"><span class="lineno">  815</span>      commonData(common_data) {}</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  818</span>OpAssmbleStressRhs::doWork(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line"><span class="lineno">  819</span>                           DataForcesAndSourcesCore::EntData &amp;data) {</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dofs = data.getIndices().size();</div>
<div class="line"><span class="lineno">  824</span>  <span class="keywordflow">if</span> (!nb_dofs)</div>
<div class="line"><span class="lineno">  825</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  826</span>  nF.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  827</span>  nF.clear();</div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line"><span class="lineno">  830</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_base_functions = data.getN().size2();</div>
<div class="line"><span class="lineno">  831</span>  <span class="keyword">auto</span> diff_base_functions = data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line"><span class="lineno">  832</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line"><span class="lineno">  833</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>  <span class="comment">// MatrixDouble &amp;matS = commonData.data.matS;</span></div>
<div class="line"><span class="lineno">  836</span>  <span class="comment">// MatrixDouble &amp;matF = commonData.data.matGradientOfDeformation;</span></div>
<div class="line"><span class="lineno">  837</span>  <span class="comment">// FTensor::Tensor2&lt;double*,3,3&gt; F(TENSOR2_MAT_PTR(matF));</span></div>
<div class="line"><span class="lineno">  838</span>  <span class="comment">// FTensor::Tensor2_symmetric&lt;double*,3&gt; S(SYMMETRIC_TENSOR2_MAT_PTR(matS),6);</span></div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = commonData.n;</div>
<div class="line"><span class="lineno">  841</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;I&#39;</span>, 3&gt; <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"><span class="lineno">  844</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;J&#39;</span>, 3&gt; <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line"><span class="lineno">  845</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>    <span class="comment">// Get volume and integration weight</span></div>
<div class="line"><span class="lineno">  850</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * pow(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>    <span class="keywordtype">int</span> bb = 0;</div>
<div class="line"><span class="lineno">  854</span>    <span class="keywordflow">for</span> (; bb != nb_dofs / 3; bb++) {</div>
<div class="line"><span class="lineno">  855</span>      <span class="keywordtype">double</span> *ptr = &amp;nF[3 * bb];</div>
<div class="line"><span class="lineno">  856</span>      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double *, 3&gt;</a> t1(ptr, &amp;ptr[1], &amp;ptr[2]);</div>
<div class="line"><span class="lineno">  857</span>      t1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * diff_base_functions(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"><span class="lineno">  858</span>      <span class="comment">// t1(i) += 0.5*a*diff_base_functions(J)*(F(i,I)*S(I,J));</span></div>
<div class="line"><span class="lineno">  859</span>      <span class="comment">// t1(i) += 0.5*a*diff_base_functions(I)*(F(i,J)*S(I,J));</span></div>
<div class="line"><span class="lineno">  860</span>      ++diff_base_functions;</div>
<div class="line"><span class="lineno">  861</span>    }</div>
<div class="line"><span class="lineno">  862</span>    <span class="comment">// Could be that we base more base functions than needed to approx. disp.</span></div>
<div class="line"><span class="lineno">  863</span>    <span class="comment">// field.</span></div>
<div class="line"><span class="lineno">  864</span>    <span class="keywordflow">for</span> (; bb != nb_base_functions; bb++) {</div>
<div class="line"><span class="lineno">  865</span>      ++diff_base_functions;</div>
<div class="line"><span class="lineno">  866</span>    }</div>
<div class="line"><span class="lineno">  867</span>    ++<a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line"><span class="lineno">  868</span>    <span class="comment">// ++S;</span></div>
<div class="line"><span class="lineno">  869</span>    <span class="comment">// ++F;</span></div>
<div class="line"><span class="lineno">  870</span>    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno">  871</span>  }</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>  <span class="comment">// Assemble internal force vector for time solver (TS)</span></div>
<div class="line"><span class="lineno">  874</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(</div>
<div class="line"><span class="lineno">  875</span>      getFEMethod()-&gt;ts_F, <span class="comment">/// Get the right hand side vector for time solver</span></div>
<div class="line"><span class="lineno">  876</span>      nb_dofs, &amp;*data.getIndices().begin(), &amp;*nF.begin(), ADD_VALUES);</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  879</span>}</div>
<div class="line"><span class="lineno">  880</span> </div>
<div class="line"><span class="lineno">  881</span>OpAssmbleRhoRhs::OpAssmbleRhoRhs(Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno">  882</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno">  883</span>          <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line"><span class="lineno">  884</span>      commonData(common_data) {}</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  887</span>OpAssmbleRhoRhs::doWork(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line"><span class="lineno">  888</span>                        DataForcesAndSourcesCore::EntData &amp;data) {</div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dofs = data.getIndices().size();</div>
<div class="line"><span class="lineno">  893</span>  <span class="keywordflow">if</span> (!nb_dofs)</div>
<div class="line"><span class="lineno">  894</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  895</span>  nF.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  896</span>  nF.clear();</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line"><span class="lineno">  899</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_base_functions = data.getN().size2();</div>
<div class="line"><span class="lineno">  900</span>  <span class="keyword">auto</span> base_functions = data.getFTensor0N();</div>
<div class="line"><span class="lineno">  901</span>  <span class="keyword">auto</span> diff_base_functions = data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line"><span class="lineno">  902</span>  <span class="keywordflow">if</span> (!commonData.data.rhoPtr) {</div>
<div class="line"><span class="lineno">  903</span>    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;rhoPtsr is null&quot;</span>);</div>
<div class="line"><span class="lineno">  904</span>  }</div>
<div class="line"><span class="lineno">  905</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"><span class="lineno">  906</span>  <span class="keywordflow">if</span> (!commonData.data.gradRhoPtr) {</div>
<div class="line"><span class="lineno">  907</span>    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;gradRhoPtr is null&quot;</span>);</div>
<div class="line"><span class="lineno">  908</span>  }</div>
<div class="line"><span class="lineno">  909</span>  <span class="keyword">auto</span> grad_rho = getFTensor1FromMat&lt;3&gt;(*commonData.data.gradRhoPtr);</div>
<div class="line"><span class="lineno">  910</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecR);</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>  <span class="keywordflow">if</span> (commonData.data.vecRhoDt.size() != nb_gauss_pts) {</div>
<div class="line"><span class="lineno">  913</span>    commonData.data.vecRhoDt.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  914</span>    commonData.data.vecRhoDt.clear();</div>
<div class="line"><span class="lineno">  915</span>    <span class="comment">// SETERRQ(PETSC_COMM_SELF,MOFEM_DATA_INCONSISTENCY,&quot;Time derivative of</span></div>
<div class="line"><span class="lineno">  916</span>    <span class="comment">// density at integration not calculated&quot;);</span></div>
<div class="line"><span class="lineno">  917</span>  }</div>
<div class="line"><span class="lineno">  918</span>  <span class="keyword">auto</span> drho_dt = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecRhoDt);</div>
<div class="line"><span class="lineno">  919</span> </div>
<div class="line"><span class="lineno">  920</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> R0 = commonData.R0;</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;I&#39;</span>, 3&gt; <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"><span class="lineno">  923</span> </div>
<div class="line"><span class="lineno">  924</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno">  925</span> </div>
<div class="line"><span class="lineno">  926</span>    <span class="comment">// Get volume and integration weight</span></div>
<div class="line"><span class="lineno">  927</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>    <span class="keywordtype">int</span> bb = 0;</div>
<div class="line"><span class="lineno">  930</span>    <span class="keywordflow">for</span> (; bb != nb_dofs; bb++) {</div>
<div class="line"><span class="lineno">  931</span>      nF[bb] += <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * base_functions * drho_dt; <span class="comment">// Density rate term</span></div>
<div class="line"><span class="lineno">  932</span>      nF[bb] -= <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * base_functions * <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>;       <span class="comment">// Source term</span></div>
<div class="line"><span class="lineno">  933</span>      nF[bb] -= <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * R0 * diff_base_functions(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * grad_rho(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>); <span class="comment">// Gradient term</span></div>
<div class="line"><span class="lineno">  934</span>      ++base_functions;</div>
<div class="line"><span class="lineno">  935</span>      ++diff_base_functions;</div>
<div class="line"><span class="lineno">  936</span>    }</div>
<div class="line"><span class="lineno">  937</span>    <span class="comment">// Could be that we base more base functions than needed to approx. density</span></div>
<div class="line"><span class="lineno">  938</span>    <span class="comment">// field.</span></div>
<div class="line"><span class="lineno">  939</span>    <span class="keywordflow">for</span> (; bb != nb_base_functions; bb++) {</div>
<div class="line"><span class="lineno">  940</span>      ++base_functions;</div>
<div class="line"><span class="lineno">  941</span>      ++diff_base_functions;</div>
<div class="line"><span class="lineno">  942</span>    }</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>    <span class="comment">// Increment quantities for integration pts.</span></div>
<div class="line"><span class="lineno">  945</span>    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno">  946</span>    ++grad_rho;</div>
<div class="line"><span class="lineno">  947</span>    ++drho_dt;</div>
<div class="line"><span class="lineno">  948</span>    ++<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>;</div>
<div class="line"><span class="lineno">  949</span>  }</div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span>  <span class="comment">// Assemble internal force vector for time solver (TS)</span></div>
<div class="line"><span class="lineno">  952</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(</div>
<div class="line"><span class="lineno">  953</span>      getFEMethod()-&gt;ts_F, <span class="comment">/// Get the right hand side vector for time solver</span></div>
<div class="line"><span class="lineno">  954</span>      nb_dofs, &amp;*data.getIndices().begin(), &amp;*nF.begin(), ADD_VALUES);</div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  957</span>}</div>
<div class="line"><span class="lineno">  958</span> </div>
<div class="line"><span class="lineno">  959</span>OpAssmbleRhoLhs_dRho::OpAssmbleRhoLhs_dRho(Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno">  960</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno">  961</span>          <span class="stringliteral">&quot;RHO&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROWCOL),</div>
<div class="line"><span class="lineno">  962</span>      commonData(common_data) {</div>
<div class="line"><span class="lineno">  963</span>  sYmm = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  964</span>}</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  967</span>OpAssmbleRhoLhs_dRho::doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line"><span class="lineno">  968</span>                             EntityType col_type,</div>
<div class="line"><span class="lineno">  969</span>                             DataForcesAndSourcesCore::EntData &amp;row_data,</div>
<div class="line"><span class="lineno">  970</span>                             DataForcesAndSourcesCore::EntData &amp;col_data) {</div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line"><span class="lineno">  975</span>  <span class="keywordflow">if</span> (!row_nb_dofs)</div>
<div class="line"><span class="lineno">  976</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  977</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line"><span class="lineno">  978</span>  <span class="keywordflow">if</span> (!col_nb_dofs)</div>
<div class="line"><span class="lineno">  979</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>  <span class="comment">// Set size can clear local tangent matrix</span></div>
<div class="line"><span class="lineno">  982</span>  locK_rho_rho.resize(row_nb_dofs, col_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  983</span>  locK_rho_rho.clear();</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_gauss_pts = row_data.getN().size1();</div>
<div class="line"><span class="lineno">  986</span>  <span class="keywordflow">if</span> (!row_nb_gauss_pts)</div>
<div class="line"><span class="lineno">  987</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  988</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_functions = row_data.getN().size2();</div>
<div class="line"><span class="lineno">  989</span> </div>
<div class="line"><span class="lineno">  990</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ts_a = getFEMethod()-&gt;ts_a;</div>
<div class="line"><span class="lineno">  991</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> R0 = commonData.R0;</div>
<div class="line"><span class="lineno">  992</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = commonData.c;</div>
<div class="line"><span class="lineno">  993</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = commonData.n;</div>
<div class="line"><span class="lineno">  994</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> = commonData.m;</div>
<div class="line"><span class="lineno">  995</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line"><span class="lineno">  996</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> psi_ref = commonData.pSi_ref;</div>
<div class="line"><span class="lineno">  997</span> </div>
<div class="line"><span class="lineno">  998</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;I&#39;</span>, 3&gt; <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"><span class="lineno"> 1001</span>  <span class="keyword">auto</span> psi = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line"><span class="lineno"> 1002</span>  <span class="keyword">auto</span> row_base_functions = row_data.getFTensor0N();</div>
<div class="line"><span class="lineno"> 1003</span>  <span class="keyword">auto</span> row_diff_base_functions = row_data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != row_nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span>    <span class="comment">// Get volume and integration weight</span></div>
<div class="line"><span class="lineno"> 1008</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line"><span class="lineno"> 1009</span> </div>
<div class="line"><span class="lineno"> 1010</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> kp = commonData.getCFromDensity(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line"><span class="lineno"> 1011</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> kp_diff = commonData.getCFromDensityDiff(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line"><span class="lineno"> 1012</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * kp * ((<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> - <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) / <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>) * pow(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> - <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) * psi;</div>
<div class="line"><span class="lineno"> 1013</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> a_diff =</div>
<div class="line"><span class="lineno"> 1014</span>        <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * kp_diff * (pow(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> - <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) * psi - psi_ref);</div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span>    <span class="keywordtype">int</span> row_bb = 0;</div>
<div class="line"><span class="lineno"> 1017</span>    <span class="keywordflow">for</span> (; row_bb != row_nb_dofs; row_bb++) {</div>
<div class="line"><span class="lineno"> 1018</span>      <span class="keyword">auto</span> col_base_functions = col_data.getFTensor0N(gg, 0);</div>
<div class="line"><span class="lineno"> 1019</span>      <span class="keyword">auto</span> col_diff_base_functions = col_data.getFTensor1DiffN&lt;3&gt;(gg, 0);</div>
<div class="line"><span class="lineno"> 1020</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col_bb = 0; col_bb != col_nb_dofs; col_bb++) {</div>
<div class="line"><span class="lineno"> 1021</span>        locK_rho_rho(row_bb, col_bb) +=</div>
<div class="line"><span class="lineno"> 1022</span>            ts_a * <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * row_base_functions * col_base_functions;</div>
<div class="line"><span class="lineno"> 1023</span>        locK_rho_rho(row_bb, col_bb) -=</div>
<div class="line"><span class="lineno"> 1024</span>            <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * R0 * row_diff_base_functions(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * col_diff_base_functions(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"><span class="lineno"> 1025</span>        locK_rho_rho(row_bb, col_bb) -=</div>
<div class="line"><span class="lineno"> 1026</span>            <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * row_base_functions * col_base_functions;</div>
<div class="line"><span class="lineno"> 1027</span>        locK_rho_rho(row_bb, col_bb) -=</div>
<div class="line"><span class="lineno"> 1028</span>            a_diff * <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * row_base_functions * col_base_functions;</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span>        ++col_base_functions;</div>
<div class="line"><span class="lineno"> 1031</span>        ++col_diff_base_functions;</div>
<div class="line"><span class="lineno"> 1032</span>      }</div>
<div class="line"><span class="lineno"> 1033</span>      ++row_base_functions;</div>
<div class="line"><span class="lineno"> 1034</span>      ++row_diff_base_functions;</div>
<div class="line"><span class="lineno"> 1035</span>    }</div>
<div class="line"><span class="lineno"> 1036</span>    <span class="keywordflow">for</span> (; row_bb != row_nb_base_functions; row_bb++) {</div>
<div class="line"><span class="lineno"> 1037</span>      ++row_base_functions;</div>
<div class="line"><span class="lineno"> 1038</span>      ++row_diff_base_functions;</div>
<div class="line"><span class="lineno"> 1039</span>    }</div>
<div class="line"><span class="lineno"> 1040</span>    ++psi;</div>
<div class="line"><span class="lineno"> 1041</span>    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno"> 1042</span>  }</div>
<div class="line"><span class="lineno"> 1043</span> </div>
<div class="line"><span class="lineno"> 1044</span>  <span class="comment">// cerr &lt;&lt; locK_rho_rho &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1045</span> </div>
<div class="line"><span class="lineno"> 1046</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, row_nb_dofs,</div>
<div class="line"><span class="lineno"> 1047</span>                      &amp;*row_data.getIndices().begin(), col_nb_dofs,</div>
<div class="line"><span class="lineno"> 1048</span>                      &amp;*col_data.getIndices().begin(), &amp;locK_rho_rho(0, 0),</div>
<div class="line"><span class="lineno"> 1049</span>                      ADD_VALUES);</div>
<div class="line"><span class="lineno"> 1050</span> </div>
<div class="line"><span class="lineno"> 1051</span>  <span class="comment">// is symmetric</span></div>
<div class="line"><span class="lineno"> 1052</span>  <span class="keywordflow">if</span> (row_side != col_side || row_type != col_type) {</div>
<div class="line"><span class="lineno"> 1053</span>    transLocK_rho_rho.resize(col_nb_dofs, row_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1054</span>    noalias(transLocK_rho_rho) = trans(locK_rho_rho);</div>
<div class="line"><span class="lineno"> 1055</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, col_nb_dofs,</div>
<div class="line"><span class="lineno"> 1056</span>                        &amp;*col_data.getIndices().begin(), row_nb_dofs,</div>
<div class="line"><span class="lineno"> 1057</span>                        &amp;*row_data.getIndices().begin(),</div>
<div class="line"><span class="lineno"> 1058</span>                        &amp;transLocK_rho_rho(0, 0), ADD_VALUES);</div>
<div class="line"><span class="lineno"> 1059</span>  }</div>
<div class="line"><span class="lineno"> 1060</span> </div>
<div class="line"><span class="lineno"> 1061</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1062</span>}</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>OpAssmbleRhoLhs_dF::OpAssmbleRhoLhs_dF(Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno"> 1065</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno"> 1066</span>          <span class="stringliteral">&quot;RHO&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROWCOL),</div>
<div class="line"><span class="lineno"> 1067</span>      commonData(common_data) {</div>
<div class="line"><span class="lineno"> 1068</span>  sYmm = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1069</span>}</div>
<div class="line"><span class="lineno"> 1070</span> </div>
<div class="line"><span class="lineno"> 1071</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno"> 1072</span>OpAssmbleRhoLhs_dF::doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line"><span class="lineno"> 1073</span>                           EntityType col_type,</div>
<div class="line"><span class="lineno"> 1074</span>                           DataForcesAndSourcesCore::EntData &amp;row_data,</div>
<div class="line"><span class="lineno"> 1075</span>                           DataForcesAndSourcesCore::EntData &amp;col_data) {</div>
<div class="line"><span class="lineno"> 1076</span> </div>
<div class="line"><span class="lineno"> 1077</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1078</span> </div>
<div class="line"><span class="lineno"> 1079</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line"><span class="lineno"> 1080</span>  <span class="keywordflow">if</span> (!row_nb_dofs)</div>
<div class="line"><span class="lineno"> 1081</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 1082</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line"><span class="lineno"> 1083</span>  <span class="keywordflow">if</span> (!col_nb_dofs)</div>
<div class="line"><span class="lineno"> 1084</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 1085</span> </div>
<div class="line"><span class="lineno"> 1086</span>  <span class="comment">// Set size can clear local tangent matrix</span></div>
<div class="line"><span class="lineno"> 1087</span>  locK_rho_F.resize(row_nb_dofs, col_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1088</span>  locK_rho_F.clear();</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_gauss_pts = row_data.getN().size1();</div>
<div class="line"><span class="lineno"> 1091</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_base_functions = col_data.getN().size2();</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = commonData.c;</div>
<div class="line"><span class="lineno"> 1094</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = commonData.n;</div>
<div class="line"><span class="lineno"> 1095</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> = commonData.m;</div>
<div class="line"><span class="lineno"> 1096</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line"><span class="lineno"> 1097</span> </div>
<div class="line"><span class="lineno"> 1098</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;I&#39;</span>, 3&gt; <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"><span class="lineno"> 1099</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"><span class="lineno"> 1102</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1104</span>  <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t1;</div>
<div class="line"><span class="lineno"> 1105</span>  <span class="keyword">auto</span> col_diff_base_functions = col_data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != row_nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno"> 1108</span> </div>
<div class="line"><span class="lineno"> 1109</span>    <span class="comment">// Get volume and integration weight</span></div>
<div class="line"><span class="lineno"> 1110</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line"><span class="lineno"> 1111</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> kp = commonData.getCFromDensity(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line"><span class="lineno"> 1112</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * kp * pow(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> - <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>);</div>
<div class="line"><span class="lineno"> 1113</span> </div>
<div class="line"><span class="lineno"> 1114</span>    <span class="keywordtype">int</span> col_bb = 0;</div>
<div class="line"><span class="lineno"> 1115</span>    <span class="keywordflow">for</span> (; col_bb != col_nb_dofs / 3; col_bb++) {</div>
<div class="line"><span class="lineno"> 1116</span>      t1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * col_diff_base_functions(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"><span class="lineno"> 1117</span>      <span class="keyword">auto</span> row_base_functions = row_data.getFTensor0N(gg, 0);</div>
<div class="line"><span class="lineno"> 1118</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row_bb = 0; row_bb != row_nb_dofs; row_bb++) {</div>
<div class="line"><span class="lineno"> 1119</span>        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double *, 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>(&amp;locK_rho_F(row_bb, 3 * col_bb + 0),</div>
<div class="line"><span class="lineno"> 1120</span>                                        &amp;locK_rho_F(row_bb, 3 * col_bb + 1),</div>
<div class="line"><span class="lineno"> 1121</span>                                        &amp;locK_rho_F(row_bb, 3 * col_bb + 2));</div>
<div class="line"><span class="lineno"> 1122</span>        <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) -= row_base_functions * t1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1123</span>        ++row_base_functions;</div>
<div class="line"><span class="lineno"> 1124</span>      }</div>
<div class="line"><span class="lineno"> 1125</span>      ++col_diff_base_functions;</div>
<div class="line"><span class="lineno"> 1126</span>    }</div>
<div class="line"><span class="lineno"> 1127</span>    <span class="keywordflow">for</span> (; col_bb != col_nb_base_functions; col_bb++) {</div>
<div class="line"><span class="lineno"> 1128</span>      ++col_diff_base_functions;</div>
<div class="line"><span class="lineno"> 1129</span>    }</div>
<div class="line"><span class="lineno"> 1130</span> </div>
<div class="line"><span class="lineno"> 1131</span>    ++<a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line"><span class="lineno"> 1132</span>    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno"> 1133</span>  }</div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, row_nb_dofs,</div>
<div class="line"><span class="lineno"> 1136</span>                      &amp;*row_data.getIndices().begin(), col_nb_dofs,</div>
<div class="line"><span class="lineno"> 1137</span>                      &amp;*col_data.getIndices().begin(), &amp;locK_rho_F(0, 0),</div>
<div class="line"><span class="lineno"> 1138</span>                      ADD_VALUES);</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1141</span>}</div>
<div class="line"><span class="lineno"> 1142</span><span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> ADOLC&gt;</div>
<div class="line"><span class="lineno"> 1143</span>OpAssmbleStressLhs_dF&lt;ADOLC&gt;::OpAssmbleStressLhs_dF(</div>
<div class="line"><span class="lineno"> 1144</span>    Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno"> 1145</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno"> 1146</span>          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROWCOL),</div>
<div class="line"><span class="lineno"> 1147</span>      commonData(common_data) {</div>
<div class="line"><span class="lineno"> 1148</span>  sYmm = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1149</span>}</div>
<div class="line"><span class="lineno"> 1150</span><span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> ADOLC&gt;</div>
<div class="line"><span class="lineno"> 1151</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> OpAssmbleStressLhs_dF&lt;ADOLC&gt;::doWork(</div>
<div class="line"><span class="lineno"> 1152</span>    <span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type, EntityType col_type,</div>
<div class="line"><span class="lineno"> 1153</span>    DataForcesAndSourcesCore::EntData &amp;row_data,</div>
<div class="line"><span class="lineno"> 1154</span>    DataForcesAndSourcesCore::EntData &amp;col_data) {</div>
<div class="line"><span class="lineno"> 1155</span> </div>
<div class="line"><span class="lineno"> 1156</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1157</span> </div>
<div class="line"><span class="lineno"> 1158</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line"><span class="lineno"> 1159</span>  <span class="keywordflow">if</span> (!row_nb_dofs)</div>
<div class="line"><span class="lineno"> 1160</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 1161</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line"><span class="lineno"> 1162</span>  <span class="keywordflow">if</span> (!col_nb_dofs)</div>
<div class="line"><span class="lineno"> 1163</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> diagonal_block = (row_type == col_type) &amp;&amp; (row_side == col_side);</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>  <span class="comment">// Set size can clear local tangent matrix</span></div>
<div class="line"><span class="lineno"> 1168</span>  locK_P_F.resize(row_nb_dofs, col_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1169</span>  locK_P_F.clear();</div>
<div class="line"><span class="lineno"> 1170</span> </div>
<div class="line"><span class="lineno"> 1171</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_gauss_pts = row_data.getN().size1();</div>
<div class="line"><span class="lineno"> 1172</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_functions = row_data.getN().size2();</div>
<div class="line"><span class="lineno"> 1173</span> </div>
<div class="line"><span class="lineno"> 1174</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;matS = commonData.data.matS;</div>
<div class="line"><span class="lineno"> 1175</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;dP_dF = commonData.data.matPushedMaterialTangent;</div>
<div class="line"><span class="lineno"> 1176</span>  <span class="comment">// MatrixDouble &amp;dS_dC = commonData.data.matMaterialTangent;</span></div>
<div class="line"><span class="lineno"> 1177</span>  <span class="comment">// MatrixDouble &amp;matF = commonData.data.matGradientOfDeformation;</span></div>
<div class="line"><span class="lineno"> 1178</span> </div>
<div class="line"><span class="lineno"> 1179</span>  <span class="keywordtype">double</span> t0;</div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = commonData.n;</div>
<div class="line"><span class="lineno"> 1182</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line"><span class="lineno"> 1183</span> </div>
<div class="line"><span class="lineno"> 1184</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1185</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno"> 1186</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno"> 1187</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;I&#39;</span>, 3&gt; <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"><span class="lineno"> 1188</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;J&#39;</span>, 3&gt; <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line"><span class="lineno"> 1189</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;K&#39;</span>, 3&gt; <a class="code hl_variable" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>;</div>
<div class="line"><span class="lineno"> 1190</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;L&#39;</span>, 3&gt; <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>;</div>
<div class="line"><span class="lineno"> 1191</span> </div>
<div class="line"><span class="lineno"> 1192</span>  <span class="keyword">auto</span> row_diff_base_functions = row_data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line"><span class="lineno"> 1193</span>  <a class="code hl_class" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;double *, 3, 3, 3, 3&gt;</a> D2(<a class="code hl_define" href="Remodeling_8cpp.html#aff752f795f2d1fdbee680e2e1630d50c">TENSOR4_MAT_PTR</a>(dP_dF));</div>
<div class="line"><span class="lineno"> 1194</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a> S(<a class="code hl_define" href="Remodeling_8cpp.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a>(matS), 6);</div>
<div class="line"><span class="lineno"> 1195</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"><span class="lineno"> 1196</span> </div>
<div class="line"><span class="lineno"> 1197</span>  <span class="comment">// FTensor::Tensor4_ddg&lt;double*,3,3&gt; D1(SYMMETRIC_TENSOR4_MAT_PTR(dS_dC),6);</span></div>
<div class="line"><span class="lineno"> 1198</span>  <span class="comment">// FTensor::Tensor2&lt;double*,3,3&gt; F(TENSOR2_MAT_PTR(matF));</span></div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != row_nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>    <span class="comment">// Get volume and integration weight</span></div>
<div class="line"><span class="lineno"> 1203</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line"><span class="lineno"> 1204</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * pow(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>    <span class="keywordtype">int</span> row_bb = 0;</div>
<div class="line"><span class="lineno"> 1207</span>    <span class="keywordflow">for</span> (; row_bb != row_nb_dofs / 3; row_bb++) {</div>
<div class="line"><span class="lineno"> 1208</span> </div>
<div class="line"><span class="lineno"> 1209</span>      <span class="keyword">auto</span> col_diff_base_functions = col_data.getFTensor1DiffN&lt;3&gt;(gg, 0);</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> final_bb = diagonal_block ? row_bb + 1 : col_nb_dofs / 3;</div>
<div class="line"><span class="lineno"> 1212</span>      <span class="keywordtype">int</span> col_bb = 0;</div>
<div class="line"><span class="lineno"> 1213</span>      <span class="keywordflow">for</span> (; col_bb != final_bb; col_bb++) {</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>        <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> t_assemble(</div>
<div class="line"><span class="lineno"> 1216</span>            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 0),</div>
<div class="line"><span class="lineno"> 1217</span>            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 1),</div>
<div class="line"><span class="lineno"> 1218</span>            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 2),</div>
<div class="line"><span class="lineno"> 1219</span>            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 0),</div>
<div class="line"><span class="lineno"> 1220</span>            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 1),</div>
<div class="line"><span class="lineno"> 1221</span>            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 2),</div>
<div class="line"><span class="lineno"> 1222</span>            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 0),</div>
<div class="line"><span class="lineno"> 1223</span>            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 1),</div>
<div class="line"><span class="lineno"> 1224</span>            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 2));</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>        diffDiff(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) =</div>
<div class="line"><span class="lineno"> 1227</span>            <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * row_diff_base_functions(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) * col_diff_base_functions(<a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>);</div>
<div class="line"><span class="lineno"> 1228</span> </div>
<div class="line"><span class="lineno"> 1229</span>        <span class="comment">// TODO: FIXME: Tensor D2 has major symmetry, we do not have such tensor</span></div>
<div class="line"><span class="lineno"> 1230</span>        <span class="comment">// implemented at the moment. Using tensor with major symmetry will</span></div>
<div class="line"><span class="lineno"> 1231</span>        <span class="comment">// improve code efficiency.</span></div>
<div class="line"><span class="lineno"> 1232</span>        t_assemble(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += diffDiff(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) * D2(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>);</div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>        <span class="keywordflow">if</span> (ADOLC) {</div>
<div class="line"><span class="lineno"> 1235</span>          <span class="comment">// Stress stiffening part (only with adolc since it is using dS / dC</span></div>
<div class="line"><span class="lineno"> 1236</span>          <span class="comment">// derrivative. Check OpCalculateStressTangentWithAdolc operator)</span></div>
<div class="line"><span class="lineno"> 1237</span>          t0 = diffDiff(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) * S(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>);</div>
<div class="line"><span class="lineno"> 1238</span>          t_assemble(0, 0) += t0;</div>
<div class="line"><span class="lineno"> 1239</span>          t_assemble(1, 1) += t0;</div>
<div class="line"><span class="lineno"> 1240</span>          t_assemble(2, 2) += t0;</div>
<div class="line"><span class="lineno"> 1241</span>        }</div>
<div class="line"><span class="lineno"> 1242</span> </div>
<div class="line"><span class="lineno"> 1243</span>        <span class="comment">// Next base function for column</span></div>
<div class="line"><span class="lineno"> 1244</span>        ++col_diff_base_functions;</div>
<div class="line"><span class="lineno"> 1245</span>      }</div>
<div class="line"><span class="lineno"> 1246</span> </div>
<div class="line"><span class="lineno"> 1247</span>      ++row_diff_base_functions;</div>
<div class="line"><span class="lineno"> 1248</span>    }</div>
<div class="line"><span class="lineno"> 1249</span>    <span class="keywordflow">for</span> (; row_bb != row_nb_base_functions; row_bb++) {</div>
<div class="line"><span class="lineno"> 1250</span>      ++row_diff_base_functions;</div>
<div class="line"><span class="lineno"> 1251</span>    }</div>
<div class="line"><span class="lineno"> 1252</span> </div>
<div class="line"><span class="lineno"> 1253</span>    <span class="comment">// ++D1;</span></div>
<div class="line"><span class="lineno"> 1254</span>    ++D2;</div>
<div class="line"><span class="lineno"> 1255</span>    ++S;</div>
<div class="line"><span class="lineno"> 1256</span>    <span class="comment">// ++F;</span></div>
<div class="line"><span class="lineno"> 1257</span>    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno"> 1258</span>  }</div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1260</span>  <span class="comment">// Copy of symmetric part for assemble</span></div>
<div class="line"><span class="lineno"> 1261</span>  <span class="keywordflow">if</span> (diagonal_block) {</div>
<div class="line"><span class="lineno"> 1262</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row_bb = 0; row_bb != row_nb_dofs / 3; row_bb++) {</div>
<div class="line"><span class="lineno"> 1263</span>      <span class="keywordtype">int</span> col_bb = 0;</div>
<div class="line"><span class="lineno"> 1264</span>      <span class="keywordflow">for</span> (; col_bb != row_bb + 1; col_bb++) {</div>
<div class="line"><span class="lineno"> 1265</span>        <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> t_assemble(</div>
<div class="line"><span class="lineno"> 1266</span>            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 0),</div>
<div class="line"><span class="lineno"> 1267</span>            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 1),</div>
<div class="line"><span class="lineno"> 1268</span>            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 2),</div>
<div class="line"><span class="lineno"> 1269</span>            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 0),</div>
<div class="line"><span class="lineno"> 1270</span>            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 1),</div>
<div class="line"><span class="lineno"> 1271</span>            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 2),</div>
<div class="line"><span class="lineno"> 1272</span>            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 0),</div>
<div class="line"><span class="lineno"> 1273</span>            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 1),</div>
<div class="line"><span class="lineno"> 1274</span>            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 2));</div>
<div class="line"><span class="lineno"> 1275</span>        <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> t_off_side(</div>
<div class="line"><span class="lineno"> 1276</span>            &amp;locK_P_F(3 * col_bb + 0, 3 * row_bb + 0),</div>
<div class="line"><span class="lineno"> 1277</span>            &amp;locK_P_F(3 * col_bb + 0, 3 * row_bb + 1),</div>
<div class="line"><span class="lineno"> 1278</span>            &amp;locK_P_F(3 * col_bb + 0, 3 * row_bb + 2),</div>
<div class="line"><span class="lineno"> 1279</span>            &amp;locK_P_F(3 * col_bb + 1, 3 * row_bb + 0),</div>
<div class="line"><span class="lineno"> 1280</span>            &amp;locK_P_F(3 * col_bb + 1, 3 * row_bb + 1),</div>
<div class="line"><span class="lineno"> 1281</span>            &amp;locK_P_F(3 * col_bb + 1, 3 * row_bb + 2),</div>
<div class="line"><span class="lineno"> 1282</span>            &amp;locK_P_F(3 * col_bb + 2, 3 * row_bb + 0),</div>
<div class="line"><span class="lineno"> 1283</span>            &amp;locK_P_F(3 * col_bb + 2, 3 * row_bb + 1),</div>
<div class="line"><span class="lineno"> 1284</span>            &amp;locK_P_F(3 * col_bb + 2, 3 * row_bb + 2));</div>
<div class="line"><span class="lineno"> 1285</span>        t_off_side(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = t_assemble(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1286</span>      }</div>
<div class="line"><span class="lineno"> 1287</span>    }</div>
<div class="line"><span class="lineno"> 1288</span>  }</div>
<div class="line"><span class="lineno"> 1289</span> </div>
<div class="line"><span class="lineno"> 1290</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> *row_ind = &amp;*row_data.getIndices().begin();</div>
<div class="line"><span class="lineno"> 1291</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> *col_ind = &amp;*col_data.getIndices().begin();</div>
<div class="line"><span class="lineno"> 1292</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, row_nb_dofs, row_ind, col_nb_dofs,</div>
<div class="line"><span class="lineno"> 1293</span>                      col_ind, &amp;locK_P_F(0, 0), ADD_VALUES);</div>
<div class="line"><span class="lineno"> 1294</span> </div>
<div class="line"><span class="lineno"> 1295</span>  <span class="keywordflow">if</span> (row_type != col_type || row_side != col_side) {</div>
<div class="line"><span class="lineno"> 1296</span>    transLocK_P_F.resize(col_nb_dofs, row_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1297</span>    noalias(transLocK_P_F) = trans(locK_P_F);</div>
<div class="line"><span class="lineno"> 1298</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, col_nb_dofs, col_ind, row_nb_dofs,</div>
<div class="line"><span class="lineno"> 1299</span>                        row_ind, &amp;transLocK_P_F(0, 0), ADD_VALUES);</div>
<div class="line"><span class="lineno"> 1300</span>  }</div>
<div class="line"><span class="lineno"> 1301</span> </div>
<div class="line"><span class="lineno"> 1302</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1303</span>}</div>
<div class="line"><span class="lineno"> 1304</span> </div>
<div class="line"><span class="lineno"> 1305</span>OpAssmbleStressLhs_dRho::OpAssmbleStressLhs_dRho(</div>
<div class="line"><span class="lineno"> 1306</span>    Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno"> 1307</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno"> 1308</span>          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROWCOL),</div>
<div class="line"><span class="lineno"> 1309</span>      commonData(common_data) {</div>
<div class="line"><span class="lineno"> 1310</span>  sYmm = <span class="keyword">false</span>; <span class="comment">// This is off-diagonal (upper-left), so no symmetric</span></div>
<div class="line"><span class="lineno"> 1311</span>}</div>
<div class="line"><span class="lineno"> 1312</span> </div>
<div class="line"><span class="lineno"> 1313</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno"> 1314</span>OpAssmbleStressLhs_dRho::doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line"><span class="lineno"> 1315</span>                                EntityType col_type,</div>
<div class="line"><span class="lineno"> 1316</span>                                DataForcesAndSourcesCore::EntData &amp;row_data,</div>
<div class="line"><span class="lineno"> 1317</span>                                DataForcesAndSourcesCore::EntData &amp;col_data) {</div>
<div class="line"><span class="lineno"> 1318</span> </div>
<div class="line"><span class="lineno"> 1319</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1320</span> </div>
<div class="line"><span class="lineno"> 1321</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line"><span class="lineno"> 1322</span>  <span class="keywordflow">if</span> (!row_nb_dofs)</div>
<div class="line"><span class="lineno"> 1323</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 1324</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line"><span class="lineno"> 1325</span>  <span class="keywordflow">if</span> (!col_nb_dofs)</div>
<div class="line"><span class="lineno"> 1326</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span>  <span class="comment">// Set size can clear local tangent matrix</span></div>
<div class="line"><span class="lineno"> 1329</span>  locK_P_RHO.resize(row_nb_dofs, col_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1330</span>  locK_P_RHO.clear();</div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>  <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t1;</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = commonData.n;</div>
<div class="line"><span class="lineno"> 1335</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line"><span class="lineno"> 1336</span> </div>
<div class="line"><span class="lineno"> 1337</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;I&#39;</span>, 3&gt; <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"><span class="lineno"> 1338</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1339</span> </div>
<div class="line"><span class="lineno"> 1340</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line"><span class="lineno"> 1341</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_gauss_pts = row_data.getN().size1();</div>
<div class="line"><span class="lineno"> 1344</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_functions = row_data.getN().size2();</div>
<div class="line"><span class="lineno"> 1345</span>  <span class="keyword">auto</span> row_diff_base_functions = row_data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line"><span class="lineno"> 1346</span> </div>
<div class="line"><span class="lineno"> 1347</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != row_nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno"> 1348</span> </div>
<div class="line"><span class="lineno"> 1349</span>    <span class="comment">// Get volume and integration weight</span></div>
<div class="line"><span class="lineno"> 1350</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line"><span class="lineno"> 1351</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * (<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> / <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>) * pow(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span>    <span class="keywordtype">int</span> row_bb = 0;</div>
<div class="line"><span class="lineno"> 1354</span>    <span class="keywordflow">for</span> (; row_bb != row_nb_dofs / 3; row_bb++) {</div>
<div class="line"><span class="lineno"> 1355</span>      t1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * row_diff_base_functions(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"><span class="lineno"> 1356</span>      <span class="keyword">auto</span> base_functions = col_data.getFTensor0N(gg, 0);</div>
<div class="line"><span class="lineno"> 1357</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col_bb = 0; col_bb != col_nb_dofs; col_bb++) {</div>
<div class="line"><span class="lineno"> 1358</span>        <span class="comment">// if(base_functions!=col_data.getN(gg)[col_bb]) {</span></div>
<div class="line"><span class="lineno"> 1359</span>        <span class="comment">//   cerr &lt;&lt; &quot;Error&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1360</span>        <span class="comment">// }</span></div>
<div class="line"><span class="lineno"> 1361</span>        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double *, 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>(&amp;locK_P_RHO(3 * row_bb + 0, col_bb),</div>
<div class="line"><span class="lineno"> 1362</span>                                        &amp;locK_P_RHO(3 * row_bb + 1, col_bb),</div>
<div class="line"><span class="lineno"> 1363</span>                                        &amp;locK_P_RHO(3 * row_bb + 2, col_bb));</div>
<div class="line"><span class="lineno"> 1364</span>        <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += t1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * base_functions;</div>
<div class="line"><span class="lineno"> 1365</span>        ++base_functions;</div>
<div class="line"><span class="lineno"> 1366</span>      }</div>
<div class="line"><span class="lineno"> 1367</span>      ++row_diff_base_functions;</div>
<div class="line"><span class="lineno"> 1368</span>    }</div>
<div class="line"><span class="lineno"> 1369</span>    <span class="keywordflow">for</span> (; row_bb != row_nb_base_functions; row_bb++) {</div>
<div class="line"><span class="lineno"> 1370</span>      ++row_diff_base_functions;</div>
<div class="line"><span class="lineno"> 1371</span>    }</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>    ++<a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line"><span class="lineno"> 1374</span>    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno"> 1375</span>  }</div>
<div class="line"><span class="lineno"> 1376</span> </div>
<div class="line"><span class="lineno"> 1377</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, row_nb_dofs,</div>
<div class="line"><span class="lineno"> 1378</span>                      &amp;*row_data.getIndices().begin(), col_nb_dofs,</div>
<div class="line"><span class="lineno"> 1379</span>                      &amp;*col_data.getIndices().begin(), &amp;locK_P_RHO(0, 0),</div>
<div class="line"><span class="lineno"> 1380</span>                      ADD_VALUES);</div>
<div class="line"><span class="lineno"> 1381</span> </div>
<div class="line"><span class="lineno"> 1382</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1383</span>}</div>
<div class="line"><span class="lineno"> 1384</span> </div>
<div class="line"><span class="lineno"> 1385</span><a class="code hl_function" href="structMonitorPostProc.html#ad6f70f52c3f4c77276fc985a3f7a2795">MonitorPostProc::MonitorPostProc</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line"><span class="lineno"> 1386</span>                                 Remodeling::CommonData &amp;common_data)</div>
<div class="line"><span class="lineno"> 1387</span>    : mField(m_field), commonData(common_data), postProc(m_field),</div>
<div class="line"><span class="lineno"> 1388</span>      postProcElastic(m_field),</div>
<div class="line"><span class="lineno"> 1389</span>      <span class="comment">// densityMaps(m_field),</span></div>
<div class="line"><span class="lineno"> 1390</span>      iNit(false) {}</div>
<div class="line"><span class="lineno"> 1391</span> </div>
<div class="line"><span class="lineno"> 1392</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structMonitorPostProc.html#a6d18eec583bf6954ef3789baf7f6b8c8">MonitorPostProc::preProcess</a>() {</div>
<div class="line"><span class="lineno"> 1393</span>  <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><span class="lineno"> 1394</span>  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 1395</span>}</div>
<div class="line"><span class="lineno"> 1396</span> </div>
<div class="line"><span class="lineno"> 1397</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structMonitorPostProc.html#a695bc88c72bd41eeac7ef7f6d628d014">MonitorPostProc::operator()</a>() {</div>
<div class="line"><span class="lineno"> 1398</span>  <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><span class="lineno"> 1399</span>  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 1400</span>}</div>
<div class="line"><span class="lineno"> 1401</span> </div>
<div class="line"><span class="lineno"> 1402</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structMonitorPostProc.html#a5f9f4333af411bf4de37445782aca1b5">MonitorPostProc::postProcess</a>() {</div>
<div class="line"><span class="lineno"> 1403</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1404</span> </div>
<div class="line"><span class="lineno"> 1405</span>  PetscBool mass_postproc = PETSC_FALSE;</div>
<div class="line"><span class="lineno"> 1406</span>  PetscBool equilibrium_flg = PETSC_FALSE;</div>
<div class="line"><span class="lineno"> 1407</span>  PetscBool analysis_mesh_flg = PETSC_FALSE;</div>
<div class="line"><span class="lineno"> 1408</span>  rate = 1;</div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>  PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Bone remodeling post-process&quot;</span>,</div>
<div class="line"><span class="lineno"> 1411</span>                           <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><span class="lineno"> 1412</span> </div>
<div class="line"><span class="lineno"> 1413</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(</div>
<div class="line"><span class="lineno"> 1414</span>      <span class="stringliteral">&quot;-mass_postproc&quot;</span>,</div>
<div class="line"><span class="lineno"> 1415</span>      <span class="stringliteral">&quot;is used for testing, calculates mass and energy at each time step&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno"> 1416</span>      mass_postproc, &amp;mass_postproc, PETSC_NULL);</div>
<div class="line"><span class="lineno"> 1417</span> </div>
<div class="line"><span class="lineno"> 1418</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-analysis_mesh&quot;</span>,</div>
<div class="line"><span class="lineno"> 1419</span>                          <span class="stringliteral">&quot;saves analysis mesh at each time step&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno"> 1420</span>                          analysis_mesh_flg, &amp;analysis_mesh_flg, PETSC_NULL);</div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(</div>
<div class="line"><span class="lineno"> 1423</span>      <span class="stringliteral">&quot;-equilibrium_stop_rate&quot;</span>,</div>
<div class="line"><span class="lineno"> 1424</span>      <span class="stringliteral">&quot;is used to stop calculations when equilibium state is achieved&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno"> 1425</span>      rate, &amp;rate, &amp;equilibrium_flg);</div>
<div class="line"><span class="lineno"> 1426</span>  PetscOptionsEnd();</div>
<div class="line"><span class="lineno"> 1427</span> </div>
<div class="line"><span class="lineno"> 1428</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structMonitorPostProc.html#ab823a333f47588008ba4ccb98441106c">iNit</a>) {</div>
<div class="line"><span class="lineno"> 1429</span> </div>
<div class="line"><span class="lineno"> 1430</span>    PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno"> 1431</span>                             <span class="stringliteral">&quot;Bone remodeling post-process&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>    <a class="code hl_variable" href="structMonitorPostProc.html#ab9257e533617f512bdba17f408d5b2ba">pRT</a> = 1;</div>
<div class="line"><span class="lineno"> 1434</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_output_prt&quot;</span>,</div>
<div class="line"><span class="lineno"> 1435</span>                           <span class="stringliteral">&quot;frequncy how often results are dumped on hard disk&quot;</span>,</div>
<div class="line"><span class="lineno"> 1436</span>                           <span class="stringliteral">&quot;&quot;</span>, 1, &amp;<a class="code hl_variable" href="structMonitorPostProc.html#ab9257e533617f512bdba17f408d5b2ba">pRT</a>, NULL);</div>
<div class="line"><span class="lineno"> 1437</span>    PetscOptionsEnd();</div>
<div class="line"><span class="lineno"> 1438</span> </div>
<div class="line"><span class="lineno"> 1439</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structMonitorPostProc.html#ae063fb76c9dad0a18017229360462ced">postProc</a>.<a class="code hl_function" href="structPostProcTemplateVolumeOnRefinedMesh.html#a093f5ac63678cfad18c87cd36c6962be">generateReferenceElementMesh</a>();</div>
<div class="line"><span class="lineno"> 1440</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structMonitorPostProc.html#ae063fb76c9dad0a18017229360462ced">postProc</a>.<a class="code hl_function" href="group__mofem__fs__post__proc.html#ga76917498a614262ab7daf1268f1ec429">addFieldValuesPostProc</a>(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1441</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structMonitorPostProc.html#ae063fb76c9dad0a18017229360462ced">postProc</a>.<a class="code hl_function" href="group__mofem__fs__post__proc.html#ga76917498a614262ab7daf1268f1ec429">addFieldValuesPostProc</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1442</span>    <span class="keywordflow">if</span> (!commonData.less_post_proc) {</div>
<div class="line"><span class="lineno"> 1443</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structMonitorPostProc.html#ae063fb76c9dad0a18017229360462ced">postProc</a>.<a class="code hl_function" href="group__mofem__fs__post__proc.html#gac17087ffb048f5fba8ddeb6b49f5abac">addFieldValuesGradientPostProc</a>(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1444</span>    }</div>
<div class="line"><span class="lineno"> 1445</span>    <span class="comment">// CHKERR postProc.addFieldValuesPostProc(&quot;RHO&quot;);</span></div>
<div class="line"><span class="lineno"> 1446</span>    <span class="comment">// CHKERR postProc.addFieldValuesGradientPostProc(&quot;RHO&quot;);</span></div>
<div class="line"><span class="lineno"> 1447</span> </div>
<div class="line"><span class="lineno"> 1448</span>    {</div>
<div class="line"><span class="lineno"> 1449</span>      <span class="keyword">auto</span> &amp;list_of_operators = <a class="code hl_variable" href="structMonitorPostProc.html#ae063fb76c9dad0a18017229360462ced">postProc</a>.getOpPtrVector();</div>
<div class="line"><span class="lineno"> 1450</span> </div>
<div class="line"><span class="lineno"> 1451</span>      list_of_operators.push_back(</div>
<div class="line"><span class="lineno"> 1452</span>          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.rhoPtr));</div>
<div class="line"><span class="lineno"> 1453</span>      list_of_operators.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(</div>
<div class="line"><span class="lineno"> 1454</span>          <span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.gradRhoPtr));</div>
<div class="line"><span class="lineno"> 1455</span>      <span class="comment">// Get displacement gradient at integration points</span></div>
<div class="line"><span class="lineno"> 1456</span>      list_of_operators.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line"><span class="lineno"> 1457</span>          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, commonData.data.gradDispPtr));</div>
<div class="line"><span class="lineno"> 1458</span>      list_of_operators.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structOpCalculateStress.html">OpCalculateStress</a>(commonData));</div>
<div class="line"><span class="lineno"> 1459</span>      list_of_operators.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structOpPostProcStress.html">OpPostProcStress</a>(</div>
<div class="line"><span class="lineno"> 1460</span>          <a class="code hl_variable" href="structMonitorPostProc.html#ae063fb76c9dad0a18017229360462ced">postProc</a>.<a class="code hl_variable" href="structPostProcTemplateOnRefineMesh.html#acd29730f88cf549ab0e5deb0b76476ee">postProcMesh</a>, <a class="code hl_variable" href="structMonitorPostProc.html#ae063fb76c9dad0a18017229360462ced">postProc</a>.<a class="code hl_variable" href="structPostProcTemplateOnRefineMesh.html#a47d46ec67f3f7c3e82a846f3f3887830">mapGaussPts</a>, commonData));</div>
<div class="line"><span class="lineno"> 1461</span>    }</div>
<div class="line"><span class="lineno"> 1462</span> </div>
<div class="line"><span class="lineno"> 1463</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcElastic.<a class="code hl_function" href="structPostProcTemplateVolumeOnRefinedMesh.html#a093f5ac63678cfad18c87cd36c6962be">generateReferenceElementMesh</a>();</div>
<div class="line"><span class="lineno"> 1464</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcElastic.addFieldValuesPostProc(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1465</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcElastic.addFieldValuesPostProc(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1466</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcElastic.addFieldValuesGradientPostProc(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1467</span>    std::map&lt;int, NonlinearElasticElement::BlockData&gt;::iterator sit =</div>
<div class="line"><span class="lineno"> 1468</span>        commonData.elasticPtr-&gt;setOfBlocks.begin();</div>
<div class="line"><span class="lineno"> 1469</span>    <span class="keywordflow">for</span> (; sit != commonData.elasticPtr-&gt;setOfBlocks.end(); sit++) {</div>
<div class="line"><span class="lineno"> 1470</span>      postProcElastic.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structPostProcStress.html">PostProcStress</a>(</div>
<div class="line"><span class="lineno"> 1471</span>          postProcElastic.postProcMesh, postProcElastic.mapGaussPts,</div>
<div class="line"><span class="lineno"> 1472</span>          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, sit-&gt;second, postProcElastic.commonData));</div>
<div class="line"><span class="lineno"> 1473</span>    }</div>
<div class="line"><span class="lineno"> 1474</span> </div>
<div class="line"><span class="lineno"> 1475</span>    <a class="code hl_variable" href="structMonitorPostProc.html#ab823a333f47588008ba4ccb98441106c">iNit</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1476</span>  }</div>
<div class="line"><span class="lineno"> 1477</span> </div>
<div class="line"><span class="lineno"> 1478</span>  <span class="keywordflow">if</span> (mass_postproc) {</div>
<div class="line"><span class="lineno"> 1479</span>    <a class="code hl_typedef" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> mass_vec;</div>
<div class="line"><span class="lineno"> 1480</span>    <a class="code hl_typedef" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> energ_vec;</div>
<div class="line"><span class="lineno"> 1481</span>    <span class="keywordtype">int</span> mass_vec_ghost[] = {0};</div>
<div class="line"><span class="lineno"> 1482</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecCreateGhost(PETSC_COMM_WORLD, (!<a class="code hl_variable" href="structMonitorPostProc.html#a764cb41bba89ad9af982942b3fb22f05">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) ? 1 : 0,</div>
<div class="line"><span class="lineno"> 1483</span>                          1, 1, mass_vec_ghost, &amp;mass_vec);</div>
<div class="line"><span class="lineno"> 1484</span> </div>
<div class="line"><span class="lineno"> 1485</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(mass_vec);</div>
<div class="line"><span class="lineno"> 1486</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(mass_vec, &amp;energ_vec);</div>
<div class="line"><span class="lineno"> 1487</span> </div>
<div class="line"><span class="lineno"> 1488</span>    Remodeling::Fe energyCalc(<a class="code hl_variable" href="structMonitorPostProc.html#a764cb41bba89ad9af982942b3fb22f05">mField</a>);</div>
<div class="line"><span class="lineno"> 1489</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, energyCalc, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 1490</span>                       <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1491</span>    energyCalc.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno"> 1492</span>        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.rhoPtr));</div>
<div class="line"><span class="lineno"> 1493</span>    energyCalc.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(</div>
<div class="line"><span class="lineno"> 1494</span>        <span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.gradRhoPtr));</div>
<div class="line"><span class="lineno"> 1495</span>    energyCalc.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno"> 1496</span>        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>,</div>
<div class="line"><span class="lineno"> 1497</span>                                                 commonData.data.gradDispPtr));</div>
<div class="line"><span class="lineno"> 1498</span>    energyCalc.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structOpCalculateStress.html">OpCalculateStress</a>(commonData));</div>
<div class="line"><span class="lineno"> 1499</span>    energyCalc.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno"> 1500</span>        <span class="keyword">new</span> OpMassAndEnergyCalculation(<span class="stringliteral">&quot;RHO&quot;</span>, commonData, energ_vec, mass_vec));</div>
<div class="line"><span class="lineno"> 1501</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(commonData.dm, <span class="stringliteral">&quot;FE_REMODELLING&quot;</span>,</div>
<div class="line"><span class="lineno"> 1502</span>                                    &amp;energyCalc);</div>
<div class="line"><span class="lineno"> 1503</span> </div>
<div class="line"><span class="lineno"> 1504</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(mass_vec);</div>
<div class="line"><span class="lineno"> 1505</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(mass_vec);</div>
<div class="line"><span class="lineno"> 1506</span>    <span class="keywordtype">double</span> mass_sum;</div>
<div class="line"><span class="lineno"> 1507</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSum(mass_vec, &amp;mass_sum);</div>
<div class="line"><span class="lineno"> 1508</span> </div>
<div class="line"><span class="lineno"> 1509</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(energ_vec);</div>
<div class="line"><span class="lineno"> 1510</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(energ_vec);</div>
<div class="line"><span class="lineno"> 1511</span>    <span class="keywordtype">double</span> energ_sum;</div>
<div class="line"><span class="lineno"> 1512</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSum(energ_vec, &amp;energ_sum);</div>
<div class="line"><span class="lineno"> 1513</span> </div>
<div class="line"><span class="lineno"> 1514</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno"> 1515</span>                       <span class="stringliteral">&quot;Time: %g Mass: %6.5g Elastic energy: %6.5g \n&quot;</span>, <a class="code hl_variable" href="structMoFEM_1_1TSMethod.html#a5eb15bd118b06018110428672a4821c7">ts_t</a>,</div>
<div class="line"><span class="lineno"> 1516</span>                       mass_sum, energ_sum);</div>
<div class="line"><span class="lineno"> 1517</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;mass_vec);</div>
<div class="line"><span class="lineno"> 1518</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;energ_vec);</div>
<div class="line"><span class="lineno"> 1519</span> </div>
<div class="line"><span class="lineno"> 1520</span>    <span class="keywordflow">if</span> (equilibrium_flg) {</div>
<div class="line"><span class="lineno"> 1521</span>      <span class="keywordtype">double</span> equilibrium_rate =</div>
<div class="line"><span class="lineno"> 1522</span>          fabs(energ_sum - commonData.cUrrent_psi) / energ_sum;</div>
<div class="line"><span class="lineno"> 1523</span>      <span class="keywordtype">double</span> equilibrium_mass_rate =</div>
<div class="line"><span class="lineno"> 1524</span>          fabs(mass_sum - commonData.cUrrent_mass) / mass_sum;</div>
<div class="line"><span class="lineno"> 1525</span>      <span class="keywordflow">if</span> (equilibrium_rate &lt; rate) {</div>
<div class="line"><span class="lineno"> 1526</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(</div>
<div class="line"><span class="lineno"> 1527</span>            PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno"> 1528</span>            <span class="stringliteral">&quot;Energy equilibrium state is achieved! Difference = %0.6g %%. \n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1529</span>            equilibrium_rate * 100);</div>
<div class="line"><span class="lineno"> 1530</span>      }</div>
<div class="line"><span class="lineno"> 1531</span>      <span class="keywordflow">if</span> (equilibrium_mass_rate &lt; rate) {</div>
<div class="line"><span class="lineno"> 1532</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(</div>
<div class="line"><span class="lineno"> 1533</span>            PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno"> 1534</span>            <span class="stringliteral">&quot;Mass equilibrium state is achieved! Difference = %0.6g %%. \n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1535</span>            equilibrium_mass_rate * 100);</div>
<div class="line"><span class="lineno"> 1536</span>      }</div>
<div class="line"><span class="lineno"> 1537</span>      commonData.cUrrent_psi = energ_sum;</div>
<div class="line"><span class="lineno"> 1538</span>      commonData.cUrrent_mass = mass_sum;</div>
<div class="line"><span class="lineno"> 1539</span>    }</div>
<div class="line"><span class="lineno"> 1540</span>  }</div>
<div class="line"><span class="lineno"> 1541</span> </div>
<div class="line"><span class="lineno"> 1542</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="structMonitorPostProc.html#ae86e41d15e5ba9e00959d87a0c10c97f">step</a>;</div>
<div class="line"><span class="lineno"> 1543</span><span class="preprocessor">#if PETSC_VERSION_LE(3, 8, 0)</span></div>
<div class="line"><span class="lineno"> 1544</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTimeStepNumber(<a class="code hl_variable" href="structMoFEM_1_1TSMethod.html#a03384a9578841560b71d2705a580c576">ts</a>, &amp;<a class="code hl_variable" href="structMonitorPostProc.html#ae86e41d15e5ba9e00959d87a0c10c97f">step</a>);</div>
<div class="line"><span class="lineno"> 1545</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1546</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetStepNumber(<a class="code hl_variable" href="structMoFEM_1_1TSMethod.html#a03384a9578841560b71d2705a580c576">ts</a>, &amp;<a class="code hl_variable" href="structMonitorPostProc.html#ae86e41d15e5ba9e00959d87a0c10c97f">step</a>);</div>
<div class="line"><span class="lineno"> 1547</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1548</span> </div>
<div class="line"><span class="lineno"> 1549</span>  <span class="keywordflow">if</span> ((<a class="code hl_variable" href="structMonitorPostProc.html#ae86e41d15e5ba9e00959d87a0c10c97f">step</a>) % <a class="code hl_variable" href="structMonitorPostProc.html#ab9257e533617f512bdba17f408d5b2ba">pRT</a> == 0) {</div>
<div class="line"><span class="lineno"> 1550</span> </div>
<div class="line"><span class="lineno"> 1551</span>    ostringstream sss;</div>
<div class="line"><span class="lineno"> 1552</span>    sss &lt;&lt; <span class="stringliteral">&quot;out_&quot;</span> &lt;&lt; <a class="code hl_variable" href="structMonitorPostProc.html#ae86e41d15e5ba9e00959d87a0c10c97f">step</a> &lt;&lt; <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line"><span class="lineno"> 1553</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(commonData.dm, <span class="stringliteral">&quot;FE_REMODELLING&quot;</span>, &amp;<a class="code hl_variable" href="structMonitorPostProc.html#ae063fb76c9dad0a18017229360462ced">postProc</a>);</div>
<div class="line"><span class="lineno"> 1554</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structMonitorPostProc.html#ae063fb76c9dad0a18017229360462ced">postProc</a>.<a class="code hl_variable" href="structPostProcTemplateOnRefineMesh.html#acd29730f88cf549ab0e5deb0b76476ee">postProcMesh</a>.write_file(sss.str().c_str(), <span class="stringliteral">&quot;MOAB&quot;</span>,</div>
<div class="line"><span class="lineno"> 1555</span>                                            <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line"><span class="lineno"> 1556</span>    <span class="keywordflow">if</span> (analysis_mesh_flg) {</div>
<div class="line"><span class="lineno"> 1557</span>      ostringstream ttt;</div>
<div class="line"><span class="lineno"> 1558</span>      ttt &lt;&lt; <span class="stringliteral">&quot;analysis_mesh_&quot;</span> &lt;&lt; <a class="code hl_variable" href="structMonitorPostProc.html#ae86e41d15e5ba9e00959d87a0c10c97f">step</a> &lt;&lt; <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line"><span class="lineno"> 1559</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structMonitorPostProc.html#a764cb41bba89ad9af982942b3fb22f05">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().write_file(ttt.str().c_str(), <span class="stringliteral">&quot;MOAB&quot;</span>,</div>
<div class="line"><span class="lineno"> 1560</span>                                          <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line"><span class="lineno"> 1561</span>    }</div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>    <span class="keywordflow">if</span> (commonData.nOremodellingBlock) {</div>
<div class="line"><span class="lineno"> 1564</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(commonData.dm, <span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line"><span class="lineno"> 1565</span>                                      &amp;postProcElastic);</div>
<div class="line"><span class="lineno"> 1566</span>      ostringstream ss;</div>
<div class="line"><span class="lineno"> 1567</span>      ss &lt;&lt; <span class="stringliteral">&quot;out_elastic_&quot;</span> &lt;&lt; <a class="code hl_variable" href="structMonitorPostProc.html#ae86e41d15e5ba9e00959d87a0c10c97f">step</a> &lt;&lt; <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line"><span class="lineno"> 1568</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcElastic.postProcMesh.write_file(ss.str().c_str(), <span class="stringliteral">&quot;MOAB&quot;</span>,</div>
<div class="line"><span class="lineno"> 1569</span>                                                     <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line"><span class="lineno"> 1570</span>    }</div>
<div class="line"><span class="lineno"> 1571</span>  }</div>
<div class="line"><span class="lineno"> 1572</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1573</span>}</div>
<div class="line"><span class="lineno"> 1574</span> </div>
<div class="line"><span class="lineno"> 1575</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::getParameters() {</div>
<div class="line"><span class="lineno"> 1576</span> </div>
<div class="line"><span class="lineno"> 1577</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1578</span>  PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Bone remodeling&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><span class="lineno"> 1579</span> </div>
<div class="line"><span class="lineno"> 1580</span>  commonData.oRder = 2;</div>
<div class="line"><span class="lineno"> 1581</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_order&quot;</span>, <span class="stringliteral">&quot;default approximation order&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 2,</div>
<div class="line"><span class="lineno"> 1582</span>                         &amp;commonData.oRder, PETSC_NULL);</div>
<div class="line"><span class="lineno"> 1583</span> </div>
<div class="line"><span class="lineno"> 1584</span>  PetscOptionsEnd();</div>
<div class="line"><span class="lineno"> 1585</span> </div>
<div class="line"><span class="lineno"> 1586</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_entities_by_type(0, MBTET, commonData.tEts_all);</div>
<div class="line"><span class="lineno"> 1587</span>  <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(mField, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, it)) {</div>
<div class="line"><span class="lineno"> 1588</span>    <span class="keywordtype">string</span> name = it-&gt;getName();</div>
<div class="line"><span class="lineno"> 1589</span>    <span class="keywordflow">if</span> (name.compare(0, 14, <span class="stringliteral">&quot;NO_REMODELLING&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 1590</span>      commonData.nOremodellingBlock = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1591</span>      <a class="code hl_class" href="classEntityHandle.html">EntityHandle</a> meshset = it-&gt;getMeshset();</div>
<div class="line"><span class="lineno"> 1592</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> this-&gt;mField.get_moab().get_entities_by_type(</div>
<div class="line"><span class="lineno"> 1593</span>          meshset, MBTET, commonData.tEts_block, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1594</span>      commonData.tEts_all =</div>
<div class="line"><span class="lineno"> 1595</span>          subtract(commonData.tEts_all, commonData.tEts_block);</div>
<div class="line"><span class="lineno"> 1596</span>    }</div>
<div class="line"><span class="lineno"> 1597</span>  }</div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1600</span>}</div>
<div class="line"><span class="lineno"> 1601</span> </div>
<div class="line"><span class="lineno"> 1602</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::addFields() {</div>
<div class="line"><span class="lineno"> 1603</span> </div>
<div class="line"><span class="lineno"> 1604</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1605</span> </div>
<div class="line"><span class="lineno"> 1606</span>  <span class="comment">// Seed all mesh entities to MoFEM database, those entities can be potentially</span></div>
<div class="line"><span class="lineno"> 1607</span>  <span class="comment">// used as finite elements or as entities which carry some approximation</span></div>
<div class="line"><span class="lineno"> 1608</span>  <span class="comment">// field.</span></div>
<div class="line"><span class="lineno"> 1609</span>  commonData.bitLevel.set(0);</div>
<div class="line"><span class="lineno"> 1610</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line"><span class="lineno"> 1611</span>      0, 3, commonData.bitLevel);</div>
<div class="line"><span class="lineno"> 1612</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = commonData.oRder;</div>
<div class="line"><span class="lineno"> 1613</span> </div>
<div class="line"><span class="lineno"> 1614</span>  <span class="comment">// Add displacement field</span></div>
<div class="line"><span class="lineno"> 1615</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line"><span class="lineno"> 1616</span>                          <span class="comment">/*AINSWORTH_LOBATTO_BASE*/</span> <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 3,</div>
<div class="line"><span class="lineno"> 1617</span>                          MB_TAG_SPARSE, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><span class="lineno"> 1618</span>  <span class="comment">// Add field representing ho-geometry</span></div>
<div class="line"><span class="lineno"> 1619</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 3,</div>
<div class="line"><span class="lineno"> 1620</span>                          MB_TAG_SPARSE, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><span class="lineno"> 1621</span> </div>
<div class="line"><span class="lineno"> 1622</span>  <span class="comment">// Check if density is available, if not add density field.</span></div>
<div class="line"><span class="lineno"> 1623</span>  <span class="keywordtype">bool</span> add_rho_field = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1624</span>  <span class="keywordflow">if</span> (!mField.check_field(<span class="stringliteral">&quot;RHO&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 1625</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<span class="stringliteral">&quot;RHO&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1,</div>
<div class="line"><span class="lineno"> 1626</span>                            MB_TAG_SPARSE, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><span class="lineno"> 1627</span>    <span class="comment">// FIXME</span></div>
<div class="line"><span class="lineno"> 1628</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(commonData.tEts_all, MBTET, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line"><span class="lineno"> 1629</span>    <span class="comment">// CHKERR mField.add_ents_to_field_by_type(0,MBTET,&quot;RHO&quot;);</span></div>
<div class="line"><span class="lineno"> 1630</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.synchronise_field_entities(<span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line"><span class="lineno"> 1631</span>    add_rho_field = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBVERTEX, <span class="stringliteral">&quot;RHO&quot;</span>, 1);</div>
<div class="line"><span class="lineno"> 1634</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBEDGE, <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> - 1);</div>
<div class="line"><span class="lineno"> 1635</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBTRI, <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> - 1);</div>
<div class="line"><span class="lineno"> 1636</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBTET, <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> - 1);</div>
<div class="line"><span class="lineno"> 1637</span>  }</div>
<div class="line"><span class="lineno"> 1638</span> </div>
<div class="line"><span class="lineno"> 1639</span>  <span class="comment">// Add entities to field</span></div>
<div class="line"><span class="lineno"> 1640</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(0, MBTET, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1641</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(0, MBTET, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1642</span> </div>
<div class="line"><span class="lineno"> 1643</span>  <span class="comment">// Set approximation order to entities</span></div>
<div class="line"><span class="lineno"> 1644</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBVERTEX, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, 1);</div>
<div class="line"><span class="lineno"> 1645</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBEDGE, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line"><span class="lineno"> 1646</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBTRI, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line"><span class="lineno"> 1647</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBTET, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line"><span class="lineno"> 1648</span> </div>
<div class="line"><span class="lineno"> 1649</span>  <span class="comment">// Assumes that geometry is approximated using 2nd order polynomials.</span></div>
<div class="line"><span class="lineno"> 1650</span> </div>
<div class="line"><span class="lineno"> 1651</span>  <span class="comment">// Apply 2nd order only on skin</span></div>
<div class="line"><span class="lineno"> 1652</span>  {</div>
<div class="line"><span class="lineno"> 1653</span>    <span class="comment">// Skinner skin(&amp;mField.get_moab());</span></div>
<div class="line"><span class="lineno"> 1654</span>    <span class="comment">// Range faces,tets;</span></div>
<div class="line"><span class="lineno"> 1655</span>    <span class="comment">// CHKERR mField.get_moab().get_entities_by_type(0,MBTET,tets);</span></div>
<div class="line"><span class="lineno"> 1656</span>    <span class="comment">// CHKERR skin.find_skin(0,tets,false,faces);</span></div>
<div class="line"><span class="lineno"> 1657</span>    <span class="comment">// Range edges;</span></div>
<div class="line"><span class="lineno"> 1658</span>    <span class="comment">// CHKERR mField.get_moab().get_adjacencies(</span></div>
<div class="line"><span class="lineno"> 1659</span>    <span class="comment">// faces,1,false,edges,moab::Interface::UNION</span></div>
<div class="line"><span class="lineno"> 1660</span>    <span class="comment">// );</span></div>
<div class="line"><span class="lineno"> 1661</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBEDGE, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 2);</div>
<div class="line"><span class="lineno"> 1662</span>  }</div>
<div class="line"><span class="lineno"> 1663</span> </div>
<div class="line"><span class="lineno"> 1664</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBVERTEX, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 1);</div>
<div class="line"><span class="lineno"> 1665</span> </div>
<div class="line"><span class="lineno"> 1666</span>  <span class="comment">// Build fields</span></div>
<div class="line"><span class="lineno"> 1667</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_fields();</div>
<div class="line"><span class="lineno"> 1668</span> </div>
<div class="line"><span class="lineno"> 1669</span>  <span class="comment">// If order was not set from CT scans set homogenous order equal to</span></div>
<div class="line"><span class="lineno"> 1670</span>  <span class="comment">// reference bone density</span></div>
<div class="line"><span class="lineno"> 1671</span>  <span class="keywordflow">if</span> (add_rho_field) {</div>
<div class="line"><span class="lineno"> 1672</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code hl_struct" href="structMoFEM_1_1FieldBlas.html">FieldBlas</a>&gt;()-&gt;setField(commonData.rHo_ref,</div>
<div class="line"><span class="lineno"> 1673</span>                                                      MBVERTEX, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line"><span class="lineno"> 1674</span>    <span class="comment">// const DofEntity_multiIndex *dofs_ptr;</span></div>
<div class="line"><span class="lineno"> 1675</span>    <span class="comment">// CHKERR mField.get_dofs(&amp;dofs_ptr);</span></div>
<div class="line"><span class="lineno"> 1676</span>    <span class="comment">// for(_IT_GET_DOFS_FIELD_BY_NAME_FOR_LOOP_(mField,&quot;RHO&quot;,dit)) {</span></div>
<div class="line"><span class="lineno"> 1677</span>    <span class="comment">//   cerr &lt;&lt; (*dit)-&gt;getFieldData() &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1678</span>    <span class="comment">// }</span></div>
<div class="line"><span class="lineno"> 1679</span>  }</div>
<div class="line"><span class="lineno"> 1680</span> </div>
<div class="line"><span class="lineno"> 1681</span>  <span class="comment">// Project geometry given on 10-node tets on ho-geometry</span></div>
<div class="line"><span class="lineno"> 1682</span>  <a class="code hl_struct" href="structMoFEM_1_1Projection10NodeCoordsOnField.html">Projection10NodeCoordsOnField</a> ent_method_material(mField,</div>
<div class="line"><span class="lineno"> 1683</span>                                                    <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1684</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.loop_dofs(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, ent_method_material);</div>
<div class="line"><span class="lineno"> 1685</span> </div>
<div class="line"><span class="lineno"> 1686</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1687</span>}</div>
<div class="line"><span class="lineno"> 1688</span> </div>
<div class="line"><span class="lineno"> 1689</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::addElements() {</div>
<div class="line"><span class="lineno"> 1690</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1691</span> </div>
<div class="line"><span class="lineno"> 1692</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><span class="lineno"> 1693</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_row(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>,</div>
<div class="line"><span class="lineno"> 1694</span>                                                    <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1695</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_col(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>,</div>
<div class="line"><span class="lineno"> 1696</span>                                                    <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1697</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>,</div>
<div class="line"><span class="lineno"> 1698</span>                                                     <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1699</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line"><span class="lineno"> 1700</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>,</div>
<div class="line"><span class="lineno"> 1701</span>                                                     <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1702</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_row(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line"><span class="lineno"> 1703</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_col(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line"><span class="lineno"> 1704</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(commonData.tEts_all, MBTET,</div>
<div class="line"><span class="lineno"> 1705</span>                                                   <span class="stringliteral">&quot;FE_REMODELLING&quot;</span>);</div>
<div class="line"><span class="lineno"> 1706</span> </div>
<div class="line"><span class="lineno"> 1707</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(<span class="stringliteral">&quot;ELASTIC&quot;</span>);</div>
<div class="line"><span class="lineno"> 1708</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_row(<span class="stringliteral">&quot;ELASTIC&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1709</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_col(<span class="stringliteral">&quot;ELASTIC&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1710</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(<span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line"><span class="lineno"> 1711</span>                                                     <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1712</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(<span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line"><span class="lineno"> 1713</span>                                                     <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1714</span> </div>
<div class="line"><span class="lineno"> 1715</span>  <span class="keywordflow">if</span> (commonData.nOremodellingBlock) {</div>
<div class="line"><span class="lineno"> 1716</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(commonData.tEts_block,</div>
<div class="line"><span class="lineno"> 1717</span>                                                     MBTET, <span class="stringliteral">&quot;ELASTIC&quot;</span>);</div>
<div class="line"><span class="lineno"> 1718</span>  }</div>
<div class="line"><span class="lineno"> 1719</span>  </div>
<div class="line"><span class="lineno"> 1720</span>  commonData.elasticMaterialsPtr =</div>
<div class="line"><span class="lineno"> 1721</span>      boost::shared_ptr&lt;ElasticMaterials&gt;(<span class="keyword">new</span> <a class="code hl_struct" href="structElasticMaterials.html">ElasticMaterials</a>(mField));</div>
<div class="line"><span class="lineno"> 1722</span>  commonData.elasticPtr = boost::shared_ptr&lt;NonlinearElasticElement&gt;(</div>
<div class="line"><span class="lineno"> 1723</span>      <span class="keyword">new</span> <a class="code hl_struct" href="structNonlinearElasticElement.html">NonlinearElasticElement</a>(mField, 10));</div>
<div class="line"><span class="lineno"> 1724</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> commonData.elasticMaterialsPtr-&gt;setBlocks(</div>
<div class="line"><span class="lineno"> 1725</span>      commonData.elasticPtr-&gt;setOfBlocks);</div>
<div class="line"><span class="lineno"> 1726</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> commonData.elasticPtr-&gt;addElement(<span class="stringliteral">&quot;ELASTIC&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1727</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> commonData.elasticPtr-&gt;setOperators(</div>
<div class="line"><span class="lineno"> 1728</span>      <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1729</span> </div>
<div class="line"><span class="lineno"> 1730</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_finite_elements();</div>
<div class="line"><span class="lineno"> 1731</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_adjacencies(commonData.bitLevel);</div>
<div class="line"><span class="lineno"> 1732</span> </div>
<div class="line"><span class="lineno"> 1733</span>  <span class="comment">// Allocate memory for density and gradient of displacements at integration</span></div>
<div class="line"><span class="lineno"> 1734</span>  <span class="comment">// points</span></div>
<div class="line"><span class="lineno"> 1735</span>  commonData.data.rhoPtr = boost::shared_ptr&lt;VectorDouble&gt;(<span class="keyword">new</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a>());</div>
<div class="line"><span class="lineno"> 1736</span>  commonData.data.gradRhoPtr =</div>
<div class="line"><span class="lineno"> 1737</span>      boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>());</div>
<div class="line"><span class="lineno"> 1738</span>  commonData.data.gradDispPtr =</div>
<div class="line"><span class="lineno"> 1739</span>      boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>());</div>
<div class="line"><span class="lineno"> 1740</span> </div>
<div class="line"><span class="lineno"> 1741</span>  <span class="comment">// Add operators Rhs</span></div>
<div class="line"><span class="lineno"> 1742</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *(commonData.feRhs), <span class="keyword">true</span>, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 1743</span>                     <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1744</span>  <span class="keyword">auto</span> &amp;list_of_operators_rhs = commonData.feRhs-&gt;getOpPtrVector();</div>
<div class="line"><span class="lineno"> 1745</span>  <span class="comment">// Get density at integration points</span></div>
<div class="line"><span class="lineno"> 1746</span>  list_of_operators_rhs.push_back(</div>
<div class="line"><span class="lineno"> 1747</span>      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.rhoPtr));</div>
<div class="line"><span class="lineno"> 1748</span>  list_of_operators_rhs.push_back(</div>
<div class="line"><span class="lineno"> 1749</span>      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.gradRhoPtr));</div>
<div class="line"><span class="lineno"> 1750</span>  list_of_operators_rhs.push_back(<span class="keyword">new</span> OpGetRhoTimeDirevative(commonData));</div>
<div class="line"><span class="lineno"> 1751</span>  <span class="comment">// Get displacement gradient at integration points</span></div>
<div class="line"><span class="lineno"> 1752</span>  list_of_operators_rhs.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line"><span class="lineno"> 1753</span>      <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, commonData.data.gradDispPtr));</div>
<div class="line"><span class="lineno"> 1754</span>  list_of_operators_rhs.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structOpCalculateStress.html">OpCalculateStress</a>(commonData));</div>
<div class="line"><span class="lineno"> 1755</span>  list_of_operators_rhs.push_back(<span class="keyword">new</span> OpAssmbleStressRhs(commonData));</div>
<div class="line"><span class="lineno"> 1756</span>  list_of_operators_rhs.push_back(<span class="keyword">new</span> OpAssmbleRhoRhs(commonData));</div>
<div class="line"><span class="lineno"> 1757</span> </div>
<div class="line"><span class="lineno"> 1758</span>  <span class="comment">// Add operators Lhs</span></div>
<div class="line"><span class="lineno"> 1759</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *(commonData.feLhs), <span class="keyword">true</span>, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 1760</span>                     <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1761</span>  <span class="keyword">auto</span> &amp;list_of_operators_lhs = commonData.feLhs-&gt;getOpPtrVector();</div>
<div class="line"><span class="lineno"> 1762</span>  <span class="comment">// Get density at integration points</span></div>
<div class="line"><span class="lineno"> 1763</span>  list_of_operators_lhs.push_back(</div>
<div class="line"><span class="lineno"> 1764</span>      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.rhoPtr));</div>
<div class="line"><span class="lineno"> 1765</span>  list_of_operators_rhs.push_back(</div>
<div class="line"><span class="lineno"> 1766</span>      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.gradRhoPtr));</div>
<div class="line"><span class="lineno"> 1767</span>  <span class="comment">// Get displacement gradient at integration points</span></div>
<div class="line"><span class="lineno"> 1768</span>  list_of_operators_lhs.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line"><span class="lineno"> 1769</span>      <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, commonData.data.gradDispPtr));</div>
<div class="line"><span class="lineno"> 1770</span>  <span class="keywordflow">if</span> (commonData.with_adol_c) {</div>
<div class="line"><span class="lineno"> 1771</span>    list_of_operators_lhs.push_back(</div>
<div class="line"><span class="lineno"> 1772</span>        <span class="keyword">new</span> OpCalculateStressTangentWithAdolc(commonData));</div>
<div class="line"><span class="lineno"> 1773</span>    list_of_operators_lhs.push_back(</div>
<div class="line"><span class="lineno"> 1774</span>        <span class="keyword">new</span> OpAssmbleStressLhs_dF&lt;true&gt;(commonData));</div>
<div class="line"><span class="lineno"> 1775</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1776</span>    list_of_operators_lhs.push_back(<span class="keyword">new</span> OpCalculateStressTangent(commonData));</div>
<div class="line"><span class="lineno"> 1777</span>    list_of_operators_lhs.push_back(</div>
<div class="line"><span class="lineno"> 1778</span>        <span class="keyword">new</span> OpAssmbleStressLhs_dF&lt;false&gt;(commonData));</div>
<div class="line"><span class="lineno"> 1779</span>  }</div>
<div class="line"><span class="lineno"> 1780</span>  list_of_operators_lhs.push_back(<span class="keyword">new</span> OpAssmbleRhoLhs_dRho(commonData));</div>
<div class="line"><span class="lineno"> 1781</span>  list_of_operators_lhs.push_back(<span class="keyword">new</span> OpAssmbleRhoLhs_dF(commonData));</div>
<div class="line"><span class="lineno"> 1782</span>  list_of_operators_lhs.push_back(<span class="keyword">new</span> OpAssmbleStressLhs_dRho(commonData));</div>
<div class="line"><span class="lineno"> 1783</span> </div>
<div class="line"><span class="lineno"> 1784</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1785</span>}</div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::addMomentumFluxes() {</div>
<div class="line"><span class="lineno"> 1788</span> </div>
<div class="line"><span class="lineno"> 1789</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1790</span>  <span class="comment">// Add Neumann forces elements</span></div>
<div class="line"><span class="lineno"> 1791</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MetaNeummanForces::addNeumannBCElements(mField, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1792</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structMetaNodalForces.html#a8e0b96853208e8320b7268f96f4fd8ee">MetaNodalForces::addElement</a>(mField, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1793</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structMetaEdgeForces.html#ad4ba172a5f79e0c41430c6dcecdd95f8">MetaEdgeForces::addElement</a>(mField, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1794</span> </div>
<div class="line"><span class="lineno"> 1795</span>  <span class="comment">// forces and pressures on surface</span></div>
<div class="line"><span class="lineno"> 1796</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MetaNeummanForces::setMomentumFluxOperators(</div>
<div class="line"><span class="lineno"> 1797</span>      mField, commonData.neumannForces, PETSC_NULL, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1798</span>  <span class="comment">// noadl forces</span></div>
<div class="line"><span class="lineno"> 1799</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structMetaNodalForces.html#a84ba4b4c66e9df18c139cb81808cadc2">MetaNodalForces::setOperators</a>(mField, commonData.nodalForces,</div>
<div class="line"><span class="lineno"> 1800</span>                                       PETSC_NULL, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1801</span>  <span class="comment">// edge forces</span></div>
<div class="line"><span class="lineno"> 1802</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structMetaEdgeForces.html#a46625c9571b0469a5c4a7aa1c8f6c272">MetaEdgeForces::setOperators</a>(mField, commonData.edgeForces, PETSC_NULL,</div>
<div class="line"><span class="lineno"> 1803</span>                                      <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1804</span> </div>
<div class="line"><span class="lineno"> 1805</span>  <span class="keywordflow">for</span> (boost::ptr_map&lt;string, NeummanForcesSurface&gt;::iterator mit =</div>
<div class="line"><span class="lineno"> 1806</span>           commonData.neumannForces.begin();</div>
<div class="line"><span class="lineno"> 1807</span>       mit != commonData.neumannForces.end(); mit++) {</div>
<div class="line"><span class="lineno"> 1808</span>    mit-&gt;second-&gt;methodsOp.push_back(</div>
<div class="line"><span class="lineno"> 1809</span>        <span class="keyword">new</span> <a class="code hl_struct" href="structTimeForceScale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_load_history&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno"> 1810</span>  }</div>
<div class="line"><span class="lineno"> 1811</span>  <span class="keywordflow">for</span> (boost::ptr_map&lt;string, NodalForce&gt;::iterator mit =</div>
<div class="line"><span class="lineno"> 1812</span>           commonData.nodalForces.begin();</div>
<div class="line"><span class="lineno"> 1813</span>       mit != commonData.nodalForces.end(); mit++) {</div>
<div class="line"><span class="lineno"> 1814</span>    mit-&gt;second-&gt;methodsOp.push_back(</div>
<div class="line"><span class="lineno"> 1815</span>        <span class="keyword">new</span> <a class="code hl_struct" href="structTimeForceScale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_load_history&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno"> 1816</span>  }</div>
<div class="line"><span class="lineno"> 1817</span>  <span class="keywordflow">for</span> (boost::ptr_map&lt;string, EdgeForce&gt;::iterator mit =</div>
<div class="line"><span class="lineno"> 1818</span>           commonData.edgeForces.begin();</div>
<div class="line"><span class="lineno"> 1819</span>       mit != commonData.edgeForces.end(); mit++) {</div>
<div class="line"><span class="lineno"> 1820</span>    mit-&gt;second-&gt;methodsOp.push_back(</div>
<div class="line"><span class="lineno"> 1821</span>        <span class="keyword">new</span> <a class="code hl_struct" href="structTimeForceScale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_load_history&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno"> 1822</span>  }</div>
<div class="line"><span class="lineno"> 1823</span> </div>
<div class="line"><span class="lineno"> 1824</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1825</span>}</div>
<div class="line"><span class="lineno"> 1826</span> </div>
<div class="line"><span class="lineno"> 1827</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::buildDM() {</div>
<div class="line"><span class="lineno"> 1828</span> </div>
<div class="line"><span class="lineno"> 1829</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1830</span>  commonData.dm_name = <span class="stringliteral">&quot;DM_REMODELING&quot;</span>;</div>
<div class="line"><span class="lineno"> 1831</span>  <span class="comment">// Register DM problem</span></div>
<div class="line"><span class="lineno"> 1832</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(commonData.dm_name);</div>
<div class="line"><span class="lineno"> 1833</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;commonData.dm);</div>
<div class="line"><span class="lineno"> 1834</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(commonData.dm, commonData.dm_name);</div>
<div class="line"><span class="lineno"> 1835</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(commonData.dm, PETSC_TRUE);</div>
<div class="line"><span class="lineno"> 1836</span>  <span class="comment">// Create DM instance</span></div>
<div class="line"><span class="lineno"> 1837</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(commonData.dm, &amp;mField, commonData.dm_name,</div>
<div class="line"><span class="lineno"> 1838</span>                            commonData.bitLevel);</div>
<div class="line"><span class="lineno"> 1839</span>  <span class="comment">// Configure DM form line command options (DM itself, solvers,</span></div>
<div class="line"><span class="lineno"> 1840</span>  <span class="comment">// pre-conditioners, ... )</span></div>
<div class="line"><span class="lineno"> 1841</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetFromOptions(commonData.dm);</div>
<div class="line"><span class="lineno"> 1842</span>  <span class="comment">// Add elements to dm (only one here)</span></div>
<div class="line"><span class="lineno"> 1843</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(commonData.dm, <span class="stringliteral">&quot;FE_REMODELLING&quot;</span>);</div>
<div class="line"><span class="lineno"> 1844</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(commonData.dm, <span class="stringliteral">&quot;ELASTIC&quot;</span>);</div>
<div class="line"><span class="lineno"> 1845</span> </div>
<div class="line"><span class="lineno"> 1846</span>  <span class="keywordflow">if</span> (mField.check_finite_element(<span class="stringliteral">&quot;FORCE_FE&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 1847</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(commonData.dm, <span class="stringliteral">&quot;FORCE_FE&quot;</span>);</div>
<div class="line"><span class="lineno"> 1848</span>  }</div>
<div class="line"><span class="lineno"> 1849</span>  <span class="keywordflow">if</span> (mField.check_finite_element(<span class="stringliteral">&quot;PRESSURE_FE&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 1850</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(commonData.dm, <span class="stringliteral">&quot;PRESSURE_FE&quot;</span>);</div>
<div class="line"><span class="lineno"> 1851</span>  }</div>
<div class="line"><span class="lineno"> 1852</span>  mField.getInterface&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;buildProblemFromFields = PETSC_TRUE;</div>
<div class="line"><span class="lineno"> 1853</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(commonData.dm);</div>
<div class="line"><span class="lineno"> 1854</span> </div>
<div class="line"><span class="lineno"> 1855</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1856</span>}</div>
<div class="line"><span class="lineno"> 1857</span> </div>
<div class="line"><span class="lineno"> 1858</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::solveDM() {</div>
<div class="line"><span class="lineno"> 1859</span> </div>
<div class="line"><span class="lineno"> 1860</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1861</span> </div>
<div class="line"><span class="lineno"> 1862</span>  <a class="code hl_typedef" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a> = commonData.F;</div>
<div class="line"><span class="lineno"> 1863</span>  <a class="code hl_typedef" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a> = commonData.D;</div>
<div class="line"><span class="lineno"> 1864</span>  Mat <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a> = commonData.A;</div>
<div class="line"><span class="lineno"> 1865</span>  DM dm = commonData.dm;</div>
<div class="line"><span class="lineno"> 1866</span>  TS ts = commonData.ts;</div>
<div class="line"><span class="lineno"> 1867</span> </div>
<div class="line"><span class="lineno"> 1868</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetIFunction(ts, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, PETSC_NULL, PETSC_NULL);</div>
<div class="line"><span class="lineno"> 1869</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetIJacobian(ts, A, A, PETSC_NULL, PETSC_NULL);</div>
<div class="line"><span class="lineno"> 1870</span>  <span class="keywordtype">double</span> ftime = 1;</div>
<div class="line"><span class="lineno"> 1871</span><span class="preprocessor">#if PETSC_VERSION_GE(3, 8, 0)</span></div>
<div class="line"><span class="lineno"> 1872</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetMaxTime(ts, ftime);</div>
<div class="line"><span class="lineno"> 1873</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1874</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(ts);</div>
<div class="line"><span class="lineno"> 1875</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetDM(ts, dm);</div>
<div class="line"><span class="lineno"> 1876</span> </div>
<div class="line"><span class="lineno"> 1877</span>  SNES snes;</div>
<div class="line"><span class="lineno"> 1878</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line"><span class="lineno"> 1879</span>  KSP ksp;</div>
<div class="line"><span class="lineno"> 1880</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetKSP(snes, &amp;ksp);</div>
<div class="line"><span class="lineno"> 1881</span>  PC pc;</div>
<div class="line"><span class="lineno"> 1882</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPGetPC(ksp, &amp;pc);</div>
<div class="line"><span class="lineno"> 1883</span>  PetscBool is_pcfs = PETSC_FALSE;</div>
<div class="line"><span class="lineno"> 1884</span>  PetscObjectTypeCompare((PetscObject)pc, PCFIELDSPLIT, &amp;is_pcfs);</div>
<div class="line"><span class="lineno"> 1885</span> </div>
<div class="line"><span class="lineno"> 1886</span>  <span class="comment">// Set up FIELDSPLIT</span></div>
<div class="line"><span class="lineno"> 1887</span>  <span class="comment">// Only is user set -pc_type fieldsplit</span></div>
<div class="line"><span class="lineno"> 1888</span>  <span class="keywordflow">if</span> (is_pcfs == PETSC_TRUE) {</div>
<div class="line"><span class="lineno"> 1889</span>    IS is_disp, is_rho;</div>
<div class="line"><span class="lineno"> 1890</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structMoFEM_1_1Problem.html">MoFEM::Problem</a> *problem_ptr;</div>
<div class="line"><span class="lineno"> 1891</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga4cafea643e191089b31207ebb16842c9">DMMoFEMGetProblemPtr</a>(dm, &amp;problem_ptr);</div>
<div class="line"><span class="lineno"> 1892</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code hl_struct" href="structMoFEM_1_1ISManager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRank(</div>
<div class="line"><span class="lineno"> 1893</span>        problem_ptr-&gt;<a class="code hl_function" href="structMoFEM_1_1Problem.html#ac27123017bcc40cd4259e674a7318b3c">getName</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, 0, 3, &amp;is_disp);</div>
<div class="line"><span class="lineno"> 1894</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ISManager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRank(</div>
<div class="line"><span class="lineno"> 1895</span>        problem_ptr-&gt;<a class="code hl_function" href="structMoFEM_1_1Problem.html#ac27123017bcc40cd4259e674a7318b3c">getName</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <span class="stringliteral">&quot;RHO&quot;</span>, 0, 1, &amp;is_rho);</div>
<div class="line"><span class="lineno"> 1896</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISSort(is_disp);</div>
<div class="line"><span class="lineno"> 1897</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISSort(is_rho);</div>
<div class="line"><span class="lineno"> 1898</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(pc, NULL, is_disp);</div>
<div class="line"><span class="lineno"> 1899</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(pc, NULL, is_rho);</div>
<div class="line"><span class="lineno"> 1900</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISDestroy(&amp;is_disp);</div>
<div class="line"><span class="lineno"> 1901</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISDestroy(&amp;is_rho);</div>
<div class="line"><span class="lineno"> 1902</span>  }</div>
<div class="line"><span class="lineno"> 1903</span> </div>
<div class="line"><span class="lineno"> 1904</span>  <span class="comment">// Monitor</span></div>
<div class="line"><span class="lineno"> 1905</span>  <a class="code hl_struct" href="structMonitorPostProc.html">MonitorPostProc</a> post_proc(mField, commonData);</div>
<div class="line"><span class="lineno"> 1906</span>  <a class="code hl_struct" href="structMoFEM_1_1TsCtx.html">TsCtx</a> *<a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>;</div>
<div class="line"><span class="lineno"> 1907</span>  <a class="code hl_function" href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">DMMoFEMGetTsCtx</a>(dm, &amp;<a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>);</div>
<div class="line"><span class="lineno"> 1908</span>  {</div>
<div class="line"><span class="lineno"> 1909</span>    <a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1TsCtx.html#ae67dfa33aa6436e66f37d3d40cba565d">getPostProcessMonitor</a>().push_back(&amp;post_proc);</div>
<div class="line"><span class="lineno"> 1910</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSMonitorSet(ts, <a class="code hl_function" href="namespaceMoFEM.html#a1654dd29ff9af437332ec55af104ff48">TsMonitorSet</a>, <a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>, PETSC_NULL);</div>
<div class="line"><span class="lineno"> 1911</span>  }</div>
<div class="line"><span class="lineno"> 1912</span> </div>
<div class="line"><span class="lineno"> 1913</span><span class="preprocessor">#if PETSC_VERSION_GE(3, 7, 0)</span></div>
<div class="line"><span class="lineno"> 1914</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetExactFinalTime(ts, TS_EXACTFINALTIME_STEPOVER);</div>
<div class="line"><span class="lineno"> 1915</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1916</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line"><span class="lineno"> 1917</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTime(ts, &amp;ftime);</div>
<div class="line"><span class="lineno"> 1918</span>  PetscInt steps, snesfails, rejects, nonlinits, linits;</div>
<div class="line"><span class="lineno"> 1919</span><span class="preprocessor">#if PETSC_VERSION_LE(3, 8, 0)</span></div>
<div class="line"><span class="lineno"> 1920</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTimeStepNumber(ts, &amp;steps);</div>
<div class="line"><span class="lineno"> 1921</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1922</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetStepNumber(ts, &amp;steps);</div>
<div class="line"><span class="lineno"> 1923</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1924</span> </div>
<div class="line"><span class="lineno"> 1925</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNESFailures(ts, &amp;snesfails);</div>
<div class="line"><span class="lineno"> 1926</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetStepRejections(ts, &amp;rejects);</div>
<div class="line"><span class="lineno"> 1927</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNESIterations(ts, &amp;nonlinits);</div>
<div class="line"><span class="lineno"> 1928</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetKSPIterations(ts, &amp;linits);</div>
<div class="line"><span class="lineno"> 1929</span>  PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno"> 1930</span>              <span class="stringliteral">&quot;steps %D (%D rejected, %D SNES fails), ftime %g, nonlinits %D, &quot;</span></div>
<div class="line"><span class="lineno"> 1931</span>              <span class="stringliteral">&quot;linits %D\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1932</span>              steps, rejects, snesfails, ftime, nonlinits, linits);</div>
<div class="line"><span class="lineno"> 1933</span> </div>
<div class="line"><span class="lineno"> 1934</span>  <span class="keywordflow">if</span> (commonData.is_atom_testing) {</div>
<div class="line"><span class="lineno"> 1935</span>    <span class="keywordflow">if</span> (commonData.cUrrent_psi &lt; 1.67 || commonData.cUrrent_psi &gt; 1.68)</div>
<div class="line"><span class="lineno"> 1936</span>      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>, <span class="stringliteral">&quot;atom test diverged&quot;</span>);</div>
<div class="line"><span class="lineno"> 1937</span>  }</div>
<div class="line"><span class="lineno"> 1938</span> </div>
<div class="line"><span class="lineno"> 1939</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1940</span>}</div>
<div class="line"><span class="lineno"> 1941</span> </div>
<div class="line"><span class="lineno"> 1942</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> OpMassAndEnergyCalculation::doWork(</div>
<div class="line"><span class="lineno"> 1943</span>    <span class="keywordtype">int</span> row_side, EntityType row_type,</div>
<div class="line"><span class="lineno"> 1944</span>    DataForcesAndSourcesCore::EntData &amp;row_data) {</div>
<div class="line"><span class="lineno"> 1945</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1946</span> </div>
<div class="line"><span class="lineno"> 1947</span>  <span class="keywordflow">if</span> (row_type != MBVERTEX)</div>
<div class="line"><span class="lineno"> 1948</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 1949</span> </div>
<div class="line"><span class="lineno"> 1950</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = row_data.getN().size1();</div>
<div class="line"><span class="lineno"> 1951</span>  <span class="comment">// commonData.data.vecPsi.resize(nb_gauss_pts,false);</span></div>
<div class="line"><span class="lineno"> 1952</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"><span class="lineno"> 1953</span>  <span class="keyword">auto</span> psi = <a class="code hl_function" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line"><span class="lineno"> 1954</span> </div>
<div class="line"><span class="lineno"> 1955</span>  <span class="keywordtype">double</span> energy = 0;</div>
<div class="line"><span class="lineno"> 1956</span>  <span class="keywordtype">double</span> mass = 0;</div>
<div class="line"><span class="lineno"> 1957</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg &lt; nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno"> 1958</span> </div>
<div class="line"><span class="lineno"> 1959</span>    <span class="keywordtype">double</span> vol = getVolume() * getGaussPts()(3, gg);</div>
<div class="line"><span class="lineno"> 1960</span>    energy += vol * psi;</div>
<div class="line"><span class="lineno"> 1961</span>    mass += vol * <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno"> 1962</span> </div>
<div class="line"><span class="lineno"> 1963</span>    ++psi;</div>
<div class="line"><span class="lineno"> 1964</span>    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><span class="lineno"> 1965</span>  }</div>
<div class="line"><span class="lineno"> 1966</span> </div>
<div class="line"><span class="lineno"> 1967</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValue(energVec, 0, energy, ADD_VALUES);</div>
<div class="line"><span class="lineno"> 1968</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValue(massVec, 0, mass, ADD_VALUES);</div>
<div class="line"><span class="lineno"> 1969</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1970</span>}</div>
<div class="line"><span class="lineno"> 1971</span> </div>
<div class="line"><span class="lineno"> 1972</span>} <span class="comment">// namespace BoneRemodeling</span></div>
<div class="ttc" id="aHookeElement_8hpp_html_aee27a2ebc8f3d34a5c1ce71b2607d1a3"><div class="ttname"><a href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a></div><div class="ttdeci">ForcesAndSourcesCore::UserDataOperator UserDataOperator</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00075">HookeElement.hpp:75</a></div></div>
<div class="ttc" id="aRemodeling_8cpp_html_a0a80843c43c1fe98a79754f2051a2001"><div class="ttname"><a href="Remodeling_8cpp.html#a0a80843c43c1fe98a79754f2051a2001">SYMMETRIC_TENSOR2_VEC_PTR</a></div><div class="ttdeci">#define SYMMETRIC_TENSOR2_VEC_PTR(VEC)</div><div class="ttdef"><b>Definition</b> <a href="Remodeling_8cpp_source.html#l00057">Remodeling.cpp:57</a></div></div>
<div class="ttc" id="aRemodeling_8cpp_html_a4f20638920306c93091822d641af4749"><div class="ttname"><a href="Remodeling_8cpp.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a></div><div class="ttdeci">#define SYMMETRIC_TENSOR2_MAT_PTR(MAT)</div><div class="ttdef"><b>Definition</b> <a href="Remodeling_8cpp_source.html#l00054">Remodeling.cpp:54</a></div></div>
<div class="ttc" id="aRemodeling_8cpp_html_a582835fd072f2ee1a3370455cf2b57cc"><div class="ttname"><a href="Remodeling_8cpp.html#a582835fd072f2ee1a3370455cf2b57cc">TENSOR2_MAT_PTR</a></div><div class="ttdeci">#define TENSOR2_MAT_PTR(MAT)</div><div class="ttdef"><b>Definition</b> <a href="Remodeling_8cpp_source.html#l00050">Remodeling.cpp:50</a></div></div>
<div class="ttc" id="aRemodeling_8cpp_html_a882b61442aebc50fe467fe15a09ee85c"><div class="ttname"><a href="Remodeling_8cpp.html#a882b61442aebc50fe467fe15a09ee85c">SYMMETRIC_TENSOR4_MAT_PTR</a></div><div class="ttdeci">#define SYMMETRIC_TENSOR4_MAT_PTR(MAT)</div><div class="ttdef"><b>Definition</b> <a href="Remodeling_8cpp_source.html#l00040">Remodeling.cpp:40</a></div></div>
<div class="ttc" id="aRemodeling_8cpp_html_aff752f795f2d1fdbee680e2e1630d50c"><div class="ttname"><a href="Remodeling_8cpp.html#aff752f795f2d1fdbee680e2e1630d50c">TENSOR4_MAT_PTR</a></div><div class="ttdeci">#define TENSOR4_MAT_PTR(MAT)</div><div class="ttdef"><b>Definition</b> <a href="Remodeling_8cpp_source.html#l00048">Remodeling.cpp:48</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="aclassEntityHandle_html"><div class="ttname"><a href="classEntityHandle.html">EntityHandle</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Ddg_html"><div class="ttname"><a href="classFTensor_1_1Ddg.html">FTensor::Ddg</a></div><div class="ttdef"><b>Definition</b> <a href="Ddg__value_8hpp_source.html#l00007">Ddg_value.hpp:8</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition</b> <a href="Index_8hpp_source.html#l00023">Index.hpp:24</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2__symmetric_html"><div class="ttname"><a href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor2__symmetric__value_8hpp_source.html#l00013">Tensor2_symmetric_value.hpp:14</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2_html"><div class="ttname"><a href="classFTensor_1_1Tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:17</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor4_html"><div class="ttname"><a href="classFTensor_1_1Tensor4.html">FTensor::Tensor4</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor4__value_8hpp_source.html#l00018">Tensor4_value.hpp:19</a></div></div>
<div class="ttc" id="aclassMatrixBoundedArray_3_01double_00_019_01_4_html"><div class="ttname"><a href="classMatrixBoundedArray_3_01double_00_019_01_4.html">MatrixBoundedArray&lt; double, 9 &gt;</a></div></div>
<div class="ttc" id="aclassUBlasMatrix_3_01double_01_4_html"><div class="ttname"><a href="classUBlasMatrix_3_01double_01_4.html">UBlasMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a></div><div class="ttdeci">@ ROW</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00111">definitions.h:111</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00061">definitions.h:60</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a4f20638920306c93091822d641af4749"><div class="ttname"><a href="definitions_8h.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a></div><div class="ttdeci">#define SYMMETRIC_TENSOR2_MAT_PTR(MAT)</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00640">definitions.h:640</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a582835fd072f2ee1a3370455cf2b57cc"><div class="ttname"><a href="definitions_8h.html#a582835fd072f2ee1a3370455cf2b57cc">TENSOR2_MAT_PTR</a></div><div class="ttdeci">#define TENSOR2_MAT_PTR(MAT)</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00636">definitions.h:636</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00463">definitions.h:463</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec">MOFEM_STD_EXCEPTION_THROW</a></div><div class="ttdeci">@ MOFEM_STD_EXCEPTION_THROW</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00039">definitions.h:39</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a></div><div class="ttdeci">@ MOFEM_OPERATION_UNSUCCESSFUL</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00034">definitions.h:34</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a></div><div class="ttdeci">@ MOFEM_ATOM_TEST_INVALID</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00040">definitions.h:40</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00432">definitions.h:432</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00551">definitions.h:551</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00456">definitions.h:456</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="adynamic__first__order__con__law_8cpp_html_a74577585cf12d1712ab9c57616d49205"><div class="ttname"><a href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a></div><div class="ttdeci">double mu</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00097">dynamic_first_order_con_law.cpp:97</a></div></div>
<div class="ttc" id="afem__tools_8h_html_a0cf798297f89cab062647ff3ac11632d"><div class="ttname"><a href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a></div><div class="ttdeci">#define MU(E, NU)</div><div class="ttdef"><b>Definition</b> <a href="fem__tools_8h_source.html#l00023">fem_tools.h:23</a></div></div>
<div class="ttc" id="afem__tools_8h_html_ae1ddae80f6ff785f38a0c3bfb9259932"><div class="ttname"><a href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a></div><div class="ttdeci">#define LAMBDA(E, NU)</div><div class="ttdef"><b>Definition</b> <a href="fem__tools_8h_source.html#l00022">fem_tools.h:22</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00396">free_surface.cpp:396</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00396">free_surface.cpp:396</a></div></div>
<div class="ttc" id="agroup__dm_html_ga15496670ac6293eb1ae412714c6649db"><div class="ttname"><a href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">MoFEM::DMMoFEMSetIsPartitioned</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetIsPartitioned(DM dm, PetscBool is_partitioned)</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l01113">DMMoFEM.cpp:1113</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00488">DMMoFEM.cpp:488</a></div></div>
<div class="ttc" id="agroup__dm_html_ga32f14a8ae536697a4a0356900ecb73fd"><div class="ttname"><a href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">MoFEM::DMMoFEMCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateMoFEM(DM dm, MoFEM::Interface *m_field_ptr, const char problem_name[], const MoFEM::BitRefLevel bit_level, const MoFEM::BitRefLevel bit_mask=MoFEM::BitRefLevel().set())</div><div class="ttdoc">Must be called by user to set MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00114">DMMoFEM.cpp:114</a></div></div>
<div class="ttc" id="agroup__dm_html_ga4cafea643e191089b31207ebb16842c9"><div class="ttname"><a href="group__dm.html#ga4cafea643e191089b31207ebb16842c9">MoFEM::DMMoFEMGetProblemPtr</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetProblemPtr(DM dm, const MoFEM::Problem **problem_ptr)</div><div class="ttdoc">Get pointer to problem data structure.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00422">DMMoFEM.cpp:422</a></div></div>
<div class="ttc" id="agroup__dm_html_ga81d1702e6a5cbe505aa79e94c4aa9d74"><div class="ttname"><a href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">MoFEM::DMMoFEMGetTsCtx</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetTsCtx(DM dm, MoFEM::TsCtx **ts_ctx)</div><div class="ttdoc">get MoFEM::TsCtx data structure</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l01132">DMMoFEM.cpp:1132</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00576">DMMoFEM.cpp:576</a></div></div>
<div class="ttc" id="agroup__mofem__fs__post__proc_html_ga76917498a614262ab7daf1268f1ec429"><div class="ttname"><a href="group__mofem__fs__post__proc.html#ga76917498a614262ab7daf1268f1ec429">PostProcTemplateOnRefineMesh::addFieldValuesPostProc</a></div><div class="ttdeci">MoFEMErrorCode addFieldValuesPostProc(const std::string field_name, Vec v=PETSC_NULLPTR)</div><div class="ttdoc">Add operator to post-process L2, H1, Hdiv, Hcurl field value.</div><div class="ttdef"><b>Definition</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00153">PostProcOnRefMesh.hpp:153</a></div></div>
<div class="ttc" id="agroup__mofem__fs__post__proc_html_gac17087ffb048f5fba8ddeb6b49f5abac"><div class="ttname"><a href="group__mofem__fs__post__proc.html#gac17087ffb048f5fba8ddeb6b49f5abac">PostProcTemplateOnRefineMesh::addFieldValuesGradientPostProc</a></div><div class="ttdeci">MoFEMErrorCode addFieldValuesGradientPostProc(const std::string field_name, Vec v=PETSC_NULLPTR)</div><div class="ttdoc">Add operator to post-process L2 or H1 field gradient.</div><div class="ttdef"><b>Definition</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00195">PostProcOnRefMesh.hpp:195</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaff36ed0367e6b0a57541419546aa1323"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet having a particular BC meshset in a moFEM field.</div><div class="ttdef"><b>Definition</b> <a href="MeshsetsManager_8hpp_source.html#l00071">MeshsetsManager.hpp:71</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="aincompressible__elasticity_8cpp_html_a3db359547eed8cfd48ca821d95f577af"><div class="ttname"><a href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a></div><div class="ttdeci">static double lambda</div><div class="ttdef"><b>Definition</b> <a href="incompressible__elasticity_8cpp_source.html#l00181">incompressible_elasticity.cpp:181</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_ad8657a5ec76e12f3066fb4b4eb75ace9"><div class="ttname"><a href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a></div><div class="ttdeci">double D</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00044">initial_diffusion.cpp:44</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_afd53743d1af6bfa2856255b23b5a41a9"><div class="ttname"><a href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a></div><div class="ttdeci">const double n</div><div class="ttdoc">refractive index of diffusive medium</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00038">initial_diffusion.cpp:38</a></div></div>
<div class="ttc" id="alapack__wrap_8h_html_a9d34be2f8a6a32580830207f2b827529"><div class="ttname"><a href="lapack__wrap_8h.html#a9d34be2f8a6a32580830207f2b827529">lapack_dsyev</a></div><div class="ttdeci">static __CLPK_integer lapack_dsyev(char jobz, char uplo, __CLPK_integer n, __CLPK_doublereal *a, __CLPK_integer lda, __CLPK_doublereal *w, __CLPK_doublereal *work, __CLPK_integer lwork)</div><div class="ttdef"><b>Definition</b> <a href="lapack__wrap_8h_source.html#l00261">lapack_wrap.h:261</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_a771a8d2443d7bec47aef196b5d23ade2"><div class="ttname"><a href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a></div><div class="ttdeci">FTensor::Index&lt; 'J', DIM1 &gt; J</div><div class="ttdef"><b>Definition</b> <a href="level__set_8cpp_source.html#l00030">level_set.cpp:30</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_ae194ec50b15d7b114a4e5e5a4cb8e218"><div class="ttname"><a href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a></div><div class="ttdeci">MoFEM::TsCtx * ts_ctx</div><div class="ttdef"><b>Definition</b> <a href="level__set_8cpp_source.html#l01932">level_set.cpp:1932</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="anamespaceEigenMatrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition</b> <a href="MatrixFunction_8hpp_source.html#l00064">MatrixFunction.hpp:64</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">EshelbianPlasticity::P</a></div><div class="ttdeci">@ P</div><div class="ttdef"><b>Definition</b> <a href="EshelbianContact_8cpp_source.html#l00201">EshelbianContact.cpp:201</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a2a1a0695ea7feb3a1e73a8707ef9f083"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">MoFEM::Types::VectorDouble3</a></div><div class="ttdeci">VectorBoundedArray&lt; double, 3 &gt; VectorDouble3</div><div class="ttdef"><b>Definition</b> <a href="Types_8hpp_source.html#l00092">Types.hpp:92</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a0689d2a630ba3cee683b02982b467c77"><div class="ttname"><a href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">MoFEM::K</a></div><div class="ttdeci">VectorDouble K</div><div class="ttdef"><b>Definition</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00125">Projection10NodeCoordsOnField.cpp:125</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a123875fb03925a9640697591e972412c"><div class="ttname"><a href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">MoFEM::L</a></div><div class="ttdeci">VectorDouble L</div><div class="ttdef"><b>Definition</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00124">Projection10NodeCoordsOnField.cpp:124</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a1654dd29ff9af437332ec55af104ff48"><div class="ttname"><a href="namespaceMoFEM.html#a1654dd29ff9af437332ec55af104ff48">MoFEM::TsMonitorSet</a></div><div class="ttdeci">PetscErrorCode TsMonitorSet(TS ts, PetscInt step, PetscReal t, Vec u, void *ctx)</div><div class="ttdoc">Set monitor for TS solver.</div><div class="ttdef"><b>Definition</b> <a href="TsCtx_8cpp_source.html#l00263">TsCtx.cpp:263</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a7064ec9e939c81c212cc726272c0e088"><div class="ttname"><a href="namespaceMoFEM.html#a7064ec9e939c81c212cc726272c0e088">MoFEM::invertTensor3by3</a></div><div class="ttdeci">MoFEMErrorCode invertTensor3by3(ublas::matrix&lt; T, L, A &gt; &amp;jac_data, ublas::vector&lt; T, A &gt; &amp;det_data, ublas::matrix&lt; T, L, A &gt; &amp;inv_jac_data)</div><div class="ttdoc">Calculate inverse of tensor rank 2 at integration points.</div><div class="ttdef"><b>Definition</b> <a href="Templates_8hpp_source.html#l01588">Templates.hpp:1588</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l01644">EntitiesFieldData.hpp:1644</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aa464ad90a188180427136b22e078ec7d"><div class="ttname"><a href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">MoFEM::getFTensor0FromVec</a></div><div class="ttdeci">static auto getFTensor0FromVec(ublas::vector&lt; T, A &gt; &amp;data)</div><div class="ttdoc">Get tensor rank 0 (scalar) form data vector.</div><div class="ttdef"><b>Definition</b> <a href="Templates_8hpp_source.html#l00135">Templates.hpp:135</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ae3a0416ae2eb4b327e43ef2dfc21a15a"><div class="ttname"><a href="namespaceMoFEM.html#ae3a0416ae2eb4b327e43ef2dfc21a15a">MoFEM::determinantTensor3by3</a></div><div class="ttdeci">static auto determinantTensor3by3(T &amp;t)</div><div class="ttdoc">Calculate the determinant of a 3x3 matrix or a tensor of rank 2.</div><div class="ttdef"><b>Definition</b> <a href="Templates_8hpp_source.html#l01540">Templates.hpp:1540</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aef01d33cbe1d8ed916ce789bd25c4495"><div class="ttname"><a href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">MoFEM::VecSetValues</a></div><div class="ttdeci">MoFEMErrorCode VecSetValues(Vec V, const EntitiesFieldData::EntData &amp;data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc vector.</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l01589">EntitiesFieldData.hpp:1589</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_af01ee5c3bc1505a09c369d8d455bba1e"><div class="ttname"><a href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">MoFEM::addHOOpsVol</a></div><div class="ttdeci">MoFEMErrorCode addHOOpsVol(const std::string field, E &amp;e, bool h1, bool hcurl, bool hdiv, bool l2)</div><div class="ttdef"><b>Definition</b> <a href="HODataOperators_8hpp_source.html#l00678">HODataOperators.hpp:678</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a4db4d50b047acc94e54fdf4df9f3077c"><div class="ttname"><a href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">convert.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="anamespacesdf__wavy__2d_html_ab736ce7138c0ba29f61877ebea4f2bc6"><div class="ttname"><a href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">sdf_wavy_2d.w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition</b> <a href="sdf__wavy__2d_8py_source.html#l00006">sdf_wavy_2d.py:6</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_a99b759dd71581f497626034776727d3d"><div class="ttname"><a href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a></div><div class="ttdeci">constexpr IntegrationType I</div><div class="ttdef"><b>Definition</b> <a href="operators__tests_8cpp_source.html#l00031">operators_tests.cpp:31</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a0447f1370e525557f8d7c6a1ed22be14"><div class="ttname"><a href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a></div><div class="ttdeci">double young_modulus</div><div class="ttdoc">Young modulus.</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00125">plastic.cpp:125</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a3ed57096651b587c2bf716fa78048153"><div class="ttname"><a href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a></div><div class="ttdeci">double rho</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00144">plastic.cpp:144</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a571fc4d0022947a6d01a56a53d5668e6"><div class="ttname"><a href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a></div><div class="ttdeci">double poisson_ratio</div><div class="ttdoc">Poisson ratio.</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00126">plastic.cpp:126</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astructDataAtIntegrationPts_html_a16743a784469bd2c5de896d50aba85b3"><div class="ttname"><a href="structDataAtIntegrationPts.html#a16743a784469bd2c5de896d50aba85b3">DataAtIntegrationPts::gradDispPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; MatrixDouble &gt; gradDispPtr</div><div class="ttdef"><b>Definition</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00022">ElasticityMixedFormulation.hpp:22</a></div></div>
<div class="ttc" id="astructElasticMaterials_html"><div class="ttname"><a href="structElasticMaterials.html">ElasticMaterials</a></div><div class="ttdoc">Manage setting parameters and constitutive equations for nonlinear/linear elastic materials.</div><div class="ttdef"><b>Definition</b> <a href="ElasticMaterials_8hpp_source.html#l00024">ElasticMaterials.hpp:24</a></div></div>
<div class="ttc" id="astructMetaEdgeForces_html_a46625c9571b0469a5c4a7aa1c8f6c272"><div class="ttname"><a href="structMetaEdgeForces.html#a46625c9571b0469a5c4a7aa1c8f6c272">MetaEdgeForces::setOperators</a></div><div class="ttdeci">static MoFEMErrorCode setOperators(MoFEM::Interface &amp;m_field, boost::ptr_map&lt; std::string, EdgeForce &gt; &amp;edge_forces, Vec F, const std::string field_name, std::string mesh_node_positions=&quot;MESH_NODE_POSITIONS&quot;)</div><div class="ttdoc">Set integration point operators.</div><div class="ttdef"><b>Definition</b> <a href="EdgeForce_8hpp_source.html#l00097">EdgeForce.hpp:97</a></div></div>
<div class="ttc" id="astructMetaEdgeForces_html_ad4ba172a5f79e0c41430c6dcecdd95f8"><div class="ttname"><a href="structMetaEdgeForces.html#ad4ba172a5f79e0c41430c6dcecdd95f8">MetaEdgeForces::addElement</a></div><div class="ttdeci">static MoFEMErrorCode addElement(MoFEM::Interface &amp;m_field, const std::string field_name, Range *intersect_ptr=NULL)</div><div class="ttdoc">Add element taking information from NODESET.</div><div class="ttdef"><b>Definition</b> <a href="EdgeForce_8hpp_source.html#l00062">EdgeForce.hpp:62</a></div></div>
<div class="ttc" id="astructMetaNodalForces_html_a84ba4b4c66e9df18c139cb81808cadc2"><div class="ttname"><a href="structMetaNodalForces.html#a84ba4b4c66e9df18c139cb81808cadc2">MetaNodalForces::setOperators</a></div><div class="ttdeci">static MoFEMErrorCode setOperators(MoFEM::Interface &amp;m_field, boost::ptr_map&lt; std::string, NodalForce &gt; &amp;nodal_forces, Vec F, const std::string field_name)</div><div class="ttdoc">Set integration point operators.</div><div class="ttdef"><b>Definition</b> <a href="NodalForce_8hpp_source.html#l00128">NodalForce.hpp:128</a></div></div>
<div class="ttc" id="astructMetaNodalForces_html_a8e0b96853208e8320b7268f96f4fd8ee"><div class="ttname"><a href="structMetaNodalForces.html#a8e0b96853208e8320b7268f96f4fd8ee">MetaNodalForces::addElement</a></div><div class="ttdeci">static MoFEMErrorCode addElement(MoFEM::Interface &amp;m_field, const std::string field_name, Range *intersect_ptr=NULL)</div><div class="ttdoc">Add element taking information from NODESET.</div><div class="ttdef"><b>Definition</b> <a href="NodalForce_8hpp_source.html#l00092">NodalForce.hpp:92</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html">MoFEM::BitRefManager</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition</b> <a href="BitRefManager_8hpp_source.html#l00021">BitRefManager.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FieldBlas_html"><div class="ttname"><a href="structMoFEM_1_1FieldBlas.html">MoFEM::FieldBlas</a></div><div class="ttdoc">Basic algebra on fields.</div><div class="ttdef"><b>Definition</b> <a href="FieldBlas_8hpp_source.html#l00021">FieldBlas.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ISManager_html"><div class="ttname"><a href="structMoFEM_1_1ISManager.html">MoFEM::ISManager</a></div><div class="ttdoc">Section manager is used to create indexes and sections.</div><div class="ttdef"><b>Definition</b> <a href="ISManager_8hpp_source.html#l00023">ISManager.hpp:23</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">MoFEM::OpCalculateScalarFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar field rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l01319">UserDataOperators.hpp:1321</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldValues.html">MoFEM::OpCalculateScalarFieldValues</a></div><div class="ttdoc">Get value at integration points for scalar field.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l00082">UserDataOperators.hpp:83</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">MoFEM::OpCalculateVectorFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar field rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l01561">UserDataOperators.hpp:1563</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Problem_html"><div class="ttname"><a href="structMoFEM_1_1Problem.html">MoFEM::Problem</a></div><div class="ttdoc">keeps basic data about problem</div><div class="ttdef"><b>Definition</b> <a href="ProblemsMultiIndices_8hpp_source.html#l00054">ProblemsMultiIndices.hpp:54</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Problem_html_ac27123017bcc40cd4259e674a7318b3c"><div class="ttname"><a href="structMoFEM_1_1Problem.html#ac27123017bcc40cd4259e674a7318b3c">MoFEM::Problem::getName</a></div><div class="ttdeci">auto getName() const</div><div class="ttdef"><b>Definition</b> <a href="ProblemsMultiIndices_8hpp_source.html#l00372">ProblemsMultiIndices.hpp:372</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ProblemsManager_html"><div class="ttname"><a href="structMoFEM_1_1ProblemsManager.html">MoFEM::ProblemsManager</a></div><div class="ttdoc">Problem manager is used to build and partition problems.</div><div class="ttdef"><b>Definition</b> <a href="ProblemsManager_8hpp_source.html#l00021">ProblemsManager.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Projection10NodeCoordsOnField_html"><div class="ttname"><a href="structMoFEM_1_1Projection10NodeCoordsOnField.html">MoFEM::Projection10NodeCoordsOnField</a></div><div class="ttdoc">Projection of edge entities with one mid-node on hierarchical basis.</div><div class="ttdef"><b>Definition</b> <a href="Projection10NodeCoordsOnField_8hpp_source.html#l00024">Projection10NodeCoordsOnField.hpp:24</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TSMethod_html_a03384a9578841560b71d2705a580c576"><div class="ttname"><a href="structMoFEM_1_1TSMethod.html#a03384a9578841560b71d2705a580c576">MoFEM::TSMethod::ts</a></div><div class="ttdeci">TS ts</div><div class="ttdoc">time solver</div><div class="ttdef"><b>Definition</b> <a href="LoopMethods_8hpp_source.html#l00159">LoopMethods.hpp:159</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TSMethod_html_a5eb15bd118b06018110428672a4821c7"><div class="ttname"><a href="structMoFEM_1_1TSMethod.html#a5eb15bd118b06018110428672a4821c7">MoFEM::TSMethod::ts_t</a></div><div class="ttdeci">PetscReal ts_t</div><div class="ttdoc">time</div><div class="ttdef"><b>Definition</b> <a href="LoopMethods_8hpp_source.html#l00166">LoopMethods.hpp:166</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html">MoFEM::TsCtx</a></div><div class="ttdoc">Interface for Time Stepping (TS) solver.</div><div class="ttdef"><b>Definition</b> <a href="TsCtx_8hpp_source.html#l00017">TsCtx.hpp:17</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_ae67dfa33aa6436e66f37d3d40cba565d"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#ae67dfa33aa6436e66f37d3d40cba565d">MoFEM::TsCtx::getPostProcessMonitor</a></div><div class="ttdeci">BasicMethodsSequence &amp; getPostProcessMonitor()</div><div class="ttdoc">Get the postProcess to do Monitor object.</div><div class="ttdef"><b>Definition</b> <a href="TsCtx_8hpp_source.html#l00148">TsCtx.hpp:148</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">MoFEM::VolumeElementForcesAndSourcesCore</a></div><div class="ttdoc">Volume finite element base.</div><div class="ttdef"><b>Definition</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00026">VolumeElementForcesAndSourcesCore.hpp:26</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html"><div class="ttname"><a href="structMonitorPostProc.html">MonitorPostProc</a></div><div class="ttdef"><b>Definition</b> <a href="nonlinear__dynamics_8cpp_source.html#l00030">nonlinear_dynamics.cpp:30</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_a5f9f4333af411bf4de37445782aca1b5"><div class="ttname"><a href="structMonitorPostProc.html#a5f9f4333af411bf4de37445782aca1b5">MonitorPostProc::postProcess</a></div><div class="ttdeci">MoFEMErrorCode postProcess()</div><div class="ttdoc">function is run at the end of loop</div><div class="ttdef"><b>Definition</b> <a href="nonlinear__dynamics_8cpp_source.html#l00133">nonlinear_dynamics.cpp:133</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_a695bc88c72bd41eeac7ef7f6d628d014"><div class="ttname"><a href="structMonitorPostProc.html#a695bc88c72bd41eeac7ef7f6d628d014">MonitorPostProc::operator()</a></div><div class="ttdeci">MoFEMErrorCode operator()()</div><div class="ttdoc">function is run for every finite element</div><div class="ttdef"><b>Definition</b> <a href="nonlinear__dynamics_8cpp_source.html#l00128">nonlinear_dynamics.cpp:128</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_a6d18eec583bf6954ef3789baf7f6b8c8"><div class="ttname"><a href="structMonitorPostProc.html#a6d18eec583bf6954ef3789baf7f6b8c8">MonitorPostProc::preProcess</a></div><div class="ttdeci">MoFEMErrorCode preProcess()</div><div class="ttdoc">function is run at the beginning of loop</div><div class="ttdef"><b>Definition</b> <a href="nonlinear__dynamics_8cpp_source.html#l00080">nonlinear_dynamics.cpp:80</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_a764cb41bba89ad9af982942b3fb22f05"><div class="ttname"><a href="structMonitorPostProc.html#a764cb41bba89ad9af982942b3fb22f05">MonitorPostProc::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="nonlinear__dynamics_8cpp_source.html#l00032">nonlinear_dynamics.cpp:32</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_ab823a333f47588008ba4ccb98441106c"><div class="ttname"><a href="structMonitorPostProc.html#ab823a333f47588008ba4ccb98441106c">MonitorPostProc::iNit</a></div><div class="ttdeci">bool iNit</div><div class="ttdef"><b>Definition</b> <a href="nonlinear__dynamics_8cpp_source.html#l00040">nonlinear_dynamics.cpp:40</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_ab9257e533617f512bdba17f408d5b2ba"><div class="ttname"><a href="structMonitorPostProc.html#ab9257e533617f512bdba17f408d5b2ba">MonitorPostProc::pRT</a></div><div class="ttdeci">int pRT</div><div class="ttdef"><b>Definition</b> <a href="nonlinear__dynamics_8cpp_source.html#l00042">nonlinear_dynamics.cpp:42</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_ad6f70f52c3f4c77276fc985a3f7a2795"><div class="ttname"><a href="structMonitorPostProc.html#ad6f70f52c3f4c77276fc985a3f7a2795">MonitorPostProc::MonitorPostProc</a></div><div class="ttdeci">MonitorPostProc(MoFEM::Interface &amp;m_field, std::map&lt; int, NonlinearElasticElement::BlockData &gt; &amp;set_of_blocks, NonlinearElasticElement::MyVolumeFE &amp;fe_elastic_energy, ConvectiveMassElement::MyVolumeFE &amp;fe_kinetic_energy)</div><div class="ttdef"><b>Definition</b> <a href="nonlinear__dynamics_8cpp_source.html#l00045">nonlinear_dynamics.cpp:45</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_ae063fb76c9dad0a18017229360462ced"><div class="ttname"><a href="structMonitorPostProc.html#ae063fb76c9dad0a18017229360462ced">MonitorPostProc::postProc</a></div><div class="ttdeci">PostProcVolumeOnRefinedMesh postProc</div><div class="ttdef"><b>Definition</b> <a href="nonlinear__dynamics_8cpp_source.html#l00033">nonlinear_dynamics.cpp:33</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_ae86e41d15e5ba9e00959d87a0c10c97f"><div class="ttname"><a href="structMonitorPostProc.html#ae86e41d15e5ba9e00959d87a0c10c97f">MonitorPostProc::step</a></div><div class="ttdeci">int * step</div><div class="ttdef"><b>Definition</b> <a href="nonlinear__dynamics_8cpp_source.html#l00043">nonlinear_dynamics.cpp:43</a></div></div>
<div class="ttc" id="astructNonlinearElasticElement_html"><div class="ttname"><a href="structNonlinearElasticElement.html">NonlinearElasticElement</a></div><div class="ttdoc">structure grouping operators and data used for calculation of nonlinear elastic element</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00027">HookeElement.hpp:27</a></div></div>
<div class="ttc" id="astructOpCalculateStress_html"><div class="ttname"><a href="structOpCalculateStress.html">OpCalculateStress</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00153">HookeElement.hpp:153</a></div></div>
<div class="ttc" id="astructOpCalculateStress_html_a9bc89d8801014833b9aebda666bac8ed"><div class="ttname"><a href="structOpCalculateStress.html#a9bc89d8801014833b9aebda666bac8ed">OpCalculateStress::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, EntityType row_type, EntData &amp;row_data)</div><div class="ttdoc">Operator for linear form, usually to calculate values on right hand side.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00893">HookeElement.hpp:893</a></div></div>
<div class="ttc" id="astructOpCalculateStress_html_aa8fb336855ab8b3de4fa7c8d739a0728"><div class="ttname"><a href="structOpCalculateStress.html#aa8fb336855ab8b3de4fa7c8d739a0728">OpCalculateStress::OpCalculateStress</a></div><div class="ttdeci">OpCalculateStress(const std::string row_field, const std::string col_field, boost::shared_ptr&lt; DataAtIntegrationPts &gt; data_at_pts)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00884">HookeElement.hpp:884</a></div></div>
<div class="ttc" id="astructOpPostProcStress_html"><div class="ttname"><a href="structOpPostProcStress.html">OpPostProcStress</a></div><div class="ttdef"><b>Definition</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00428">ElasticityMixedFormulation.hpp:429</a></div></div>
<div class="ttc" id="astructOpPostProcStress_html_a08736bb1b763f4acc93d9ade5cf6c307"><div class="ttname"><a href="structOpPostProcStress.html#a08736bb1b763f4acc93d9ade5cf6c307">OpPostProcStress::mapGaussPts</a></div><div class="ttdeci">std::vector&lt; EntityHandle &gt; &amp; mapGaussPts</div><div class="ttdef"><b>Definition</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00432">ElasticityMixedFormulation.hpp:432</a></div></div>
<div class="ttc" id="astructOpPostProcStress_html_a0f791f1e62ed3fc3a7a72dc3946490fc"><div class="ttname"><a href="structOpPostProcStress.html#a0f791f1e62ed3fc3a7a72dc3946490fc">OpPostProcStress::OpPostProcStress</a></div><div class="ttdeci">OpPostProcStress(moab::Interface &amp;post_proc_mesh, std::vector&lt; EntityHandle &gt; &amp;map_gauss_pts, DataAtIntegrationPts &amp;common_data, BlockData &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00435">ElasticityMixedFormulation.hpp:435</a></div></div>
<div class="ttc" id="astructOpPostProcStress_html_a6ac9440f4ce87fbed4e71d4ed780a7e9"><div class="ttname"><a href="structOpPostProcStress.html#a6ac9440f4ce87fbed4e71d4ed780a7e9">OpPostProcStress::commonData</a></div><div class="ttdeci">DataAtIntegrationPts &amp; commonData</div><div class="ttdef"><b>Definition</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00430">ElasticityMixedFormulation.hpp:430</a></div></div>
<div class="ttc" id="astructOpPostProcStress_html_ab21ea999109f1ea2f66b7d57c7bedcfe"><div class="ttname"><a href="structOpPostProcStress.html#ab21ea999109f1ea2f66b7d57c7bedcfe">OpPostProcStress::postProcMesh</a></div><div class="ttdeci">moab::Interface &amp; postProcMesh</div><div class="ttdef"><b>Definition</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00431">ElasticityMixedFormulation.hpp:431</a></div></div>
<div class="ttc" id="astructOpPostProcStress_html_adc555582171e7be6434277c8808a3395"><div class="ttname"><a href="structOpPostProcStress.html#adc555582171e7be6434277c8808a3395">OpPostProcStress::doWork</a></div><div class="ttdeci">PetscErrorCode doWork(int side, EntityType type, EntitiesFieldData::EntData &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00450">ElasticityMixedFormulation.hpp:450</a></div></div>
<div class="ttc" id="astructPostProcStress_html"><div class="ttname"><a href="structPostProcStress.html">PostProcStress</a></div><div class="ttdef"><b>Definition</b> <a href="PostProcStresses_8hpp_source.html#l00017">PostProcStresses.hpp:18</a></div></div>
<div class="ttc" id="astructPostProcTemplateOnRefineMesh_html_a47d46ec67f3f7c3e82a846f3f3887830"><div class="ttname"><a href="structPostProcTemplateOnRefineMesh.html#a47d46ec67f3f7c3e82a846f3f3887830">PostProcTemplateOnRefineMesh::mapGaussPts</a></div><div class="ttdeci">std::vector&lt; EntityHandle &gt; mapGaussPts</div><div class="ttdef"><b>Definition</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00125">PostProcOnRefMesh.hpp:125</a></div></div>
<div class="ttc" id="astructPostProcTemplateOnRefineMesh_html_acd29730f88cf549ab0e5deb0b76476ee"><div class="ttname"><a href="structPostProcTemplateOnRefineMesh.html#acd29730f88cf549ab0e5deb0b76476ee">PostProcTemplateOnRefineMesh::postProcMesh</a></div><div class="ttdeci">moab::Interface &amp; postProcMesh</div><div class="ttdef"><b>Definition</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00122">PostProcOnRefMesh.hpp:122</a></div></div>
<div class="ttc" id="astructPostProcTemplateVolumeOnRefinedMesh_html_a093f5ac63678cfad18c87cd36c6962be"><div class="ttname"><a href="structPostProcTemplateVolumeOnRefinedMesh.html#a093f5ac63678cfad18c87cd36c6962be">PostProcTemplateVolumeOnRefinedMesh::generateReferenceElementMesh</a></div><div class="ttdeci">MoFEMErrorCode generateReferenceElementMesh()</div><div class="ttdoc">Generate reference mesh on single element.</div><div class="ttdef"><b>Definition</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00301">PostProcOnRefMesh.hpp:301</a></div></div>
<div class="ttc" id="astructTimeForceScale_html"><div class="ttname"><a href="structTimeForceScale.html">TimeForceScale</a></div><div class="ttdoc">Force scale operator for reading two columns.</div><div class="ttdef"><b>Definition</b> <a href="tutorials_2src_2TimeForceScale_8hpp_source.html#l00018">TimeForceScale.hpp:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a80843c43c1fe98a79754f2051a2001" name="a0a80843c43c1fe98a79754f2051a2001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a80843c43c1fe98a79754f2051a2001">&#9670;&#160;</a></span>SYMMETRIC_TENSOR2_VEC_PTR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SYMMETRIC_TENSOR2_VEC_PTR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">VEC</td><td>)</td>
          <td>&#160;&#160;&#160;  &amp;VEC[0], &amp;VEC[1], &amp;VEC[2], &amp;VEC[3], &amp;VEC[4], &amp;VEC[5]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Remodeling_8cpp_source.html#l00057">57</a> of file <a class="el" href="Remodeling_8cpp_source.html">Remodeling.cpp</a>.</p>

</div>
</div>
<a id="a882b61442aebc50fe467fe15a09ee85c" name="a882b61442aebc50fe467fe15a09ee85c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a882b61442aebc50fe467fe15a09ee85c">&#9670;&#160;</a></span>SYMMETRIC_TENSOR4_MAT_PTR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SYMMETRIC_TENSOR4_MAT_PTR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">MAT</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  &amp;MAT(0, 0), &amp;MAT(0, 1), &amp;MAT(0, 2), &amp;MAT(0, 3), &amp;MAT(0, 4), &amp;MAT(0, 5),      \</div>
<div class="line">      &amp;MAT(1, 0), &amp;MAT(1, 1), &amp;MAT(1, 2), &amp;MAT(1, 3), &amp;MAT(1, 4), &amp;MAT(1, 5),  \</div>
<div class="line">      &amp;MAT(2, 0), &amp;MAT(2, 1), &amp;MAT(2, 2), &amp;MAT(2, 3), &amp;MAT(2, 4), &amp;MAT(2, 5),  \</div>
<div class="line">      &amp;MAT(3, 0), &amp;MAT(3, 1), &amp;MAT(3, 2), &amp;MAT(3, 3), &amp;MAT(3, 4), &amp;MAT(3, 5),  \</div>
<div class="line">      &amp;MAT(4, 0), &amp;MAT(4, 1), &amp;MAT(4, 2), &amp;MAT(4, 3), &amp;MAT(4, 4), &amp;MAT(4, 5),  \</div>
<div class="line">      &amp;MAT(5, 0), &amp;MAT(5, 1), &amp;MAT(5, 2), &amp;MAT(5, 3), &amp;MAT(5, 4), &amp;MAT(5, 5)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="Remodeling_8cpp_source.html#l00040">40</a> of file <a class="el" href="Remodeling_8cpp_source.html">Remodeling.cpp</a>.</p>

</div>
</div>
<a id="a0acc90838d2c5c8e49a09305d488779a" name="a0acc90838d2c5c8e49a09305d488779a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0acc90838d2c5c8e49a09305d488779a">&#9670;&#160;</a></span>TENSOR1_VEC_PTR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TENSOR1_VEC_PTR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">VEC</td><td>)</td>
          <td>&#160;&#160;&#160;&amp;VEC[0], &amp;VEC[1], &amp;VEC[2]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Remodeling_8cpp_source.html#l00038">38</a> of file <a class="el" href="Remodeling_8cpp_source.html">Remodeling.cpp</a>.</p>

</div>
</div>
<a id="a582835fd072f2ee1a3370455cf2b57cc" name="a582835fd072f2ee1a3370455cf2b57cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a582835fd072f2ee1a3370455cf2b57cc">&#9670;&#160;</a></span>TENSOR2_MAT_PTR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TENSOR2_MAT_PTR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">MAT</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  &amp;MAT(0, 0), &amp;MAT(1, 0), &amp;MAT(2, 0), &amp;MAT(3, 0), &amp;MAT(4, 0), &amp;MAT(5, 0),      \</div>
<div class="line">      &amp;MAT(6, 0), &amp;MAT(7, 0), &amp;MAT(8, 0)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="Remodeling_8cpp_source.html#l00050">50</a> of file <a class="el" href="Remodeling_8cpp_source.html">Remodeling.cpp</a>.</p>

</div>
</div>
<a id="aff752f795f2d1fdbee680e2e1630d50c" name="aff752f795f2d1fdbee680e2e1630d50c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff752f795f2d1fdbee680e2e1630d50c">&#9670;&#160;</a></span>TENSOR4_MAT_PTR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TENSOR4_MAT_PTR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">MAT</td><td>)</td>
          <td>&#160;&#160;&#160;&amp;MAT(0, 0), MAT.size2()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Remodeling_8cpp_source.html#l00048">48</a> of file <a class="el" href="Remodeling_8cpp_source.html">Remodeling.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.8
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>