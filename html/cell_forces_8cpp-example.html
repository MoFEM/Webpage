<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.12.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: cell_forces.cpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script>
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">cell_forces.cpp</div></div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="cell_potential"></a>
Implementation with forces potential</h1>
<p>In the following code, we solve the problem of identification of forces which result in given displacements on some surface inside the body.</p>
<p>In the experiment, a body is covered on top by transparent gel layer, on the interface between movements of markers (bids) is observed. Strain in the body is generated by cells living on the top layer. Here we looking for forces generated by those cells.</p>
<p>Following implementing when needed could be easily extended to curved surfaces arbitrary located in the body.</p>
<p><a class="el" href="faqs.html#mofem_citation">How to cite us?</a></p>
<p> 
<a href="https://doi.org/10.5281/zenodo.439392"><img
src="https://zenodo.org/badge/DOI/10.5281/zenodo.439392.svg" alt="DOI"></a> <a
href="https://doi.org/10.5281/zenodo.439395"><img
src="https://zenodo.org/badge/DOI/10.5281/zenodo.439395.svg" alt="DOI"></a>
</p>
<h2><a class="anchor" id="cell_local"></a>
Local curl-free formulation</h2>
<p>This problem can be mathematically described by minimisation problem with the constraints, as follows          </p><p class="formulaDsp">
\[
\left\{
\begin{array}{l}
\textrm{min}\,J(u,\rho) = \frac{1}{2} (u-u_d,S(u-u_d))_{S_u} +
\frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho} \\
\textrm{div}[\sigma(u)] = 0 \quad \textrm{in}\,V \\
n\cdot\sigma(u) = \rho \quad \textrm{on}\,S_\rho \\
\end{array}
\right.
\]
</p>
<p> Applying standard procedure, i.e. Lagrange multiplier method, we get       </p><p class="formulaDsp">
\[
\left\{
\begin{array}{l}
\textrm{min}\,J(u,\rho,\Upsilon) =
\frac{1}{2} (u,S(u-u_d))_{S_u} + \frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho} +
(\Upsilon,\textrm{div}[\sigma])_V  \\ n\cdot\sigma = \rho \quad
\textrm{on}\,S_\rho \end{array} \right. \]
</p>
<p> and applying differentiation by parts    </p><p class="formulaDsp">
\[ J(u,\rho,\Upsilon) = \frac{1}{2} (u-u_d,S(u-u_d))_{S_u}
+\frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho}
+(\textrm{grad}[\Upsilon],\sigma)_V - (\Upsilon,n\cdot\sigma)_{S_\rho}
\]
</p>
<p> and using second constraint, i.e. static constrain      </p><p class="formulaDsp">
\[
J(u,\rho,\Upsilon) =
\frac{1}{2} (u-u_d,S(u-u_d))_{S_u}
+\frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho}
+(\textrm{grad}[\Upsilon],\sigma)_V - (\Upsilon,\rho)_{S_\rho}.
\]
</p>
<p> Note that force is enforced in week sense.</p>
<p>Notting that   </p><p class="formulaDsp">
\[
\sigma =  \mathcal{A} \left( \textrm{grad}[u] \right)^{s}
\]
</p>
<p> and using symmetry of operator \(\mathcal{A}\),      </p><p class="formulaDsp">
\[
(\textrm{grad}[\Upsilon],\sigma)_V =
(\textrm{grad}[\Upsilon],\mathcal{A} \textrm{grad}[u] )_V =
(\mathcal{A}^{*}\textrm{grad}[\Upsilon],\textrm{grad}[u] )_V =
(\Sigma,\textrm{grad}[u] )_V
\]
</p>
<p> we finally get      </p><p class="formulaDsp">
\[
J(u,\rho,\Upsilon) =
\frac{1}{2} (u-u_d,S(u-u_d))_{S_u}
+\frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho}
+(\Sigma,\textrm{grad}[u])_V - (\Upsilon,\rho)_{S_\rho}
\]
</p>
<p>Calculating derivatives, we can get Euler equations in following form          </p><p class="formulaDsp">
\[
\left\{
\begin{array}{ll}
(Su,\delta u)_{S_u} + (\Sigma,\textrm{grad}[\delta u])_V &amp;= 0 \\
(\sigma,\textrm{grad}[\delta \Upsilon])_V-(\rho,\delta \Upsilon)_{S_\rho} &amp;= 0
\\
(\epsilon_\rho \rho,\delta \rho)_{S_\rho}-(\Upsilon,\delta \rho)_{S_\rho} &amp;= 0
\end{array}
\right.
\]
</p>
<p> and applying finite element discretization, above equations are expressed by linear algebraic equations suitable for computer calculations                    </p><p class="formulaDsp">
\[
\left[
\begin{array}{ccc}
S &amp; K_{u \Upsilon} &amp; 0 \\
K_{\Upsilon u} &amp; 0 &amp; -B^\textrm{T} \\
0 &amp; -B &amp; D
\end{array}
\right]
\left[
\begin{array}{c}
u \\ \Upsilon \\ \rho
\end{array}
\right]
=
\left[
\begin{array}{c}
S u_d \\ 0 \\ 0
\end{array}
\right]
\]
</p>
<p> and finally swapping first two rows, we finally get                    </p><p class="formulaDsp">
\[
\left[
\begin{array}{ccc}
K &amp; 0 &amp; -B^\textrm{T} \\
S &amp; K &amp; 0 \\
0 &amp; -B &amp; D
\end{array}
\right]
\left[
\begin{array}{c}
u \\ \Upsilon \\ \rho
\end{array}
\right]
=
\left[
\begin{array}{c}
0 \\ S u_d \\ 0
\end{array}
\right]
\]
</p>
<p> where    </p><p class="formulaDsp">
\[
S=\epsilon_u^{-1} I\\
\epsilon_\rho^\textrm{abs} =  \epsilon_\rho^\text{ref}\epsilon_u^{-1}
\]
</p>
<p>Displacement field is \(\mathbf{u}\) and \(\Upsilon\), force field on top surface is \(\boldsymbol\rho\).</p>
<p>We not yet explored nature of cell forces. Since the cells are attached to the body surface and anything else, the body as results those forces can not be subjected to rigid body motion.</p>
<p>We assume that forces are generated by 2d objects, as results only tangential forces can be produced by those forces if the surface is planar. For non-planar surfaces addition force normal to the surface is present, although the magnitude of this force could be calculated purely from geometrical considerations, thus additional physical equations are not needed.</p>
<p>Assuming that straight and very short pre-stressed fibres generate cell forces; a force field is curl-free. Utilising that forces can be expressed by potential field as follows   </p><p class="formulaDsp">
\[
\rho = \frac{\partial \Phi_\rho}{\partial \mathbf{x}}
\]
</p>
<p> where \(\Phi\) is force potential field.</p>
<h3><a class="anchor" id="cell_local_approx"></a>
Approximation</h3>
<p>For this problem \(H^(\Omega)\) function space is required for \(u\), \(\Upsilon\) and \(\rho\). Note that \(\rho\) is given by derivative of potential field \(\Phi\) which derivatives gives potential forces.</p>
<h2><a class="anchor" id="cell_nonlocal"></a>
Nonlocal, i.e. weak curl-free</h2>
<p>In this variant generalisation of the local model to a weakly enforced force curl-free cell force field is considered. This generalisation is a consequence of the observation that cell has some small but finite size. Moreover, a cell has a complex pre-stressed structure which can transfer shear forces.</p>
<p>We define model like before, however this time we add additional term,            </p><p class="formulaDsp">
\[
 \left\{
\begin{array}{l}
\textrm{min}\,J(u,\rho) =
\frac{1}{2} (u-u_d,S(u-u_d))_{S_u} +
\frac{\epsilon_\rho}{2}(\rho,\rho-l^2\textrm{curl}^s
[\textrm{curl}^s[\rho]])_{S_\rho} \\
\textrm{div}[\sigma(u)] = 0 \quad \textrm{in}\,V \\
n\cdot\sigma = \rho
\end{array}
\right.
\]
</p>
<p> and reformulating this we have            </p><p class="formulaDsp">
\[
\left\{
\begin{array}{l}
\textrm{min}\,J(u,\rho) =
\frac{1}{2} (u-u_d,S(u-u_d))_{S_u} + \frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho}
+\frac{\epsilon_l^{-1}}{2}(\textrm{curl}^s[\rho],\textrm{curl}^s[\rho])_{S_\rho}
\\
\textrm{div}[\sigma(u)] = 0 \quad \textrm{in}\,V \\
n\cdot\sigma = \rho
\end{array}
\right.
\]
</p>
<p> where parameter \(\epsilon_l\) controls curl-free term, if this parameter approach zero, this formulation converge to local variant presented above.</p>
<p>Applying the same procedure like before, set of Euler equations is derived        </p><p class="formulaDsp">
\[
\left\{
\begin{array}{l}
(Su,\delta u)_{S_u} + (\Sigma,\textrm{grad}[\delta u])_V= 0 \\
(\sigma,\textrm{grad}[\delta \Upsilon])_V-(\rho,\delta \Upsilon)_{S_\rho} = 0 \\
(\epsilon_\rho \rho,\delta
\rho)_{S_\rho}+\epsilon_l^{-1}(\textrm{curl}^s[\rho],\textrm{curl}^s[\delta
\rho])_{S_\rho}-(\Upsilon,\delta \rho)_{S_\rho} = 0 \end{array} \right. \]
</p>
<p> That give following system of equations                  </p><p class="formulaDsp">
\[ \left[ \begin{array}{ccc}
S &amp; K_{u \Upsilon} &amp; 0 \\
K_{\Upsilon u} &amp; 0 &amp; -B^\textrm{T} \\
0 &amp; -B &amp; D
\end{array}
\right]
\left[
\begin{array}{c}
u \\ \Upsilon \\ \rho
\end{array}
\right]
=
\left[
\begin{array}{c}
S u_d \\ 0 \\ 0
\end{array}
\right]
\]
</p>
<p> and swapping the first two rows we get                    </p><p class="formulaDsp">
\[
\left[
\begin{array}{ccc}
K &amp; 0 &amp; -B^\textrm{T} \\
S &amp; K &amp; 0 \\
0 &amp; -B &amp; D
\end{array}
\right]
\left[
\begin{array}{c}
u \\ \Upsilon \\ \rho
\end{array}
\right]
=
\left[
\begin{array}{c}
0 \\ S u_d \\ 0
\end{array}
\right]
\]
</p>
<h3><a class="anchor" id="cell_nonlocal_approx"></a>
Approximation</h3>
<p>For this problem \(H^(\Omega)\) function space is required for \(u\), \(\Upsilon\). Note that force field need to be in \(H(\textrm{curl},S_\rho)\) space.</p>
<h1><a class="anchor" id="cell_solution"></a>
Field split pre-conditioner</h1>
<p>In this implementation, the block structure of the matrix is utilised. The <em>PCFIELDSPLIT</em> (see <a href="http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/PC/PCFIELDSPLIT.html">http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/PC/PCFIELDSPLIT.html</a>) is utilised. Matrix is stored using nested matrix format <em>MATNEST</em> (see )<a href="http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/Mat/MatCreateNest.html">http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/Mat/MatCreateNest.html</a>).</p>
<p>The sub-netsetd matrix is created containing two upper-left blocks,        </p><p class="formulaDsp">
\[
X = \left[
\begin{array}{cc}
K &amp; 0  \\
S &amp; K
\end{array}
\right]
\]
</p>
<p> this netsed matrix is blocked in        </p><p class="formulaDsp">
\[
A= \left[
\begin{array}{cc}
X &amp; V  \\
H &amp; D
\end{array}
\right]
\]
</p>
<p> where        </p><p class="formulaDsp">
\[
V= \left[
\begin{array}{c}
-B^\textrm{T} \\
0
\end{array}
\right]
\]
</p>
<p> and       </p><p class="formulaDsp">
\[
H= \left[
\begin{array}{cc}
0 &amp; -B^\textrm{T}
\end{array}
\right]
\]
</p>
<p>The system associated with X matrix is solved using <em>PCFIELDSPLIT</em> and multiplicative relaxation scheme. In following implementation sub-matrix, K is factorised only once. The system related to matrix \(A\) composed form matrices \(X,D,V,H\) is solved using Schur complement. Note that here we exploit <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> capability to create sub-problems in easy way.</p>
<h1><a class="anchor" id="cell_running_code"></a>
Running code</h1>
<p>Approximations of displacements </p><div class="fragment"><div class="line">./map_disp \</div>
<div class="line">-my_data_x ./examples/data_x.csv \</div>
<div class="line">-my_data_y ./examples/data_y.csv \</div>
<div class="line">-my_file ./examples/mesh_cell_force_map.cub \</div>
<div class="line">-ksp_type cg -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor \</div>
<div class="line">-<a id="a0" name="a0"></a><a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> 0.01 -my_order 3 -<a id="a1" name="a1"></a><a class="code hl_variable" href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a> 0.05 -cube_size 1 -my_nparts 4</div>
<div class="ttc" id="aincompressible__elasticity_8cpp_html_a3db359547eed8cfd48ca821d95f577af"><div class="ttname"><a href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a></div><div class="ttdeci">static double lambda</div><div class="ttdef"><b>Definition</b> <a href="incompressible__elasticity_8cpp_source.html#l00199">incompressible_elasticity.cpp:199</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a80d402d10e8341004c0caf10133b80ab"><div class="ttname"><a href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a></div><div class="ttdeci">double scale</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00119">plastic.cpp:119</a></div></div>
</div><!-- fragment --><p>If only one layer is specified, another thin polymer layer could be created automatically using prism elements, </p><div class="fragment"><div class="line">./map_disp_prism \</div>
<div class="line">-my_thinckness 0.01 \</div>
<div class="line">-my_data_x ./examples/data_x.csv \</div>
<div class="line">-my_data_y ./examples/data_y.csv \</div>
<div class="line">-my_file ./examples/mesh_for_prisms.cub \</div>
<div class="line">-ksp_type cg -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor \</div>
<div class="line">-<a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> 0.01 -my_order 3 -<a class="code hl_variable" href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a> 0.05 -cube_size 1 -my_nparts 4</div>
</div><!-- fragment --><p>Config file </p><div class="fragment"><div class="line">eps_u = 1e-4</div>
<div class="line">eps_rho = 1e2</div>
<div class="line">eps_l = 1e-2</div>
<div class="line"> </div>
<div class="line">[block_1]</div>
<div class="line"> </div>
<div class="line">young_modulus=3.6e-3</div>
<div class="line">poisson_ratio=0.49</div>
<div class="line"> </div>
<div class="line">[block_2]</div>
<div class="line"> </div>
<div class="line">young_modulus=0.35</div>
<div class="line">poisson_ratio=0.49</div>
<div class="line">displacement_order=3</div>
</div><!-- fragment --><p>Calculating forces </p><div class="fragment"><div class="line">mpirun -np 4 ./cell_forces \</div>
<div class="line">-my_file analysis_mesh.h5m \</div>
<div class="line">-my_order 1 -my_order_force 2 -my_max_post_proc_ref_level 0 \</div>
<div class="line">-my_block_config ./examples/block_config.in \</div>
<div class="line">-ksp_type fgmres -ksp_monitor \</div>
<div class="line">-fieldsplit_1_ksp_type fgmres \</div>
<div class="line">-fieldsplit_1_pc_type lu \</div>
<div class="line">-fieldsplit_1_pc_factor_mat_solver_package mumps \</div>
<div class="line">-fieldsplit_1_ksp_max_it 100 \</div>
<div class="line">-fieldsplit_1_ksp_monitor  \</div>
<div class="line">-fieldsplit_0_ksp_type gmres \</div>
<div class="line">-fieldsplit_0_ksp_max_it 25 \</div>
<div class="line">-fieldsplit_0_fieldsplit_0_ksp_type preonly \</div>
<div class="line">-fieldsplit_0_fieldsplit_0_pc_type lu \</div>
<div class="line">-fieldsplit_0_fieldsplit_0_pc_factor_mat_solver_package mumps \</div>
<div class="line">-fieldsplit_0_fieldsplit_1_ksp_type preonly \</div>
<div class="line">-fieldsplit_0_fieldsplit_1_pc_type lu \</div>
<div class="line">-fieldsplit_0_fieldsplit_1_pc_factor_mat_solver_package mumps \</div>
<div class="line">-ksp_atol 1e-6 -ksp_rtol 0 -my_eps_u 1e-4 -my_curl 1</div>
</div><!-- fragment --><p>As results of above we get </p><div class="image">
<img src="cell_engineering_forces_example.gif" alt="" width="600px"/>
<div class="caption">
Example: results</div></div>
<h1><a class="anchor" id="cell_install"></a>
Installation with docker</h1>
<ul>
<li>First install docker as per the instructions here: <a href="https://docs.docker.com/installation/#installation">https://docs.docker.com/installation/#installation</a></li>
<li><p class="startli">Install cell user module: <em>docker</em> <em>pull</em> <em>likask/cell_engineering</em> </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000071">Todo</a></b></dt><dd>Improve documentation</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000072">Todo</a></b></dt><dd>Generalization to curved surfaces. That should not be difficult adding metric tensors and taking into account curvature.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000073">Todo</a></b></dt><dd>Instead of elastic material we can use GEL model developed in other module. That will allow to take into account drying and other rheological effects.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000074">Todo</a></b></dt><dd>For nonlinear material instead of KSP solver we can add SNES solver</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000075">Todo</a></b></dt><dd>Physical equations for cell mechanics could be added directly to minimized functional or by constrains.</dd></dl>
</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file cell_forces.cpp</span></div>
<div class="line"><span class="comment"> * \brief Calculate cell forces</span></div>
<div class="line"><span class="comment"> * \example cell_forces.cpp</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\tableofcontents</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\section cell_potential Implementation with forces potential</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">In the following code, we solve the problem of identification of forces which</span></div>
<div class="line"><span class="comment">result in given displacements on some surface inside the body.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">In the experiment, a body is covered on top by transparent gel layer, on the</span></div>
<div class="line"><span class="comment">interface between movements of markers (bids) is observed. Strain in the body is</span></div>
<div class="line"><span class="comment">generated by cells living on the top layer. Here we looking for forces generated</span></div>
<div class="line"><span class="comment">by those cells.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Following implementing when needed could be easily extended to curved surfaces</span></div>
<div class="line"><span class="comment">arbitrary located in the body.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\ref mofem_citation</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\htmlonly</span></div>
<div class="line"><span class="comment">&lt;a href=&quot;https://doi.org/10.5281/zenodo.439392&quot;&gt;&lt;img</span></div>
<div class="line"><span class="comment">src=&quot;https://zenodo.org/badge/DOI/10.5281/zenodo.439392.svg&quot; alt=&quot;DOI&quot;&gt;&lt;/a&gt; &lt;a</span></div>
<div class="line"><span class="comment">href=&quot;https://doi.org/10.5281/zenodo.439395&quot;&gt;&lt;img</span></div>
<div class="line"><span class="comment">src=&quot;https://zenodo.org/badge/DOI/10.5281/zenodo.439395.svg&quot; alt=&quot;DOI&quot;&gt;&lt;/a&gt;</span></div>
<div class="line"><span class="comment">\endhtmlonly</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\subsection cell_local Local curl-free formulation</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">This problem can be mathematically described by minimisation problem with the</span></div>
<div class="line"><span class="comment">constraints, as follows</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">\left\{</span></div>
<div class="line"><span class="comment">\begin{array}{l}</span></div>
<div class="line"><span class="comment">\textrm{min}\,J(u,\rho) = \frac{1}{2} (u-u_d,S(u-u_d))_{S_u} +</span></div>
<div class="line"><span class="comment">\frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho} \\</span></div>
<div class="line"><span class="comment">\textrm{div}[\sigma(u)] = 0 \quad \textrm{in}\,V \\</span></div>
<div class="line"><span class="comment">n\cdot\sigma(u) = \rho \quad \textrm{on}\,S_\rho \\</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right.</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">Applying standard procedure, i.e. Lagrange multiplier method, we get</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">\left\{</span></div>
<div class="line"><span class="comment">\begin{array}{l}</span></div>
<div class="line"><span class="comment">\textrm{min}\,J(u,\rho,\Upsilon) =</span></div>
<div class="line"><span class="comment">\frac{1}{2} (u,S(u-u_d))_{S_u} + \frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho} +</span></div>
<div class="line"><span class="comment">(\Upsilon,\textrm{div}[\sigma])_V  \\ n\cdot\sigma = \rho \quad</span></div>
<div class="line"><span class="comment">\textrm{on}\,S_\rho \end{array} \right. \f] and applying differentiation by</span></div>
<div class="line"><span class="comment">parts \f[ J(u,\rho,\Upsilon) = \frac{1}{2} (u-u_d,S(u-u_d))_{S_u}</span></div>
<div class="line"><span class="comment">+\frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho}</span></div>
<div class="line"><span class="comment">+(\textrm{grad}[\Upsilon],\sigma)_V - (\Upsilon,n\cdot\sigma)_{S_\rho}</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">and using second constraint, i.e. static constrain</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">J(u,\rho,\Upsilon) =</span></div>
<div class="line"><span class="comment">\frac{1}{2} (u-u_d,S(u-u_d))_{S_u}</span></div>
<div class="line"><span class="comment">+\frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho}</span></div>
<div class="line"><span class="comment">+(\textrm{grad}[\Upsilon],\sigma)_V - (\Upsilon,\rho)_{S_\rho}.</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">Note that force is enforced in week sense.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Notting that</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">\sigma =  \mathcal{A} \left( \textrm{grad}[u] \right)^{s}</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">and using symmetry of operator \f$\mathcal{A}\f$,</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">(\textrm{grad}[\Upsilon],\sigma)_V =</span></div>
<div class="line"><span class="comment">(\textrm{grad}[\Upsilon],\mathcal{A} \textrm{grad}[u] )_V =</span></div>
<div class="line"><span class="comment">(\mathcal{A}^{*}\textrm{grad}[\Upsilon],\textrm{grad}[u] )_V =</span></div>
<div class="line"><span class="comment">(\Sigma,\textrm{grad}[u] )_V</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">we finally get</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">J(u,\rho,\Upsilon) =</span></div>
<div class="line"><span class="comment">\frac{1}{2} (u-u_d,S(u-u_d))_{S_u}</span></div>
<div class="line"><span class="comment">+\frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho}</span></div>
<div class="line"><span class="comment">+(\Sigma,\textrm{grad}[u])_V - (\Upsilon,\rho)_{S_\rho}</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Calculating derivatives, we can get Euler equations in following form</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">\left\{</span></div>
<div class="line"><span class="comment">\begin{array}{ll}</span></div>
<div class="line"><span class="comment">(Su,\delta u)_{S_u} + (\Sigma,\textrm{grad}[\delta u])_V &amp;= 0 \\</span></div>
<div class="line"><span class="comment">(\sigma,\textrm{grad}[\delta \Upsilon])_V-(\rho,\delta \Upsilon)_{S_\rho} &amp;= 0</span></div>
<div class="line"><span class="comment">\\</span></div>
<div class="line"><span class="comment">(\epsilon_\rho \rho,\delta \rho)_{S_\rho}-(\Upsilon,\delta \rho)_{S_\rho} &amp;= 0</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right.</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">and applying finite element discretization, above equations are expressed</span></div>
<div class="line"><span class="comment">by linear algebraic equations suitable for computer calculations</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{ccc}</span></div>
<div class="line"><span class="comment">S &amp; K_{u \Upsilon} &amp; 0 \\</span></div>
<div class="line"><span class="comment">K_{\Upsilon u} &amp; 0 &amp; -B^\textrm{T} \\</span></div>
<div class="line"><span class="comment">0 &amp; -B &amp; D</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{c}</span></div>
<div class="line"><span class="comment">u \\ \Upsilon \\ \rho</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">=</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{c}</span></div>
<div class="line"><span class="comment">S u_d \\ 0 \\ 0</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">and finally swapping first two rows, we finally get</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{ccc}</span></div>
<div class="line"><span class="comment">K &amp; 0 &amp; -B^\textrm{T} \\</span></div>
<div class="line"><span class="comment">S &amp; K &amp; 0 \\</span></div>
<div class="line"><span class="comment">0 &amp; -B &amp; D</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{c}</span></div>
<div class="line"><span class="comment">u \\ \Upsilon \\ \rho</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">=</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{c}</span></div>
<div class="line"><span class="comment">0 \\ S u_d \\ 0</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">where</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">S=\epsilon_u^{-1} I\\</span></div>
<div class="line"><span class="comment">\epsilon_\rho^\textrm{abs} =  \epsilon_\rho^\text{ref}\epsilon_u^{-1}</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Displacement field is \f$\mathbf{u}\f$ and \f$\Upsilon\f$, force field on top</span></div>
<div class="line"><span class="comment">surface is \f$\boldsymbol\rho\f$.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">We not yet explored nature of cell forces. Since the cells are attached to the</span></div>
<div class="line"><span class="comment">body surface and anything else, the body as results those forces can not be</span></div>
<div class="line"><span class="comment">subjected to rigid body motion.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">We assume that forces are generated by 2d objects, as results only tangential</span></div>
<div class="line"><span class="comment">forces can be produced by those forces if the surface is planar. For non-planar</span></div>
<div class="line"><span class="comment">surfaces addition force normal to the surface is present, although the magnitude</span></div>
<div class="line"><span class="comment">of this force could be calculated purely from geometrical considerations, thus</span></div>
<div class="line"><span class="comment">additional physical equations are not needed.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Assuming that straight and very short pre-stressed fibres generate cell forces;</span></div>
<div class="line"><span class="comment">a force field is curl-free. Utilising that  forces can be expressed by potential</span></div>
<div class="line"><span class="comment">field as follows</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">\rho = \frac{\partial \Phi_\rho}{\partial \mathbf{x}}</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">where \f$\Phi\f$ is force potential field.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\subsubsection cell_local_approx Approximation</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">For this problem \f$H^(\Omega)\f$ function space is required for \f$u\f$,</span></div>
<div class="line"><span class="comment">\f$\Upsilon\f$ and \f$\rho\f$. Note that \f$\rho\f$ is given by derivative of</span></div>
<div class="line"><span class="comment">potential field \f$\Phi\f$ which derivatives gives potential forces.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\subsection cell_nonlocal Nonlocal, i.e. weak curl-free</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">In this variant generalisation of the local model to a weakly enforced force</span></div>
<div class="line"><span class="comment">curl-free cell force field is considered. This generalisation is a consequence</span></div>
<div class="line"><span class="comment">of the observation that cell has some small but finite size. Moreover, a cell</span></div>
<div class="line"><span class="comment">has a complex pre-stressed structure which can transfer shear forces.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">We define model like before, however this time we add additional term,</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment"> \left\{</span></div>
<div class="line"><span class="comment">\begin{array}{l}</span></div>
<div class="line"><span class="comment">\textrm{min}\,J(u,\rho) =</span></div>
<div class="line"><span class="comment">\frac{1}{2} (u-u_d,S(u-u_d))_{S_u} +</span></div>
<div class="line"><span class="comment">\frac{\epsilon_\rho}{2}(\rho,\rho-l^2\textrm{curl}^s</span></div>
<div class="line"><span class="comment">[\textrm{curl}^s[\rho]])_{S_\rho} \\</span></div>
<div class="line"><span class="comment">\textrm{div}[\sigma(u)] = 0 \quad \textrm{in}\,V \\</span></div>
<div class="line"><span class="comment">n\cdot\sigma = \rho</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right.</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">and reformulating this we have</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">\left\{</span></div>
<div class="line"><span class="comment">\begin{array}{l}</span></div>
<div class="line"><span class="comment">\textrm{min}\,J(u,\rho) =</span></div>
<div class="line"><span class="comment">\frac{1}{2} (u-u_d,S(u-u_d))_{S_u} + \frac{\epsilon_\rho}{2}(\rho,\rho)_{S_\rho}</span></div>
<div class="line"><span class="comment">+\frac{\epsilon_l^{-1}}{2}(\textrm{curl}^s[\rho],\textrm{curl}^s[\rho])_{S_\rho}</span></div>
<div class="line"><span class="comment">\\</span></div>
<div class="line"><span class="comment">\textrm{div}[\sigma(u)] = 0 \quad \textrm{in}\,V \\</span></div>
<div class="line"><span class="comment">n\cdot\sigma = \rho</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right.</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">where parameter \f$\epsilon_l\f$ controls curl-free term, if this parameter</span></div>
<div class="line"><span class="comment">approach zero, this formulation converge to local variant presented above.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Applying the same procedure like before, set of Euler equations is derived</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">\left\{</span></div>
<div class="line"><span class="comment">\begin{array}{l}</span></div>
<div class="line"><span class="comment">(Su,\delta u)_{S_u} + (\Sigma,\textrm{grad}[\delta u])_V= 0 \\</span></div>
<div class="line"><span class="comment">(\sigma,\textrm{grad}[\delta \Upsilon])_V-(\rho,\delta \Upsilon)_{S_\rho} = 0 \\</span></div>
<div class="line"><span class="comment">(\epsilon_\rho \rho,\delta</span></div>
<div class="line"><span class="comment">\rho)_{S_\rho}+\epsilon_l^{-1}(\textrm{curl}^s[\rho],\textrm{curl}^s[\delta</span></div>
<div class="line"><span class="comment">\rho])_{S_\rho}-(\Upsilon,\delta \rho)_{S_\rho} = 0 \end{array} \right. \f] That</span></div>
<div class="line"><span class="comment">give following system of equations \f[ \left[ \begin{array}{ccc}</span></div>
<div class="line"><span class="comment">S &amp; K_{u \Upsilon} &amp; 0 \\</span></div>
<div class="line"><span class="comment">K_{\Upsilon u} &amp; 0 &amp; -B^\textrm{T} \\</span></div>
<div class="line"><span class="comment">0 &amp; -B &amp; D</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{c}</span></div>
<div class="line"><span class="comment">u \\ \Upsilon \\ \rho</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">=</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{c}</span></div>
<div class="line"><span class="comment">S u_d \\ 0 \\ 0</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">and swapping the first two rows we get</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{ccc}</span></div>
<div class="line"><span class="comment">K &amp; 0 &amp; -B^\textrm{T} \\</span></div>
<div class="line"><span class="comment">S &amp; K &amp; 0 \\</span></div>
<div class="line"><span class="comment">0 &amp; -B &amp; D</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{c}</span></div>
<div class="line"><span class="comment">u \\ \Upsilon \\ \rho</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">=</span></div>
<div class="line"><span class="comment">\left[</span></div>
<div class="line"><span class="comment">\begin{array}{c}</span></div>
<div class="line"><span class="comment">0 \\ S u_d \\ 0</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\subsubsection cell_nonlocal_approx Approximation</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">For this problem \f$H^(\Omega)\f$ function space is required for \f$u\f$,</span></div>
<div class="line"><span class="comment">\f$\Upsilon\f$. Note that force field need to be in</span></div>
<div class="line"><span class="comment">\f$H(\textrm{curl},S_\rho)\f$ space.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\section cell_solution Field split pre-conditioner</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">In this implementation, the block structure of the matrix is utilised. The \e</span></div>
<div class="line"><span class="comment">PCFIELDSPLIT</span></div>
<div class="line"><span class="comment">(see</span></div>
<div class="line"><span class="comment">&lt;http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/PC/PCFIELDSPLIT.html&gt;)</span></div>
<div class="line"><span class="comment">is utilised. Matrix is stored using nested matrix format \e MATNEST</span></div>
<div class="line"><span class="comment">(see</span></div>
<div class="line"><span class="comment">)&lt;http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/Mat/MatCreateNest.html&gt;).</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">The sub-netsetd matrix is created containing two upper-left blocks,</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">X = \left[</span></div>
<div class="line"><span class="comment">\begin{array}{cc}</span></div>
<div class="line"><span class="comment">K &amp; 0  \\</span></div>
<div class="line"><span class="comment">S &amp; K</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">this netsed matrix is blocked in</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">A= \left[</span></div>
<div class="line"><span class="comment">\begin{array}{cc}</span></div>
<div class="line"><span class="comment">X &amp; V  \\</span></div>
<div class="line"><span class="comment">H &amp; D</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">where</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">V= \left[</span></div>
<div class="line"><span class="comment">\begin{array}{c}</span></div>
<div class="line"><span class="comment">-B^\textrm{T} \\</span></div>
<div class="line"><span class="comment">0</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment">and</span></div>
<div class="line"><span class="comment">\f[</span></div>
<div class="line"><span class="comment">H= \left[</span></div>
<div class="line"><span class="comment">\begin{array}{cc}</span></div>
<div class="line"><span class="comment">0 &amp; -B^\textrm{T}</span></div>
<div class="line"><span class="comment">\end{array}</span></div>
<div class="line"><span class="comment">\right]</span></div>
<div class="line"><span class="comment">\f]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">The system associated with X matrix is solved using \e PCFIELDSPLIT and</span></div>
<div class="line"><span class="comment">multiplicative relaxation scheme. In following implementation sub-matrix, K is</span></div>
<div class="line"><span class="comment">factorised only once.  The system related to matrix \f$A\f$ composed form</span></div>
<div class="line"><span class="comment">matrices \f$X,D,V,H\f$ is solved using Schur complement. Note that here we</span></div>
<div class="line"><span class="comment">exploit MoFEM capability to create sub-problems in easy way.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\section cell_running_code Running code</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Approximations of displacements</span></div>
<div class="line"><span class="comment">\code</span></div>
<div class="line"><span class="comment">./map_disp \</span></div>
<div class="line"><span class="comment">-my_data_x ./examples/data_x.csv \</span></div>
<div class="line"><span class="comment">-my_data_y ./examples/data_y.csv \</span></div>
<div class="line"><span class="comment">-my_file ./examples/mesh_cell_force_map.cub \</span></div>
<div class="line"><span class="comment">-ksp_type cg -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor \</span></div>
<div class="line"><span class="comment">-lambda 0.01 -my_order 3 -scale 0.05 -cube_size 1 -my_nparts 4</span></div>
<div class="line"><span class="comment">\endcode</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">If only one layer is specified, another thin polymer layer could be created</span></div>
<div class="line"><span class="comment">automatically using prism elements,</span></div>
<div class="line"><span class="comment">\code</span></div>
<div class="line"><span class="comment">./map_disp_prism \</span></div>
<div class="line"><span class="comment">-my_thinckness 0.01 \</span></div>
<div class="line"><span class="comment">-my_data_x ./examples/data_x.csv \</span></div>
<div class="line"><span class="comment">-my_data_y ./examples/data_y.csv \</span></div>
<div class="line"><span class="comment">-my_file ./examples/mesh_for_prisms.cub \</span></div>
<div class="line"><span class="comment">-ksp_type cg -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor \</span></div>
<div class="line"><span class="comment">-lambda 0.01 -my_order 3 -scale 0.05 -cube_size 1 -my_nparts 4</span></div>
<div class="line"><span class="comment">\endcode</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Config file</span></div>
<div class="line"><span class="comment">\include users_modules/cell_engineering/examples/block_config.in</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Calculating forces</span></div>
<div class="line"><span class="comment">\code</span></div>
<div class="line"><span class="comment">mpirun -np 4 ./cell_forces \</span></div>
<div class="line"><span class="comment">-my_file analysis_mesh.h5m \</span></div>
<div class="line"><span class="comment">-my_order 1 -my_order_force 2 -my_max_post_proc_ref_level 0 \</span></div>
<div class="line"><span class="comment">-my_block_config ./examples/block_config.in \</span></div>
<div class="line"><span class="comment">-ksp_type fgmres -ksp_monitor \</span></div>
<div class="line"><span class="comment">-fieldsplit_1_ksp_type fgmres \</span></div>
<div class="line"><span class="comment">-fieldsplit_1_pc_type lu \</span></div>
<div class="line"><span class="comment">-fieldsplit_1_pc_factor_mat_solver_package mumps \</span></div>
<div class="line"><span class="comment">-fieldsplit_1_ksp_max_it 100 \</span></div>
<div class="line"><span class="comment">-fieldsplit_1_ksp_monitor  \</span></div>
<div class="line"><span class="comment">-fieldsplit_0_ksp_type gmres \</span></div>
<div class="line"><span class="comment">-fieldsplit_0_ksp_max_it 25 \</span></div>
<div class="line"><span class="comment">-fieldsplit_0_fieldsplit_0_ksp_type preonly \</span></div>
<div class="line"><span class="comment">-fieldsplit_0_fieldsplit_0_pc_type lu \</span></div>
<div class="line"><span class="comment">-fieldsplit_0_fieldsplit_0_pc_factor_mat_solver_package mumps \</span></div>
<div class="line"><span class="comment">-fieldsplit_0_fieldsplit_1_ksp_type preonly \</span></div>
<div class="line"><span class="comment">-fieldsplit_0_fieldsplit_1_pc_type lu \</span></div>
<div class="line"><span class="comment">-fieldsplit_0_fieldsplit_1_pc_factor_mat_solver_package mumps \</span></div>
<div class="line"><span class="comment">-ksp_atol 1e-6 -ksp_rtol 0 -my_eps_u 1e-4 -my_curl 1</span></div>
<div class="line"><span class="comment">\endcode</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">As results of above we get</span></div>
<div class="line"><span class="comment">\image html cell_engineering_forces_example.gif &quot;Example: results&quot; width=600px</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\section cell_install Installation with docker</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">- First install docker as per the instructions here:</span></div>
<div class="line"><span class="comment">&lt;https://docs.docker.com/installation/#installation&gt;</span></div>
<div class="line"><span class="comment">- Install cell user module: \e docker \e pull \e likask/cell_engineering</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\todo Improve documentation</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\todo Generalization to curved surfaces. That should not be difficult adding</span></div>
<div class="line"><span class="comment">metric tensors and taking into account curvature.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\todo Instead of elastic material we can use GEL model developed in other</span></div>
<div class="line"><span class="comment">module. That  will allow to take into account drying and other rheological</span></div>
<div class="line"><span class="comment">effects.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\todo For nonlinear material instead of KSP solver we can add SNES solver</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\todo Physical equations for cell mechanics could be added directly to minimized</span></div>
<div class="line"><span class="comment">functional or by constrains.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* This file is part of MoFEM.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> * MoFEM is free software: you can redistribute it and/or modify it under</span></div>
<div class="line"><span class="comment"> * the terms of the GNU Lesser General Public License as published by the</span></div>
<div class="line"><span class="comment"> * Free Software Foundation, either version 3 of the License, or (at your</span></div>
<div class="line"><span class="comment"> * option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * MoFEM is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</span></div>
<div class="line"><span class="comment"> * License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment"> * License along with MoFEM. If not, see &lt;http://www.gnu.org/licenses/&gt;. */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_basic_finite_elements_8hpp.html">BasicFiniteElements.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_mo_f_e_m.html">MoFEM</a>;</div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_hooke_8hpp.html">Hooke.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_cell_forces_8hpp.html">CellForces.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> <a id="a2" name="a2"></a><a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>[] = <span class="stringliteral">&quot;-my_block_config set block data\n&quot;</span></div>
<div class="line">                     <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_cell_engineering.html">CellEngineering</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a id="_a3" name="_a3"></a><a class="code hl_struct" href="struct_block_option_data.html">BlockOptionData</a> {</div>
<div class="line">  <span class="keywordtype">int</span> <a id="a4" name="a4"></a><a class="code hl_variable" href="struct_cell_engineering_1_1_block_option_data.html#aacda3f9808416cf9eb85721ff6f57a79">oRder</a>;</div>
<div class="line">  <span class="keywordtype">double</span> <a id="a5" name="a5"></a><a class="code hl_variable" href="struct_cell_engineering_1_1_block_option_data.html#a9e1244c3c9f228d22a7700013a4e5b69">yOung</a>;</div>
<div class="line">  <span class="keywordtype">double</span> <a id="a6" name="a6"></a><a class="code hl_variable" href="struct_cell_engineering_1_1_block_option_data.html#afd3868e580289cee51eee90ea231a0d6">pOisson</a>;</div>
<div class="line">  <a id="a7" name="a7"></a><a class="code hl_function" href="struct_cell_engineering_1_1_block_option_data.html#a04d0897d5de56a98c5bf304c7eca94b6">BlockOptionData</a>() : <a class="code hl_variable" href="struct_cell_engineering_1_1_block_option_data.html#aacda3f9808416cf9eb85721ff6f57a79">oRder</a>(-1), <a class="code hl_variable" href="struct_cell_engineering_1_1_block_option_data.html#a9e1244c3c9f228d22a7700013a4e5b69">yOung</a>(-1), <a class="code hl_variable" href="struct_cell_engineering_1_1_block_option_data.html#afd3868e580289cee51eee90ea231a0d6">pOisson</a>(-2) {}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace CellEngineering</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>boost::numeric;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_cell_engineering.html">CellEngineering</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;boost/program_options.hpp&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacestd.html">std</a>;</div>
<div class="line"><span class="keyword">namespace </span>po = boost::program_options;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> <a id="a8" name="a8"></a><a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = 0;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a id="a9" name="a9"></a><a class="code hl_function" href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <a id="a10" name="a10"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, (<span class="keywordtype">char</span> *)0, <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">    moab::Core mb_instance;</div>
<div class="line">    moab::Interface &amp;moab = mb_instance;</div>
<div class="line"> </div>
<div class="line">    PetscBool flg_block_config, flg_file;</div>
<div class="line">    <span class="keywordtype">char</span> <a id="a11" name="a11"></a><a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>[255];</div>
<div class="line">    <span class="keywordtype">char</span> block_config_file[255];</div>
<div class="line">    PetscBool flg_order_force;</div>
<div class="line">    PetscInt <a id="a12" name="a12"></a><a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 2;</div>
<div class="line">    PetscInt order_force = 2;</div>
<div class="line">    PetscBool flg_eps_u, flg_eps_rho, flg_eps_l;</div>
<div class="line">    <span class="keywordtype">double</span> eps_u = 1e-6;</div>
<div class="line">    <span class="keywordtype">double</span> eps_rho = 1e-3;</div>
<div class="line">    <span class="keywordtype">double</span> eps_l = 0;</div>
<div class="line">    PetscBool is_curl = PETSC_TRUE;</div>
<div class="line">    <a id="a13" name="a13"></a><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Elastic Config&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsString(<span class="stringliteral">&quot;-my_file&quot;</span>, <span class="stringliteral">&quot;mesh file name&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;mesh.h5m&quot;</span>,</div>
<div class="line">                              <a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 255, &amp;flg_file);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_order&quot;</span>, <span class="stringliteral">&quot;default approximation order&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                           <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, &amp;<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(</div>
<div class="line">        <span class="stringliteral">&quot;-my_order_force&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;default approximation order for force approximation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, order_force,</div>
<div class="line">        &amp;order_force, &amp;flg_order_force);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsString(<span class="stringliteral">&quot;-my_block_config&quot;</span>, <span class="stringliteral">&quot;elastic configure file name&quot;</span>,</div>
<div class="line">                              <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;block_conf.in&quot;</span>, block_config_file, 255,</div>
<div class="line">                              &amp;flg_block_config);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsReal(<span class="stringliteral">&quot;-my_eps_rho&quot;</span>, <span class="stringliteral">&quot;foce optimality parameter &quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                            eps_rho, &amp;eps_rho, &amp;flg_eps_rho);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsReal(<span class="stringliteral">&quot;-my_eps_u&quot;</span>, <span class="stringliteral">&quot;displacement optimality parameter &quot;</span>,</div>
<div class="line">                            <span class="stringliteral">&quot;&quot;</span>, eps_u, &amp;eps_u, &amp;flg_eps_u);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsReal(<span class="stringliteral">&quot;-my_eps_l&quot;</span>, <span class="stringliteral">&quot;displacement optimality parameter &quot;</span>,</div>
<div class="line">                            <span class="stringliteral">&quot;&quot;</span>, eps_l, &amp;eps_l, &amp;flg_eps_l);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-my_curl&quot;</span>, <span class="stringliteral">&quot;use Hcurl space to approximate forces&quot;</span>,</div>
<div class="line">                            <span class="stringliteral">&quot;&quot;</span>, is_curl, &amp;is_curl, NULL);</div>
<div class="line">    <a id="a14" name="a14"></a><a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a> = PetscOptionsEnd();</div>
<div class="line">    CHKERRQ(<a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Reade parameters from line command</span></div>
<div class="line">    <span class="keywordflow">if</span> (flg_file != PETSC_TRUE) {</div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a id="a15" name="a15"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a>,</div>
<div class="line">              <span class="stringliteral">&quot;*** ERROR -my_file (MESH FILE NEEDED)&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a id="a16" name="a16"></a><a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (pcomm == NULL)</div>
<div class="line">      pcomm = <span class="keyword">new</span> ParallelComm(&amp;moab, PETSC_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Read mesh to MOAB</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *option;</div>
<div class="line">    option = <span class="stringliteral">&quot;PARALLEL=READ_PART;&quot;</span></div>
<div class="line">             <span class="stringliteral">&quot;PARALLEL_RESOLVE_SHARED_ENTS;&quot;</span></div>
<div class="line">             <span class="stringliteral">&quot;PARTITION=PARALLEL_PARTITION;&quot;</span>;</div>
<div class="line">    <span class="comment">// option = &quot;&quot;;</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.load_file(<a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 0, option);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create MoFEM (Joseph) database</span></div>
<div class="line">    <a id="_a17" name="_a17"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::Core</a> core(moab);</div>
<div class="line">    <a id="_a18" name="_a18"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = core;</div>
<div class="line"> </div>
<div class="line">    <a id="_a19" name="_a19"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a> *mmanager_ptr;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a20" name="a20"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a525e4d5a451a5bb8c5437d0dd2588de6">query_interface</a>(mmanager_ptr);</div>
<div class="line">    <span class="comment">// print bcs</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mmanager_ptr-&gt;<a id="a21" name="a21"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_meshsets_manager.html#afa62a3609656736c776e8ad075d36b0c">printDisplacementSet</a>();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mmanager_ptr-&gt;<a id="a22" name="a22"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_meshsets_manager.html#a0c4584c8c203e2f36d12ac01dd157661">printForceSet</a>();</div>
<div class="line">    <span class="comment">// print block sets with materials</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mmanager_ptr-&gt;<a id="a23" name="a23"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_meshsets_manager.html#a885fdd41538fbaa6087914c83e3abbf3">printMaterialsSet</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// stl::bitset see for more details</span></div>
<div class="line">    BitRefLevel bit_level0;</div>
<div class="line">    bit_level0.set(0);</div>
<div class="line">    {</div>
<div class="line">      <a id="_a24" name="_a24"></a><a class="code hl_class" href="class_range.html">Range</a> ents3d;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_dimension(0, 3, ents3d);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a25" name="a25"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a99746b844704e78167482954bb5e52b0">seed_ref_level</a>(ents3d, bit_level0, <span class="keyword">false</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set app. order</span></div>
<div class="line"> </div>
<div class="line">    std::vector&lt;Range&gt; setOrderToEnts(10);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// configure blocks by parsing config file</span></div>
<div class="line">    <span class="comment">// it allow to set approximation order for each block independently</span></div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> set_order_ents;</div>
<div class="line">    std::map&lt;int, BlockOptionData&gt; block_data;</div>
<div class="line">    <span class="keywordflow">if</span> (flg_block_config) {</div>
<div class="line">      <span class="keywordtype">double</span> read_eps_u, read_eps_rho, read_eps_l;</div>
<div class="line">      <span class="keywordflow">try</span> {</div>
<div class="line">        ifstream ini_file(block_config_file);</div>
<div class="line">        <span class="keywordflow">if</span> (!ini_file.is_open()) {</div>
<div class="line">          SETERRQ(PETSC_COMM_SELF, 1,</div>
<div class="line">                  <span class="stringliteral">&quot;*** -my_block_config does not exist ***&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// std::cerr &lt;&lt; block_config_file &lt;&lt; std::endl;</span></div>
<div class="line">        po::variables_map vm;</div>
<div class="line">        po::options_description config_file_options;</div>
<div class="line">        config_file_options.add_options()(</div>
<div class="line">            <span class="stringliteral">&quot;eps_u&quot;</span>, po::value&lt;double&gt;(&amp;read_eps_u)-&gt;default_value(-1))(</div>
<div class="line">            <span class="stringliteral">&quot;eps_rho&quot;</span>, po::value&lt;double&gt;(&amp;read_eps_rho)-&gt;default_value(-1))(</div>
<div class="line">            <span class="stringliteral">&quot;eps_l&quot;</span>, po::value&lt;double&gt;(&amp;read_eps_l)-&gt;default_value(-1));</div>
<div class="line">        <span class="keywordflow">for</span> (<a id="a26" name="a26"></a><a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(m_field, <a id="a27" name="a27"></a><a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, it)) {</div>
<div class="line">          std::ostringstream str_order;</div>
<div class="line">          str_order &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; it-&gt;getMeshsetId() &lt;&lt; <span class="stringliteral">&quot;.displacement_order&quot;</span>;</div>
<div class="line">          config_file_options.add_options()(</div>
<div class="line">              str_order.str().c_str(),</div>
<div class="line">              po::value&lt;int&gt;(&amp;block_data[it-&gt;getMeshsetId()].oRder)</div>
<div class="line">                  -&gt;default_value(<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>));</div>
<div class="line">          std::ostringstream str_cond;</div>
<div class="line">          str_cond &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; it-&gt;getMeshsetId() &lt;&lt; <span class="stringliteral">&quot;.young_modulus&quot;</span>;</div>
<div class="line">          config_file_options.add_options()(</div>
<div class="line">              str_cond.str().c_str(),</div>
<div class="line">              po::value&lt;double&gt;(&amp;block_data[it-&gt;getMeshsetId()].yOung)</div>
<div class="line">                  -&gt;default_value(-1));</div>
<div class="line">          std::ostringstream str_capa;</div>
<div class="line">          str_capa &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; it-&gt;getMeshsetId() &lt;&lt; <span class="stringliteral">&quot;.poisson_ratio&quot;</span>;</div>
<div class="line">          config_file_options.add_options()(</div>
<div class="line">              str_capa.str().c_str(),</div>
<div class="line">              po::value&lt;double&gt;(&amp;block_data[it-&gt;getMeshsetId()].pOisson)</div>
<div class="line">                  -&gt;default_value(-2));</div>
<div class="line">        }</div>
<div class="line">        po::parsed_options parsed =</div>
<div class="line">            parse_config_file(ini_file, config_file_options, <span class="keyword">true</span>);</div>
<div class="line">        store(parsed, vm);</div>
<div class="line">        po::notify(vm);</div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(m_field, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, it)) {</div>
<div class="line">          <span class="keywordflow">if</span> (block_data[it-&gt;getMeshsetId()].oRder == -1)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">          <span class="keywordflow">if</span> (block_data[it-&gt;getMeshsetId()].oRder == <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">          PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Set block %d order to %d\n&quot;</span>,</div>
<div class="line">                      it-&gt;getMeshsetId(), block_data[it-&gt;getMeshsetId()].oRder);</div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> block_ents;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_handle(it-&gt;getMeshset(), block_ents,</div>
<div class="line">                                             <span class="keyword">true</span>);</div>
<div class="line">          <span class="comment">// block_ents = block_ents.subset_by_type(MBTET);</span></div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> nodes;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(block_ents, nodes, <span class="keyword">true</span>);</div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> ents_to_set_order, ents3d;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(nodes, 3, <span class="keyword">false</span>, ents3d,</div>
<div class="line">                                      moab::Interface::UNION);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents3d, 2, <span class="keyword">false</span>, ents_to_set_order,</div>
<div class="line">                                      moab::Interface::UNION);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents3d, 1, <span class="keyword">false</span>, ents_to_set_order,</div>
<div class="line">                                      moab::Interface::UNION);</div>
<div class="line">          ents_to_set_order = subtract(</div>
<div class="line">              ents_to_set_order, ents_to_set_order.subset_by_type(MBQUAD));</div>
<div class="line">          ents_to_set_order = subtract(</div>
<div class="line">              ents_to_set_order, ents_to_set_order.subset_by_type(MBPRISM));</div>
<div class="line">          set_order_ents.merge(ents3d);</div>
<div class="line">          set_order_ents.merge(ents_to_set_order);</div>
<div class="line">          setOrderToEnts[block_data[it-&gt;getMeshsetId()].oRder].merge(</div>
<div class="line">              set_order_ents);</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a28" name="a28"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a4ff0811a785a91df31f0aeed637a34d8">synchronise_entities</a>(set_order_ents, 0);</div>
<div class="line">        std::vector&lt;std::string&gt; additional_parameters;</div>
<div class="line">        additional_parameters =</div>
<div class="line">            collect_unrecognized(parsed.options, po::include_positional);</div>
<div class="line">        <span class="keywordflow">for</span> (std::vector&lt;std::string&gt;::iterator vit =</div>
<div class="line">                 additional_parameters.begin();</div>
<div class="line">             vit != additional_parameters.end(); vit++) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                             <span class="stringliteral">&quot;** WARNING Unrecognized option %s\n&quot;</span>,</div>
<div class="line">                             vit-&gt;c_str());</div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;ex) {</div>
<div class="line">        std::ostringstream ss;</div>
<div class="line">        ss &lt;&lt; ex.what() &lt;&lt; std::endl;</div>
<div class="line">        SETERRQ(PETSC_COMM_SELF, <a id="a29" name="a29"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec">MOFEM_STD_EXCEPTION_THROW</a>, ss.str().c_str());</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (read_eps_u &gt; 0) {</div>
<div class="line">        eps_u = read_eps_u;</div>
<div class="line">      };</div>
<div class="line">      <span class="keywordflow">if</span> (read_eps_rho &gt; 0) {</div>
<div class="line">        eps_rho = read_eps_rho;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (read_eps_l &gt; 0) {</div>
<div class="line">        eps_l = read_eps_l;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;epsU = %6.4e epsRho = %6.4e\n&quot;</span>, eps_u,</div>
<div class="line">                eps_rho);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Fields</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a30" name="a30"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;U&quot;</span>, <a id="a31" name="a31"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a id="a32" name="a32"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 3, MB_TAG_SPARSE,</div>
<div class="line">                             <a id="a33" name="a33"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;UPSILON&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 3,</div>
<div class="line">                             MB_TAG_SPARSE, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (is_curl) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;RHO&quot;</span>, <a id="a34" name="a34"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12aa30e505d5df1a8d715b9d175cd97ae82">HCURL</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;RHO&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// add entitities (by tets) to the field</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a35" name="a35"></a><a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(0, MBTET, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(0, MBTET, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(0, MBPRISM, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(0, MBPRISM, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a36" name="a36"></a><a class="code hl_function" href="group__mofem__field.html#ga43572d534c72c5561b94ab6f7f3ddfbb">synchronise_field_entities</a>(<span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga43572d534c72c5561b94ab6f7f3ddfbb">synchronise_field_entities</a>(<span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga43572d534c72c5561b94ab6f7f3ddfbb">synchronise_field_entities</a>(<span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> vertex_to_fix;</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> edges_to_fix;</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> ents_1st_layer;</div>
<div class="line">    <span class="comment">// If problem is partitioned meshset culd not exist on this part</span></div>
<div class="line">    <span class="keywordflow">if</span> (mmanager_ptr-&gt;<a id="a37" name="a37"></a><a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(202, <a id="a38" name="a38"></a><a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mmanager_ptr-&gt;<a id="a39" name="a39"></a><a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(202, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 2,</div>
<div class="line">                                                  ents_1st_layer, <span class="keyword">true</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mmanager_ptr-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(202, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 0,</div>
<div class="line">                                                  vertex_to_fix, <span class="keyword">false</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mmanager_ptr-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(202, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 1, edges_to_fix,</div>
<div class="line">                                                  <span class="keyword">false</span>);</div>
<div class="line">      <span class="keywordflow">if</span> (vertex_to_fix.size() != 1 &amp;&amp; !vertex_to_fix.empty()) {</div>
<div class="line">        SETERRQ1(PETSC_COMM_WORLD, <a id="a40" name="a40"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                 <span class="stringliteral">&quot;Should be one vertex only, but is %d&quot;</span>, vertex_to_fix.size());</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a4ff0811a785a91df31f0aeed637a34d8">synchronise_entities</a>(ents_1st_layer, 0);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(</div>
<div class="line">        ents_1st_layer.subset_by_type(MBTRI), MBTRI, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> ents_2nd_layer;</div>
<div class="line">    <span class="comment">// If problem is partitioned meshset culd not exist on this part</span></div>
<div class="line">    <span class="keywordflow">if</span> (mmanager_ptr-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(101, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mmanager_ptr-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(101, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 2,</div>
<div class="line">                                                  ents_2nd_layer, <span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a4ff0811a785a91df31f0aeed637a34d8">synchronise_entities</a>(ents_2nd_layer, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> oo = 2; oo != setOrderToEnts.size(); oo++) {</div>
<div class="line">      <span class="keywordflow">if</span> (setOrderToEnts[oo].size() &gt; 0) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a4ff0811a785a91df31f0aeed637a34d8">synchronise_entities</a>(setOrderToEnts[oo], 0);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a41" name="a41"></a><a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(setOrderToEnts[oo], <span class="stringliteral">&quot;U&quot;</span>, oo);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(setOrderToEnts[oo], <span class="stringliteral">&quot;UPSILON&quot;</span>, oo);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> through_thickness_order = 2;</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> ents3d;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_dimension(0, 3, ents3d);</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents3d, 2, <span class="keyword">false</span>, ents,</div>
<div class="line">                                  moab::Interface::UNION);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents3d, 1, <span class="keyword">false</span>, ents,</div>
<div class="line">                                  moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> prisms;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(0, MBPRISM, prisms);</div>
<div class="line">      {</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> quads;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(prisms, 2, <span class="keyword">false</span>, quads,</div>
<div class="line">                                    moab::Interface::UNION);</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> prism_tris;</div>
<div class="line">        prism_tris = quads.subset_by_type(MBTRI);</div>
<div class="line">        quads = subtract(quads, prism_tris);</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> quads_edges;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(quads, 1, <span class="keyword">false</span>, quads_edges,</div>
<div class="line">                                    moab::Interface::UNION);</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> prism_tris_edges;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(prism_tris, 1, <span class="keyword">false</span>, prism_tris_edges,</div>
<div class="line">                                    moab::Interface::UNION);</div>
<div class="line">        quads_edges = subtract(quads_edges, prism_tris_edges);</div>
<div class="line">        prisms.merge(quads);</div>
<div class="line">        prisms.merge(quads_edges);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      ents.merge(ents3d);</div>
<div class="line">      ents = subtract(ents, set_order_ents);</div>
<div class="line">      ents = subtract(ents, prisms);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a4ff0811a785a91df31f0aeed637a34d8">synchronise_entities</a>(ents, 0);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a4ff0811a785a91df31f0aeed637a34d8">synchronise_entities</a>(prisms, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(ents, <span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(ents, <span class="stringliteral">&quot;UPSILON&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">      <span class="comment">// approx. order through thickness to 2</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(prisms, <span class="stringliteral">&quot;U&quot;</span>, through_thickness_order);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(prisms, <span class="stringliteral">&quot;UPSILON&quot;</span>,</div>
<div class="line">                                     through_thickness_order);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;U&quot;</span>, 1);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;UPSILON&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (is_curl) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTRI, <span class="stringliteral">&quot;RHO&quot;</span>, order_force);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBEDGE, <span class="stringliteral">&quot;RHO&quot;</span>, order_force);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTRI, <span class="stringliteral">&quot;RHO&quot;</span>, order_force);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBEDGE, <span class="stringliteral">&quot;RHO&quot;</span>, order_force);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;RHO&quot;</span>, 1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add elastic element</span></div>
<div class="line">    boost::shared_ptr&lt;Hooke&lt;adouble&gt;&gt; hooke_adouble_ptr(<span class="keyword">new</span> <a id="_a42" name="_a42"></a><a class="code hl_struct" href="struct_hooke.html">Hooke&lt;adouble&gt;</a>());</div>
<div class="line">    boost::shared_ptr&lt;Hooke&lt;double&gt;&gt; hooke_double_ptr(<span class="keyword">new</span> <a class="code hl_struct" href="struct_hooke.html">Hooke&lt;double&gt;</a>());</div>
<div class="line">    <a id="_a43" name="_a43"></a><a class="code hl_struct" href="struct_nonlinear_elastic_element.html">NonlinearElasticElement</a> elastic(m_field, 2);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> elastic.setBlocks(hooke_double_ptr, hooke_adouble_ptr);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> elastic.addElement(<span class="stringliteral">&quot;ELASTIC&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> elastic.setOperators(<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">    <span class="comment">// Add prisms</span></div>
<div class="line">    <a id="_a44" name="_a44"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_fat_prism.html">CellEngineering::FatPrism</a> fat_prism_rhs(m_field);</div>
<div class="line">    <a class="code hl_struct" href="struct_cell_engineering_1_1_fat_prism.html">CellEngineering::FatPrism</a> fat_prism_lhs(m_field);</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a45" name="a45"></a><a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;ELASTIC_PRISM&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a46" name="a46"></a><a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;ELASTIC_PRISM&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a47" name="a47"></a><a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;ELASTIC_PRISM&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a48" name="a48"></a><a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;ELASTIC_PRISM&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> ents_2nd_layer;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mmanager_ptr-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(2, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 3,</div>
<div class="line">                                                  elastic.setOfBlocks[2].tEts);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a49" name="a49"></a><a class="code hl_function" href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">add_ents_to_finite_element_by_type</a>(</div>
<div class="line">          elastic.setOfBlocks[2].tEts, MBPRISM, <span class="stringliteral">&quot;ELASTIC_PRISM&quot;</span>);</div>
<div class="line">      MatrixDouble inv_jac;</div>
<div class="line">      <span class="comment">// right hand side operators</span></div>
<div class="line">      fat_prism_rhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a50" name="_a50"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism.html">MoFEM::OpCalculateInvJacForFatPrism</a>(inv_jac));</div>
<div class="line">      fat_prism_rhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a51" name="_a51"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism.html">MoFEM::OpSetInvJacH1ForFatPrism</a>(inv_jac));</div>
<div class="line">      fat_prism_rhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a52" name="_a52"></a><a class="code hl_struct" href="struct_nonlinear_elastic_element_1_1_op_get_common_data_at_gauss_pts.html">NonlinearElasticElement::OpGetCommonDataAtGaussPts</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, elastic.commonData));</div>
<div class="line">      fat_prism_rhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a53" name="_a53"></a><a class="code hl_struct" href="struct_nonlinear_elastic_element_1_1_op_jacobian_piola_kirchhoff_stress.html">NonlinearElasticElement::OpJacobianPiolaKirchhoffStress</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, elastic.setOfBlocks[2], elastic.commonData, 2, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line">              <span class="keyword">true</span>));</div>
<div class="line">      fat_prism_rhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a54" name="_a54"></a><a class="code hl_struct" href="struct_nonlinear_elastic_element_1_1_op_rhs_piola_kirchhoff.html">NonlinearElasticElement::OpRhsPiolaKirchhoff</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, elastic.setOfBlocks[2], elastic.commonData));</div>
<div class="line">      <span class="comment">// Left hand side operators</span></div>
<div class="line">      fat_prism_lhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism.html">MoFEM::OpCalculateInvJacForFatPrism</a>(inv_jac));</div>
<div class="line">      fat_prism_lhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism.html">MoFEM::OpSetInvJacH1ForFatPrism</a>(inv_jac));</div>
<div class="line">      fat_prism_lhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_nonlinear_elastic_element_1_1_op_get_common_data_at_gauss_pts.html">NonlinearElasticElement::OpGetCommonDataAtGaussPts</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, elastic.commonData));</div>
<div class="line">      fat_prism_lhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_nonlinear_elastic_element_1_1_op_jacobian_piola_kirchhoff_stress.html">NonlinearElasticElement::OpJacobianPiolaKirchhoffStress</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, elastic.setOfBlocks[2], elastic.commonData, 2, <span class="keyword">true</span>, <span class="keyword">false</span>,</div>
<div class="line">              <span class="keyword">true</span>));</div>
<div class="line">      fat_prism_lhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a55" name="_a55"></a><a class="code hl_struct" href="struct_nonlinear_elastic_element_1_1_op_lhs_piola_kirchhoff__dx.html">NonlinearElasticElement::OpLhsPiolaKirchhoff_dx</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, elastic.setOfBlocks[2], elastic.commonData));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Update material parameters</span></div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(m_field, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, it)) {</div>
<div class="line">      <span class="keywordtype">int</span> <span class="keywordtype">id</span> = it-&gt;getMeshsetId();</div>
<div class="line">      <span class="keywordflow">if</span> (block_data[<span class="keywordtype">id</span>].yOung &gt; 0) {</div>
<div class="line">        elastic.setOfBlocks[id].E = block_data[id].yOung;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                           <span class="stringliteral">&quot;Block %d set Young modulus %3.4g\n&quot;</span>, <span class="keywordtype">id</span>,</div>
<div class="line">                           elastic.setOfBlocks[<span class="keywordtype">id</span>].E);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (block_data[<span class="keywordtype">id</span>].pOisson &gt;= -1) {</div>
<div class="line">        elastic.setOfBlocks[id].PoissonRatio = block_data[id].pOisson;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                           <span class="stringliteral">&quot;Block %d set Poisson ratio %3.4g\n&quot;</span>, <span class="keywordtype">id</span>,</div>
<div class="line">                           elastic.setOfBlocks[<span class="keywordtype">id</span>].PoissonRatio);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// build field</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a56" name="a56"></a><a class="code hl_function" href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">build_fields</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Control elements</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;KUPSUPS&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;KUPSUPS&quot;</span>, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;KUPSUPS&quot;</span>, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;KUPSUPS&quot;</span>, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">add_ents_to_finite_element_by_type</a>(0, MBTET, <span class="stringliteral">&quot;KUPSUPS&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">add_ents_to_finite_element_by_type</a>(0, MBPRISM, <span class="stringliteral">&quot;KUPSUPS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>,</div>
<div class="line">                                                       <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>,</div>
<div class="line">                                                       <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>,</div>
<div class="line">                                                        <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>,</div>
<div class="line">                                                        <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>,</div>
<div class="line">                                                        <span class="stringliteral">&quot;DISP_X&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>,</div>
<div class="line">                                                        <span class="stringliteral">&quot;DISP_Y&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">add_ents_to_finite_element_by_type</a>(ents_2nd_layer, MBTRI,</div>
<div class="line">                                                      <span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add element to calculate residual on 1st layer</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;BT&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;BT&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;BT&quot;</span>, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;BT&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;BT&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;BT&quot;</span>, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;BT&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">add_ents_to_finite_element_by_type</a>(ents_1st_layer, MBTRI,</div>
<div class="line">                                                      <span class="stringliteral">&quot;BT&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;B&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">add_ents_to_finite_element_by_type</a>(ents_1st_layer, MBTRI,</div>
<div class="line">                                                      <span class="stringliteral">&quot;B&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add element to calculate residual on 1st layer</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;D&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;D&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;D&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;D&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">add_ents_to_finite_element_by_type</a>(ents_1st_layer, MBTRI,</div>
<div class="line">                                                      <span class="stringliteral">&quot;D&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// build finite elemnts</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a57" name="a57"></a><a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>();</div>
<div class="line">    <span class="comment">// build adjacencies</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a58" name="a58"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a727653d1367e758daf2a74cb65d4dfa5">build_adjacencies</a>(bit_level0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Register MOFEM DM</span></div>
<div class="line">    DMType dm_name = <span class="stringliteral">&quot;MOFEM&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(dm_name);</div>
<div class="line"> </div>
<div class="line">    DM dm_control;</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// Craete dm_control instance</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;dm_control);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(dm_control, dm_name);</div>
<div class="line">      <span class="comment">// set dm_control data structure which created mofem datastructures</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(dm_control, &amp;m_field, <span class="stringliteral">&quot;CONTROL_PROB&quot;</span>,</div>
<div class="line">                                bit_level0);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetFromOptions(dm_control);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(dm_control, PETSC_TRUE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(dm_control, PETSC_TRUE);</div>
<div class="line">      <span class="comment">// add elements to dm_control</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_control, <span class="stringliteral">&quot;ELASTIC&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_control, <span class="stringliteral">&quot;ELASTIC_PRISM&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_control, <span class="stringliteral">&quot;KUPSUPS&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_control, <span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_control, <span class="stringliteral">&quot;B&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_control, <span class="stringliteral">&quot;BT&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_control, <span class="stringliteral">&quot;D&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dm_control);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    MatrixDouble inv_jac;</div>
<div class="line">    <a id="_a59" name="_a59"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_common_data.html">CellEngineering::CommonData</a> common_data;</div>
<div class="line"> </div>
<div class="line">    ublas::matrix&lt;Mat&gt; nested_matrices(2, 2);</div>
<div class="line">    ublas::vector&lt;IS&gt; nested_is_rows(2);</div>
<div class="line">    ublas::vector&lt;IS&gt; nested_is_cols(2);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a id="a60" name="a60"></a><a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != 2; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>++) {</div>
<div class="line">      nested_is_rows[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] = PETSC_NULL;</div>
<div class="line">      nested_is_cols[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] = PETSC_NULL;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a id="a61" name="a61"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a> = 0; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a> != 2; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>++) {</div>
<div class="line">        nested_matrices(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = PETSC_NULL;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ublas::matrix&lt;Mat&gt; sub_nested_matrices(2, 2);</div>
<div class="line">    ublas::vector&lt;IS&gt; sub_nested_is_rows(2);</div>
<div class="line">    ublas::vector&lt;IS&gt; sub_nested_is_cols(2);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != 2; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>++) {</div>
<div class="line">      sub_nested_is_rows[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] = PETSC_NULL;</div>
<div class="line">      sub_nested_is_cols[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] = PETSC_NULL;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a> = 0; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a> != 2; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>++) {</div>
<div class="line">        sub_nested_matrices(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = PETSC_NULL;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    DM dm_sub_volume_control;</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;dm_sub_volume_control);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(dm_sub_volume_control, dm_name);</div>
<div class="line">      <span class="comment">// set dm_sub_volume_control data structure which created mofem data</span></div>
<div class="line">      <span class="comment">// structures</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(dm_sub_volume_control, dm_control,</div>
<div class="line">                                <span class="stringliteral">&quot;SUB_CONTROL_PROB&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(dm_sub_volume_control, PETSC_TRUE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dm_sub_volume_control, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dm_sub_volume_control, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">DMMoFEMAddSubFieldCol</a>(dm_sub_volume_control, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">DMMoFEMAddSubFieldCol</a>(dm_sub_volume_control, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">      <span class="comment">// add elements to dm_sub_volume_control</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dm_sub_volume_control);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <a id="_a62" name="_a62"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_problem.html">Problem</a> *prb_ptr;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a63" name="a63"></a><a class="code hl_function" href="group__mofem__access.html#ga311e33eaba451897a151813e8ea6fae4">get_problem</a>(<span class="stringliteral">&quot;SUB_CONTROL_PROB&quot;</span>, &amp;prb_ptr);</div>
<div class="line">      boost::shared_ptr&lt;Problem::SubProblemData&gt; sub_data =</div>
<div class="line">          prb_ptr-&gt;<a id="a64" name="a64"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#a526cf0dbf74a82cbd2db0e8c64309755">getSubData</a>();</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sub_data-&gt;getRowIs(&amp;nested_is_rows[0]);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sub_data-&gt;getColIs(&amp;nested_is_cols[0]);</div>
<div class="line">      <span class="comment">// That will be filled at the end</span></div>
<div class="line">      nested_matrices(0, 0) = PETSC_NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      DM dm_sub_sub_elastic;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;dm_sub_sub_elastic);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(dm_sub_sub_elastic, dm_name);</div>
<div class="line">      <span class="comment">// set dm_sub_sub_elastic data structure which created mofem data</span></div>
<div class="line">      <span class="comment">// structures</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(dm_sub_sub_elastic, dm_sub_volume_control,</div>
<div class="line">                                <span class="stringliteral">&quot;ELASTIC_PROB&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(dm_sub_sub_elastic, PETSC_TRUE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_sub_sub_elastic, <span class="stringliteral">&quot;ELASTIC&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_sub_sub_elastic, <span class="stringliteral">&quot;ELASTIC_PRISM&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dm_sub_sub_elastic, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">DMMoFEMAddSubFieldCol</a>(dm_sub_sub_elastic, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <span class="comment">// add elements to dm_sub_sub_elastic</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dm_sub_sub_elastic);</div>
<div class="line"> </div>
<div class="line">      Mat Kuu;</div>
<div class="line">      Vec Du, Fu;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateMatrix(dm_sub_sub_elastic, &amp;Kuu);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateGlobalVector(dm_sub_sub_elastic, &amp;Du);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateGlobalVector(dm_sub_sub_elastic, &amp;Fu);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(Kuu);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(Du);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(Fu);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dm_sub_sub_elastic, Du, INSERT_VALUES,</div>
<div class="line">                                     SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Manage  Dirichlet bC</span></div>
<div class="line">      boost::shared_ptr&lt;FEMethod&gt; dirihlet_bc_ptr;</div>
<div class="line">      dirihlet_bc_ptr = boost::shared_ptr&lt;FEMethod&gt;(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a65" name="_a65"></a><a class="code hl_struct" href="struct_dirichlet_displacement_bc.html">DirichletDisplacementBc</a>(m_field, <span class="stringliteral">&quot;U&quot;</span>, Kuu, Du, Fu));</div>
<div class="line">      dirihlet_bc_ptr-&gt;snes_ctx = FEMethod::CTX_SNESNONE;</div>
<div class="line">      dirihlet_bc_ptr-&gt;ts_ctx = FEMethod::CTX_TSNONE;</div>
<div class="line">      <span class="comment">// preproc</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">DMoFEMPreProcessFiniteElements</a>(dm_sub_sub_elastic,</div>
<div class="line">                                            dirihlet_bc_ptr.get());</div>
<div class="line">      <span class="comment">// internal force vector (to take into account  Dirichlet boundary</span></div>
<div class="line">      <span class="comment">// conditions)</span></div>
<div class="line">      elastic.getLoopFeRhs().snes_f = Fu;</div>
<div class="line">      fat_prism_rhs.snes_f = Fu;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_sub_sub_elastic, <span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line">                                      &amp;elastic.getLoopFeRhs());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_sub_sub_elastic, <span class="stringliteral">&quot;ELASTIC_PRISM&quot;</span>,</div>
<div class="line">                                      &amp;fat_prism_rhs);</div>
<div class="line">      <span class="comment">// elastic element matrix</span></div>
<div class="line">      elastic.getLoopFeLhs().snes_B = Kuu;</div>
<div class="line">      fat_prism_lhs.snes_B = Kuu;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_sub_sub_elastic, <span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line">                                      &amp;elastic.getLoopFeLhs());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_sub_sub_elastic, <span class="stringliteral">&quot;ELASTIC_PRISM&quot;</span>,</div>
<div class="line">                                      &amp;fat_prism_lhs);</div>
<div class="line">      <span class="comment">// postproc</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">DMoFEMPostProcessFiniteElements</a>(dm_sub_sub_elastic,</div>
<div class="line">                                             dirihlet_bc_ptr.get());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(Fu, ADD_VALUES, SCATTER_REVERSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(Fu, ADD_VALUES, SCATTER_REVERSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(Fu);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(Fu);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScale(Fu, -1);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;Du);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;Fu);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_problem.html">Problem</a> *prb_ptr;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__access.html#ga311e33eaba451897a151813e8ea6fae4">get_problem</a>(<span class="stringliteral">&quot;ELASTIC_PROB&quot;</span>, &amp;prb_ptr);</div>
<div class="line">      boost::shared_ptr&lt;Problem::SubProblemData&gt; sub_data =</div>
<div class="line">          prb_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#a526cf0dbf74a82cbd2db0e8c64309755">getSubData</a>();</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sub_data-&gt;getRowIs(&amp;sub_nested_is_rows[0]);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sub_data-&gt;getColIs(&amp;sub_nested_is_cols[0]);</div>
<div class="line">      sub_nested_matrices(0, 0) = Kuu;</div>
<div class="line">      IS isUpsilon;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a525e4d5a451a5bb8c5437d0dd2588de6">query_interface</a>&lt;<a id="_a66" name="_a66"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()</div>
<div class="line">          -&gt;isCreateFromProblemFieldToOtherProblemField(</div>
<div class="line">              <span class="stringliteral">&quot;ELASTIC_PROB&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, <a id="a67" name="a67"></a><a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <span class="stringliteral">&quot;SUB_CONTROL_PROB&quot;</span>, <span class="stringliteral">&quot;UPSILON&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>,</div>
<div class="line">              PETSC_NULL, &amp;isUpsilon);</div>
<div class="line">      sub_nested_is_rows[1] = isUpsilon;</div>
<div class="line">      sub_nested_is_cols[1] = isUpsilon;</div>
<div class="line">      sub_nested_matrices(1, 1) = Kuu;</div>
<div class="line">      PetscObjectReference((PetscObject)Kuu);</div>
<div class="line">      PetscObjectReference((PetscObject)isUpsilon);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Matrix View</span></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">        cerr &lt;&lt; <span class="stringliteral">&quot;Kuu&quot;</span> &lt;&lt; endl;</div>
<div class="line">        MatView(Kuu, PETSC_VIEWER_DRAW_WORLD);</div>
<div class="line">        std::string wait;</div>
<div class="line">        std::cin &gt;&gt; wait;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;dm_sub_sub_elastic);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      DM dm_sub_disp_penalty;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Craete dm_control instance</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;dm_sub_disp_penalty);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(dm_sub_disp_penalty, dm_name);</div>
<div class="line">      <span class="comment">// set dm_sub_disp_penalty data structure which created mofem</span></div>
<div class="line">      <span class="comment">// datastructures</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(dm_sub_disp_penalty, dm_sub_volume_control,</div>
<div class="line">                                <span class="stringliteral">&quot;S_PROB&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(dm_sub_disp_penalty, PETSC_FALSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dm_sub_disp_penalty, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">DMMoFEMAddSubFieldCol</a>(dm_sub_disp_penalty, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <span class="comment">// add elements to dm_sub_disp_penalty</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_sub_disp_penalty, <span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dm_sub_disp_penalty);</div>
<div class="line"> </div>
<div class="line">      Mat S;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateMatrix(dm_sub_disp_penalty, &amp;S);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(S);</div>
<div class="line"> </div>
<div class="line">      <a id="_a68" name="_a68"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_face_element.html">CellEngineering::FaceElement</a> face_element(m_field);</div>
<div class="line">      face_element.getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a69" name="_a69"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_op_cell_s.html">OpCellS</a>(S, eps_u));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_sub_disp_penalty,</div>
<div class="line">                                      <span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>, &amp;face_element);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(S, MAT_FLUSH_ASSEMBLY);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(S, MAT_FLUSH_ASSEMBLY);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// // Matrix View</span></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">        cerr &lt;&lt; <span class="stringliteral">&quot;S&quot;</span> &lt;&lt; endl;</div>
<div class="line">        MatView(S, PETSC_VIEWER_DRAW_WORLD);</div>
<div class="line">        std::string wait;</div>
<div class="line">        std::cin &gt;&gt; wait;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_problem.html">Problem</a> *problem_ptr;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__access.html#ga311e33eaba451897a151813e8ea6fae4">get_problem</a>(<span class="stringliteral">&quot;S_PROB&quot;</span>, &amp;problem_ptr);</div>
<div class="line">      boost::shared_ptr&lt;Problem::SubProblemData&gt; sub_data =</div>
<div class="line">          problem_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#a526cf0dbf74a82cbd2db0e8c64309755">getSubData</a>();</div>
<div class="line">      <span class="comment">// CHKERR sub_data-&gt;getRowIs(&amp;sub_nested_is_rows[1]);</span></div>
<div class="line">      <span class="comment">// CHKERR sub_data-&gt;getColIs(&amp;sub_nested_is_cols[0]);</span></div>
<div class="line">      sub_nested_matrices(1, 0) = S;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;dm_sub_disp_penalty);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Calculate penalty matrix</span></div>
<div class="line">    {</div>
<div class="line">      DM dm_sub_force_penalty;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Craete dm_control instance</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;dm_sub_force_penalty);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(dm_sub_force_penalty, dm_name);</div>
<div class="line">      <span class="comment">// set dm_sub_force_penalty data structure which created mofem</span></div>
<div class="line">      <span class="comment">// datastructures</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(dm_sub_force_penalty, dm_control, <span class="stringliteral">&quot;D_PROB&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(dm_sub_force_penalty, PETSC_TRUE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dm_sub_force_penalty, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">DMMoFEMAddSubFieldCol</a>(dm_sub_force_penalty, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">      <span class="comment">// add elements to dm_sub_force_penalty</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_sub_force_penalty, <span class="stringliteral">&quot;D&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dm_sub_force_penalty);</div>
<div class="line"> </div>
<div class="line">      Mat <a id="a70" name="a70"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateMatrix(dm_sub_force_penalty, &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line"> </div>
<div class="line">      {</div>
<div class="line">        <a class="code hl_struct" href="struct_cell_engineering_1_1_face_element.html">CellEngineering::FaceElement</a> face_d_matrix(m_field);</div>
<div class="line">        face_d_matrix.getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> OpCalculateInvJacForFace(inv_jac));</div>
<div class="line">        <span class="keywordflow">if</span> (is_curl) {</div>
<div class="line">          face_d_matrix.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a id="_a71" name="_a71"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_hcurl_face_impl_3_012_01_4.html">OpSetInvJacHcurlFace</a>(inv_jac));</div>
<div class="line">          face_d_matrix.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a id="_a72" name="_a72"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_op_cell_curl_d.html">OpCellCurlD</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, eps_rho / eps_u, eps_l * eps_u));</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          face_d_matrix.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a id="_a73" name="_a73"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">OpSetInvJacH1ForFace</a>(inv_jac));</div>
<div class="line">          face_d_matrix.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a id="_a74" name="_a74"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_op_cell_potential_d.html">OpCellPotentialD</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, eps_rho / eps_u));</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_sub_force_penalty, <span class="stringliteral">&quot;D&quot;</span>,</div>
<div class="line">                                        &amp;face_d_matrix);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_problem.html">Problem</a> *problem_ptr;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__access.html#ga311e33eaba451897a151813e8ea6fae4">get_problem</a>(<span class="stringliteral">&quot;D_PROB&quot;</span>, &amp;problem_ptr);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Zero rows, force field is given by gradients of potential field, so one</span></div>
<div class="line">      <span class="comment">// of the values has to be fixed like for rigid body motion.</span></div>
<div class="line">      <span class="keywordflow">if</span> (is_curl == PETSC_FALSE) {</div>
<div class="line">        <span class="keywordtype">int</span> nb_dofs_to_fix = 0;</div>
<div class="line">        <span class="keywordtype">int</span> index_to_fix = 0;</div>
<div class="line">        <span class="keywordflow">if</span> (!vertex_to_fix.empty()) {</div>
<div class="line">          boost::shared_ptr&lt;NumeredDofEntity&gt; dof_ptr;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> problem_ptr-&gt;<a id="a75" name="a75"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#a403af5acea9a71bf043ff3be4c1c41ef">getDofByNameEntAndEntDofIdx</a>(</div>
<div class="line">              m_field.<a id="a76" name="a76"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a151a5aaa12774c726c7a32ba250d2586">get_field_bit_number</a>(<span class="stringliteral">&quot;RHO&quot;</span>), vertex_to_fix[0], 0, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>,</div>
<div class="line">              dof_ptr);</div>
<div class="line">          <span class="keywordflow">if</span> (dof_ptr) {</div>
<div class="line">            <span class="keywordflow">if</span> (dof_ptr-&gt;getPart() == m_field.<a id="a77" name="a77"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) {</div>
<div class="line">              nb_dofs_to_fix = 1;</div>
<div class="line">              index_to_fix = dof_ptr-&gt;getPetscGlobalDofIdx();</div>
<div class="line">              cerr &lt;&lt; *dof_ptr &lt;&lt; endl;</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroRowsColumns(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, nb_dofs_to_fix, &amp;index_to_fix,</div>
<div class="line">                                  eps_rho / eps_u, PETSC_NULL, PETSC_NULL);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        std::vector&lt;int&gt; dofs_to_fix;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> p_eit = edges_to_fix.pair_begin();</div>
<div class="line">             p_eit != edges_to_fix.pair_end(); ++p_eit) {</div>
<div class="line">          <span class="keyword">auto</span> bit_number = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a151a5aaa12774c726c7a32ba250d2586">get_field_bit_number</a>(<span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">          <span class="keyword">auto</span> row_dofs = problem_ptr-&gt;<a id="a78" name="a78"></a><a class="code hl_variable" href="struct_mo_f_e_m_1_1_problem.html#a54dbffef1909f2e198d0836fa96fa95e">numeredRowDofsPtr</a>;</div>
<div class="line">          <span class="keyword">auto</span> lo = row_dofs-&gt;lower_bound(</div>
<div class="line">              FieldEntity::getLoLocalEntityBitNumber(bit_number, p_eit-&gt;first));</div>
<div class="line">          <span class="keyword">auto</span> hi =</div>
<div class="line">              row_dofs-&gt;lower_bound(FieldEntity::getHiLocalEntityBitNumber(</div>
<div class="line">                  bit_number, p_eit-&gt;second));</div>
<div class="line">          <span class="keywordflow">for</span> (; lo != hi; ++lo)</div>
<div class="line">            dofs_to_fix.push_back((*lo)-&gt;getPetscGlobalDofIdx());</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroRowsColumns(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, dofs_to_fix.size(), &amp;*dofs_to_fix.begin(),</div>
<div class="line">                                  eps_rho / eps_u, PETSC_NULL, PETSC_NULL);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Matrix View</span></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">        cerr &lt;&lt; <span class="stringliteral">&quot;D&quot;</span> &lt;&lt; endl;</div>
<div class="line">        MatView(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, PETSC_VIEWER_DRAW_WORLD);</div>
<div class="line">        std::string wait;</div>
<div class="line">        std::cin &gt;&gt; wait;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      boost::shared_ptr&lt;Problem::SubProblemData&gt; sub_data =</div>
<div class="line">          problem_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#a526cf0dbf74a82cbd2db0e8c64309755">getSubData</a>();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sub_data-&gt;getRowIs(&amp;nested_is_rows[1]);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sub_data-&gt;getColIs(&amp;nested_is_cols[1]);</div>
<div class="line">      nested_matrices(1, 1) = <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;dm_sub_force_penalty);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      DM dm_sub_force;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Craete dm_control instance</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;dm_sub_force);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(dm_sub_force, dm_name);</div>
<div class="line">      <span class="comment">// set dm_sub_force data structure which created mofem data structures</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(dm_sub_force, dm_control, <span class="stringliteral">&quot;FORCES_PROB&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(dm_sub_force, PETSC_FALSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dm_sub_force, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">DMMoFEMAddSubFieldCol</a>(dm_sub_force, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">DMMoFEMAddSubFieldCol</a>(dm_sub_force, <span class="stringliteral">&quot;UPSILON&quot;</span>);</div>
<div class="line">      <span class="comment">// add elements to dm_sub_force</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm_sub_force, <span class="stringliteral">&quot;B&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dm_sub_force);</div>
<div class="line"> </div>
<div class="line">      Mat UB, UPSILONB;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateMatrix(dm_sub_force, &amp;UB);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(UB);</div>
<div class="line">      <span class="comment">// note be will be transposed in place latter on</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateMatrix(dm_sub_force, &amp;UPSILONB);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(UPSILONB);</div>
<div class="line">      {</div>
<div class="line">        <a class="code hl_struct" href="struct_cell_engineering_1_1_face_element.html">CellEngineering::FaceElement</a> face_b_matrices(m_field);</div>
<div class="line">        face_b_matrices.getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> OpCalculateInvJacForFace(inv_jac));</div>
<div class="line">        <span class="keywordflow">if</span> (is_curl) {</div>
<div class="line">          face_b_matrices.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">OpSetInvJacH1ForFace</a>(inv_jac));</div>
<div class="line">          face_b_matrices.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_hcurl_face_impl_3_012_01_4.html">OpSetInvJacHcurlFace</a>(inv_jac));</div>
<div class="line">          face_b_matrices.getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a79" name="_a79"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_op_cell_curl_b.html">OpCellCurlB</a>(UB, <span class="stringliteral">&quot;U&quot;</span>));</div>
<div class="line">          face_b_matrices.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="struct_cell_engineering_1_1_op_cell_curl_b.html">OpCellCurlB</a>(UPSILONB, <span class="stringliteral">&quot;UPSILON&quot;</span>));</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          face_b_matrices.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">OpSetInvJacH1ForFace</a>(inv_jac));</div>
<div class="line">          face_b_matrices.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a id="_a80" name="_a80"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_op_cell_potential_b.html">OpCellPotentialB</a>(UB, <span class="stringliteral">&quot;U&quot;</span>));</div>
<div class="line">          face_b_matrices.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="struct_cell_engineering_1_1_op_cell_potential_b.html">OpCellPotentialB</a>(UPSILONB, <span class="stringliteral">&quot;UPSILON&quot;</span>));</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_sub_force, <span class="stringliteral">&quot;B&quot;</span>, &amp;face_b_matrices);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(UB, MAT_FINAL_ASSEMBLY);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(UPSILONB, MAT_FINAL_ASSEMBLY);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(UB, MAT_FINAL_ASSEMBLY);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(UPSILONB, MAT_FINAL_ASSEMBLY);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_problem.html">Problem</a> *problem_ptr;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__access.html#ga311e33eaba451897a151813e8ea6fae4">get_problem</a>(<span class="stringliteral">&quot;FORCES_PROB&quot;</span>, &amp;problem_ptr);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Zero rows, force field is given by gradients of potential field, so one</span></div>
<div class="line">      <span class="comment">// of the values has to be fixed like for rigid body motion.</span></div>
<div class="line">      <span class="keywordflow">if</span> (is_curl == PETSC_FALSE) {</div>
<div class="line">        <span class="keywordtype">int</span> nb_dofs_to_fix = 0;</div>
<div class="line">        <span class="keywordtype">int</span> index_to_fix = 0;</div>
<div class="line">        <span class="keywordflow">if</span> (!vertex_to_fix.empty()) {</div>
<div class="line">          boost::shared_ptr&lt;NumeredDofEntity&gt; dof_ptr;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> problem_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#a403af5acea9a71bf043ff3be4c1c41ef">getDofByNameEntAndEntDofIdx</a>(</div>
<div class="line">              m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a151a5aaa12774c726c7a32ba250d2586">get_field_bit_number</a>(<span class="stringliteral">&quot;RHO&quot;</span>), vertex_to_fix[0], 0, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>,</div>
<div class="line">              dof_ptr);</div>
<div class="line">          <span class="keywordflow">if</span> (dof_ptr) {</div>
<div class="line">            <span class="keywordflow">if</span> (dof_ptr-&gt;getPart() == m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) {</div>
<div class="line">              nb_dofs_to_fix = 1;</div>
<div class="line">              index_to_fix = dof_ptr-&gt;getPetscGlobalDofIdx();</div>
<div class="line">              cerr &lt;&lt; *dof_ptr &lt;&lt; endl;</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroRows(UB, nb_dofs_to_fix, &amp;index_to_fix, 0, PETSC_NULL,</div>
<div class="line">                           PETSC_NULL);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroRows(UPSILONB, nb_dofs_to_fix, &amp;index_to_fix, 0,</div>
<div class="line">                           PETSC_NULL, PETSC_NULL);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        std::vector&lt;int&gt; dofs_to_fix;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> p_eit = edges_to_fix.pair_begin();</div>
<div class="line">             p_eit != edges_to_fix.pair_end(); ++p_eit) {</div>
<div class="line">          <span class="keyword">auto</span> bit_number = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a151a5aaa12774c726c7a32ba250d2586">get_field_bit_number</a>(<span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">          <span class="keyword">auto</span> row_dofs = problem_ptr-&gt;<a class="code hl_variable" href="struct_mo_f_e_m_1_1_problem.html#a54dbffef1909f2e198d0836fa96fa95e">numeredRowDofsPtr</a>;</div>
<div class="line">          <span class="keyword">auto</span> lo = row_dofs-&gt;lower_bound(</div>
<div class="line">              FieldEntity::getLoLocalEntityBitNumber(bit_number, p_eit-&gt;first));</div>
<div class="line">          <span class="keyword">auto</span> hi =</div>
<div class="line">              row_dofs-&gt;lower_bound(FieldEntity::getHiLocalEntityBitNumber(</div>
<div class="line">                  bit_number, p_eit-&gt;second));</div>
<div class="line">          <span class="keywordflow">for</span> (; lo != hi; ++lo)</div>
<div class="line">            dofs_to_fix.push_back((*lo)-&gt;getPetscGlobalDofIdx());</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroRows(UB, dofs_to_fix.size(), &amp;*dofs_to_fix.begin(), 0,</div>
<div class="line">                           PETSC_NULL, PETSC_NULL);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroRows(UPSILONB, dofs_to_fix.size(), &amp;*dofs_to_fix.begin(),</div>
<div class="line">                           0, PETSC_NULL, PETSC_NULL);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      Mat UBT;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatTranspose(UB, MAT_INITIAL_MATRIX, &amp;UBT);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;UB);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Matrix View</span></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">        cerr &lt;&lt; <span class="stringliteral">&quot;UBT&quot;</span> &lt;&lt; endl;</div>
<div class="line">        MatView(UBT, PETSC_VIEWER_DRAW_WORLD);</div>
<div class="line">        std::string wait;</div>
<div class="line">        std::cin &gt;&gt; wait;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      boost::shared_ptr&lt;Problem::SubProblemData&gt; sub_data =</div>
<div class="line">          problem_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#a526cf0dbf74a82cbd2db0e8c64309755">getSubData</a>();</div>
<div class="line">      <span class="comment">// CHKERR sub_data-&gt;getColIs(&amp;nested_is_rows[0]);</span></div>
<div class="line">      <span class="comment">// CHKERR sub_data-&gt;getRowIs(&amp;nested_is_cols[1]);</span></div>
<div class="line">      nested_matrices(0, 1) = UBT;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">        cerr &lt;&lt; <span class="stringliteral">&quot;UPSILONB&quot;</span> &lt;&lt; endl;</div>
<div class="line">        MatView(UPSILONB, PETSC_VIEWER_DRAW_WORLD);</div>
<div class="line">        std::string wait;</div>
<div class="line">        std::cin &gt;&gt; wait;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// CHKERR sub_data-&gt;getRowIs(&amp;nested_is_rows[1]);</span></div>
<div class="line">      <span class="comment">// CHKERR sub_data-&gt;getColIs(&amp;nested_is_cols[0]);</span></div>
<div class="line">      nested_matrices(1, 0) = UPSILONB;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;dm_sub_force);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Mat SubA;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatCreateNest(PETSC_COMM_WORLD, 2, &amp;sub_nested_is_rows[0], 2,</div>
<div class="line">                         &amp;sub_nested_is_cols[0], &amp;sub_nested_matrices(0, 0),</div>
<div class="line">                         &amp;SubA);</div>
<div class="line">    nested_matrices(0, 0) = SubA;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(SubA, MAT_FINAL_ASSEMBLY);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(SubA, MAT_FINAL_ASSEMBLY);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">      cerr &lt;&lt; <span class="stringliteral">&quot;Nested SubA&quot;</span> &lt;&lt; endl;</div>
<div class="line">      MatView(SubA, PETSC_VIEWER_STDOUT_WORLD);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Mat <a id="a81" name="a81"></a><a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatCreateNest(PETSC_COMM_WORLD, 2, &amp;nested_is_rows[0], 2,</div>
<div class="line">                         &amp;nested_is_cols[0], &amp;nested_matrices(0, 0), &amp;A);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(A, MAT_FINAL_ASSEMBLY);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(A, MAT_FINAL_ASSEMBLY);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">      cerr &lt;&lt; <span class="stringliteral">&quot;Nested A&quot;</span> &lt;&lt; endl;</div>
<div class="line">      MatView(A, PETSC_VIEWER_STDOUT_WORLD);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Vec <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, <a id="a82" name="a82"></a><a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateGlobalVector(dm_control, &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateGlobalVector(dm_control, &amp;<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Asseble the right hand side vector</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_struct" href="struct_cell_engineering_1_1_face_element.html">CellEngineering::FaceElement</a> face_element(m_field);</div>
<div class="line">      face_element.getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a83" name="_a83"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_op_get_disp_x.html">OpGetDispX</a>(common_data));</div>
<div class="line">      face_element.getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a84" name="_a84"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_op_get_disp_y.html">OpGetDispY</a>(common_data));</div>
<div class="line">      face_element.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a85" name="_a85"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_op_cell__g.html">OpCell_g</a>(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, eps_u, common_data));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_control, <span class="stringliteral">&quot;DISPLACEMENTS_PENALTY&quot;</span>,</div>
<div class="line">                                      &amp;face_element);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, ADD_VALUES, SCATTER_REVERSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, ADD_VALUES, SCATTER_REVERSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    KSP solver;</div>
<div class="line">    <span class="comment">// KSP solver;</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPCreate(PETSC_COMM_WORLD, &amp;solver);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetDM(solver, dm_control);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(solver);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetOperators(solver, A, A);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetDMActive(solver, PETSC_FALSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetInitialGuessKnoll(solver, PETSC_FALSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetInitialGuessNonzero(solver, PETSC_FALSE);</div>
<div class="line">      PC pc;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPGetPC(solver, &amp;pc);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCSetType(pc, PCFIELDSPLIT);</div>
<div class="line">      PetscBool is_pcfs = PETSC_FALSE;</div>
<div class="line">      PetscObjectTypeCompare((PetscObject)pc, PCFIELDSPLIT, &amp;is_pcfs);</div>
<div class="line">      <span class="keywordflow">if</span> (is_pcfs) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCSetOperators(pc, A, A);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(pc, NULL, nested_is_rows[0]);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(pc, NULL, nested_is_rows[1]);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetType(pc, PC_COMPOSITE_SCHUR);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCSetUp(pc);</div>
<div class="line">        KSP *sub_ksp;</div>
<div class="line">        PetscInt <a id="a86" name="a86"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitGetSubKSP(pc, &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, &amp;sub_ksp);</div>
<div class="line">        {</div>
<div class="line">          PC sub_pc_0;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPGetPC(sub_ksp[0], &amp;sub_pc_0);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCSetOperators(sub_pc_0, SubA, SubA);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCSetType(sub_pc_0, PCFIELDSPLIT);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(sub_pc_0, NULL, sub_nested_is_rows[0]);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(sub_pc_0, NULL, sub_nested_is_rows[1]);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetType(sub_pc_0, PC_COMPOSITE_MULTIPLICATIVE);</div>
<div class="line">          <span class="comment">// CHKERR</span></div>
<div class="line">          <span class="comment">// PCFieldSplitSetSchurFactType(sub_pc_0,PC_FIELDSPLIT_SCHUR_FACT_LOWER);</span></div>
<div class="line">          <span class="comment">// CHKERR PCFieldSplitSetType(sub_pc_0,PC_COMPOSITE_SCHUR);</span></div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCSetUp(sub_pc_0);</div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        SETERRQ(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                <span class="stringliteral">&quot;Only works with pre-conditioner PCFIELDSPLIT&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(solver);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Solve system of equations</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(solver, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dm_control, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES,</div>
<div class="line">                                   SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecView(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, PETSC_VIEWER_DRAW_WORLD);</div>
<div class="line">      std::string wait;</div>
<div class="line">      std::cin &gt;&gt; wait;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Clean sub matrices and sub indices</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != 2; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>++) {</div>
<div class="line">      <span class="keywordflow">if</span> (sub_nested_is_rows[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISDestroy(&amp;sub_nested_is_rows[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (sub_nested_is_cols[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISDestroy(&amp;sub_nested_is_cols[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a> = 0; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a> != 2; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>++) {</div>
<div class="line">        <span class="keywordflow">if</span> (sub_nested_matrices(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>)) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;sub_nested_matrices(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != 2; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>++) {</div>
<div class="line">      <span class="keywordflow">if</span> (nested_is_rows[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISDestroy(&amp;nested_is_rows[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (nested_is_cols[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISDestroy(&amp;nested_is_cols[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a> = 0; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a> != 2; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>++) {</div>
<div class="line">        <span class="keywordflow">if</span> (nested_matrices(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>)) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;nested_matrices(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;SubA);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;A);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;dm_sub_volume_control);</div>
<div class="line"> </div>
<div class="line">    <a id="_a87" name="_a87"></a><a class="code hl_struct" href="struct_post_proc_volume_on_refined_mesh.html">PostProcVolumeOnRefinedMesh</a> post_proc(m_field);</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc.generateReferenceElementMesh();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc.addFieldValuesPostProc(<span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc.addFieldValuesGradientPostProc(<span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <span class="comment">// add postpocessing for sresses</span></div>
<div class="line">      post_proc.getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a88" name="_a88"></a><a class="code hl_struct" href="struct_post_proc_hook_stress.html">PostProcHookStress</a>(</div>
<div class="line">          m_field, post_proc.postProcMesh, post_proc.mapGaussPts, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">          post_proc.commonData, &amp;elastic.setOfBlocks));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_control, <span class="stringliteral">&quot;ELASTIC&quot;</span>, &amp;post_proc);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc.writeFile(<span class="stringliteral">&quot;out.h5m&quot;</span>);</div>
<div class="line">      elastic.getLoopFeEnergy().snes_ctx = SnesMethod::CTX_SNESNONE;</div>
<div class="line">      elastic.getLoopFeEnergy().eNergy = 0;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_control, <span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line">                                      &amp;elastic.getLoopFeEnergy());</div>
<div class="line">      PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Elastic energy %6.4e\n&quot;</span>,</div>
<div class="line">                  elastic.getLoopFeEnergy().eNergy);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a id="_a89" name="_a89"></a><a class="code hl_struct" href="struct_post_proc_face_on_refined_mesh.html">PostProcFaceOnRefinedMesh</a> post_proc_face(m_field);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_face.generateReferenceElementMesh();</div>
<div class="line">      post_proc_face.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> OpCalculateInvJacForFace(inv_jac));</div>
<div class="line">      <span class="keywordflow">if</span> (is_curl) {</div>
<div class="line">        post_proc_face.getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_hcurl_face_impl_3_012_01_4.html">OpSetInvJacHcurlFace</a>(inv_jac));</div>
<div class="line">        post_proc_face.getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a90" name="_a90"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_op_virtual_curl_rho.html">OpVirtualCurlRho</a>(<span class="stringliteral">&quot;RHO&quot;</span>, common_data));</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        post_proc_face.getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">OpSetInvJacH1ForFace</a>(inv_jac));</div>
<div class="line">        post_proc_face.getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a91" name="_a91"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_op_virtual_potential_rho.html">OpVirtualPotentialRho</a>(<span class="stringliteral">&quot;RHO&quot;</span>, common_data));</div>
<div class="line">      }</div>
<div class="line">      post_proc_face.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a92" name="_a92"></a><a class="code hl_struct" href="struct_cell_engineering_1_1_post_proc_traction.html">PostProcTraction</a>(m_field, post_proc_face.postProcMesh,</div>
<div class="line">                               post_proc_face.mapGaussPts, common_data));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm_control, <span class="stringliteral">&quot;D&quot;</span>, &amp;post_proc_face);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_face.writeFile(<span class="stringliteral">&quot;out_tractions.h5m&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;dm_control);</div>
<div class="line"> </div>
<div class="line">  }</div>
<div class="line">  <a id="a93" name="a93"></a><a class="code hl_define" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <a id="a94" name="a94"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="a_basic_finite_elements_8hpp_html"><div class="ttname"><a href="_basic_finite_elements_8hpp.html">BasicFiniteElements.hpp</a></div></div>
<div class="ttc" id="a_cell_forces_8hpp_html"><div class="ttname"><a href="_cell_forces_8hpp.html">CellForces.hpp</a></div></div>
<div class="ttc" id="a_hooke_8hpp_html"><div class="ttname"><a href="_hooke_8hpp.html">Hooke.hpp</a></div><div class="ttdoc">Implementation of linear elastic material.</div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="aadol-c__atom_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> <a href="adol-c__atom_8cpp_source.html#l00046">adol-c_atom.cpp:46</a></div></div>
<div class="ttc" id="abase__functions_8c_html_a56d2889a19d8d7affaa85cfca4aadd67"><div class="ttname"><a href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a></div><div class="ttdeci">static PetscErrorCode ierr</div><div class="ttdef"><b>Definition</b> <a href="base__functions_8c_source.html#l00013">base_functions.c:13</a></div></div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a></div><div class="ttdeci">@ ROW</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00385">definitions.h:385</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00111">definitions.h:111</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base nme:nme847.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00061">definitions.h:60</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12aa30e505d5df1a8d715b9d175cd97ae82"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12aa30e505d5df1a8d715b9d175cd97ae82">HCURL</a></div><div class="ttdeci">@ HCURL</div><div class="ttdoc">field with continuous tangents</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00086">definitions.h:86</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a></div><div class="ttdeci">@ SIDESET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00160">definitions.h:160</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec">MOFEM_STD_EXCEPTION_THROW</a></div><div class="ttdeci">@ MOFEM_STD_EXCEPTION_THROW</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00039">definitions.h:39</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a></div><div class="ttdeci">@ MOFEM_INVALID_DATA</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00036">definitions.h:36</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="adm__create__subdm_8cpp_html_a6295d47efda04de55c38cb8ea1cdb807"><div class="ttname"><a href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a></div><div class="ttdeci">static const bool debug</div><div class="ttdef"><b>Definition</b> <a href="dm__create__subdm_8cpp_source.html#l00012">dm_create_subdm.cpp:12</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00394">free_surface.cpp:394</a></div></div>
<div class="ttc" id="agroup__dm_html_ga15496670ac6293eb1ae412714c6649db"><div class="ttname"><a href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">MoFEM::DMMoFEMSetIsPartitioned</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetIsPartitioned(DM dm, PetscBool is_partitioned)</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l01123">DMMoFEM.cpp:1123</a></div></div>
<div class="ttc" id="agroup__dm_html_ga175a29f4cdd0e7b7ae6cc2a0d7ed1704"><div class="ttname"><a href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">MoFEM::DMMoFEMCreateSubDM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateSubDM(DM subdm, DM dm, const char problem_name[])</div><div class="ttdoc">Must be called by user to set Sub DM MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00215">DMMoFEM.cpp:215</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00497">DMMoFEM.cpp:497</a></div></div>
<div class="ttc" id="agroup__dm_html_ga27babc6dfb0df28667682a98b5822739"><div class="ttname"><a href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">MoFEM::DMMoFEMSetSquareProblem</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetSquareProblem(DM dm, PetscBool square_problem)</div><div class="ttdoc">set squared problem</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00456">DMMoFEM.cpp:456</a></div></div>
<div class="ttc" id="agroup__dm_html_ga32f14a8ae536697a4a0356900ecb73fd"><div class="ttname"><a href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">MoFEM::DMMoFEMCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateMoFEM(DM dm, MoFEM::Interface *m_field_ptr, const char problem_name[], const MoFEM::BitRefLevel bit_level, const MoFEM::BitRefLevel bit_mask=MoFEM::BitRefLevel().set())</div><div class="ttdoc">Must be called by user to set MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00114">DMMoFEM.cpp:114</a></div></div>
<div class="ttc" id="agroup__dm_html_ga3fcdbd5c74eba11ee82492e57d730756"><div class="ttname"><a href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">MoFEM::DMoFEMPostProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPostProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00556">DMMoFEM.cpp:556</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00523">DMMoFEM.cpp:523</a></div></div>
<div class="ttc" id="agroup__dm_html_ga62400e040ecf09a00b7ec3767fc7f124"><div class="ttname"><a href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">MoFEM::DMMoFEMAddSubFieldRow</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddSubFieldRow(DM dm, const char field_name[])</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00238">DMMoFEM.cpp:238</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="agroup__dm_html_gac7a16ef15dc01cc47e25241d138d85da"><div class="ttname"><a href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">MoFEM::DMMoFEMAddSubFieldCol</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddSubFieldCol(DM dm, const char field_name[])</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00280">DMMoFEM.cpp:280</a></div></div>
<div class="ttc" id="agroup__dm_html_gaf4d3fe19e4d76504628e614fd388c33f"><div class="ttname"><a href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">MoFEM::DMoFEMPreProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPreProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00546">DMMoFEM.cpp:546</a></div></div>
<div class="ttc" id="agroup__mofem__access_html_ga311e33eaba451897a151813e8ea6fae4"><div class="ttname"><a href="group__mofem__access.html#ga311e33eaba451897a151813e8ea6fae4">MoFEM::CoreInterface::get_problem</a></div><div class="ttdeci">virtual const Problem * get_problem(const std::string problem_name) const =0</div><div class="ttdoc">Get the problem object.</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga4a5b822f605f1a4faa668595a3f2a5ae"><div class="ttname"><a href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">MoFEM::CoreInterface::add_finite_element</a></div><div class="ttdeci">virtual MoFEMErrorCode add_finite_element(const std::string &amp;fe_name, enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">add finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga735f920686a9c958073ec14ea0dc1da0"><div class="ttname"><a href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">MoFEM::CoreInterface::build_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode build_finite_elements(int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Build finite elements.</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8a9935d6f31d07ed365e6cc76bd041d2"><div class="ttname"><a href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">MoFEM::CoreInterface::modify_finite_element_add_field_col</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_col(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field col which finite element use</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8b068eced1fd720631edcaea59289a15"><div class="ttname"><a href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">MoFEM::CoreInterface::add_ents_to_finite_element_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_finite_element_by_type(const EntityHandle entities, const EntityType type, const std::string &amp;name, const bool recursive=true)=0</div><div class="ttdoc">add entities to finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gad29d66fc5706d3b20e4acd02eac81c9d"><div class="ttname"><a href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">MoFEM::CoreInterface::modify_finite_element_add_field_row</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_row(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field row which finite element use</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gaef2eb2d85b90b55bd7c4f355e10fa498"><div class="ttname"><a href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">MoFEM::CoreInterface::modify_finite_element_add_field_data</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_data(const std::string &amp;fe_name, const std::string name_field)=0</div><div class="ttdoc">set finite element field data</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga126ea0bb04802f9d1946435279c3da56"><div class="ttname"><a href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">MoFEM::CoreInterface::build_fields</a></div><div class="ttdeci">virtual MoFEMErrorCode build_fields(int verb=DEFAULT_VERBOSITY)=0</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga43572d534c72c5561b94ab6f7f3ddfbb"><div class="ttname"><a href="group__mofem__field.html#ga43572d534c72c5561b94ab6f7f3ddfbb">MoFEM::DeprecatedCoreInterface::synchronise_field_entities</a></div><div class="ttdeci">DEPRECATED MoFEMErrorCode synchronise_field_entities(const std::string &amp;name, int verb=DEFAULT_VERBOSITY)</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_core_interface_8cpp_source.html#l00047">DeprecatedCoreInterface.cpp:47</a></div></div>
<div class="ttc" id="agroup__mofem__field_html_ga86f0c16b69cc30dabc5d7dd292299b07"><div class="ttname"><a href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">MoFEM::CoreInterface::set_field_order</a></div><div class="ttdeci">virtual MoFEMErrorCode set_field_order(const EntityHandle meshset, const EntityType type, const std::string &amp;name, const ApproximationOrder order, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Set order approximation of the entities in the field.</div></div>
<div class="ttc" id="agroup__mofem__field_html_gaa584a5c9cc28f5ae0a7088d130683be8"><div class="ttname"><a href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">MoFEM::CoreInterface::add_ents_to_field_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_field_by_type(const Range &amp;ents, const EntityType type, const std::string &amp;name, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add entities to field meshset.</div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga59a61820bca209651d9a1886848ebc25"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">MoFEM::MeshsetsManager::checkMeshset</a></div><div class="ttdeci">bool checkMeshset(const int ms_id, const CubitBCType cubit_bc_type) const</div><div class="ttdoc">check for CUBIT Id and CUBIT type</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00360">MeshsetsManager.cpp:360</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gab0614ec3ab18ec96717149423946ced7"><div class="ttname"><a href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">MoFEM::MeshsetsManager::getEntitiesByDimension</a></div><div class="ttdeci">MoFEMErrorCode getEntitiesByDimension(const int ms_id, const unsigned int cubit_bc_type, const int dimension, Range &amp;entities, const bool recursive=true) const</div><div class="ttdoc">get entities from CUBIT/meshset of a particular entity dimension</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00669">MeshsetsManager.cpp:669</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaff36ed0367e6b0a57541419546aa1323"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet having a particular BC meshset in a moFEM field.</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8hpp_source.html#l00071">MeshsetsManager.hpp:71</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_ad8657a5ec76e12f3066fb4b4eb75ace9"><div class="ttname"><a href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a></div><div class="ttdeci">double D</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00044">initial_diffusion.cpp:44</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_afd53743d1af6bfa2856255b23b5a41a9"><div class="ttname"><a href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a></div><div class="ttdeci">const double n</div><div class="ttdoc">refractive index of diffusive medium</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00038">initial_diffusion.cpp:38</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amesh__smoothing_8cpp_html_ae20b66af13b03d8e8a4593186c23cd07"><div class="ttname"><a href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a></div><div class="ttdeci">char mesh_file_name[255]</div><div class="ttdef"><b>Definition</b> <a href="mesh__smoothing_8cpp_source.html#l00022">mesh_smoothing.cpp:22</a></div></div>
<div class="ttc" id="anamespace_cell_engineering_html"><div class="ttname"><a href="namespace_cell_engineering.html">CellEngineering</a></div><div class="ttdef"><b>Definition</b> <a href="cell__forces_8cpp_source.html#l00412">cell_forces.cpp:412</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html"><div class="ttname"><a href="namespace_mo_f_e_m.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition</b> <a href="_common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition</b> <a href="enable__if_8hpp_source.html#l00005">enable_if.hpp:6</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="astruct_block_option_data_html"><div class="ttname"><a href="struct_block_option_data.html">BlockOptionData</a></div><div class="ttdef"><b>Definition</b> <a href="elasticity_8cpp_source.html#l00062">elasticity.cpp:62</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_block_option_data_html_a04d0897d5de56a98c5bf304c7eca94b6"><div class="ttname"><a href="struct_cell_engineering_1_1_block_option_data.html#a04d0897d5de56a98c5bf304c7eca94b6">CellEngineering::BlockOptionData::BlockOptionData</a></div><div class="ttdeci">BlockOptionData()</div><div class="ttdef"><b>Definition</b> <a href="cell__forces_8cpp_source.html#l00418">cell_forces.cpp:418</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_block_option_data_html_a9e1244c3c9f228d22a7700013a4e5b69"><div class="ttname"><a href="struct_cell_engineering_1_1_block_option_data.html#a9e1244c3c9f228d22a7700013a4e5b69">CellEngineering::BlockOptionData::yOung</a></div><div class="ttdeci">double yOung</div><div class="ttdef"><b>Definition</b> <a href="cell__forces_8cpp_source.html#l00416">cell_forces.cpp:416</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_block_option_data_html_aacda3f9808416cf9eb85721ff6f57a79"><div class="ttname"><a href="struct_cell_engineering_1_1_block_option_data.html#aacda3f9808416cf9eb85721ff6f57a79">CellEngineering::BlockOptionData::oRder</a></div><div class="ttdeci">int oRder</div><div class="ttdef"><b>Definition</b> <a href="cell__forces_8cpp_source.html#l00415">cell_forces.cpp:415</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_block_option_data_html_afd3868e580289cee51eee90ea231a0d6"><div class="ttname"><a href="struct_cell_engineering_1_1_block_option_data.html#afd3868e580289cee51eee90ea231a0d6">CellEngineering::BlockOptionData::pOisson</a></div><div class="ttdeci">double pOisson</div><div class="ttdef"><b>Definition</b> <a href="cell__forces_8cpp_source.html#l00417">cell_forces.cpp:417</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_common_data_html"><div class="ttname"><a href="struct_cell_engineering_1_1_common_data.html">CellEngineering::CommonData</a></div><div class="ttdef"><b>Definition</b> <a href="_disp_map_8hpp_source.html#l00173">DispMap.hpp:173</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_face_element_html"><div class="ttname"><a href="struct_cell_engineering_1_1_face_element.html">CellEngineering::FaceElement</a></div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00048">CellForces.hpp:48</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_fat_prism_html"><div class="ttname"><a href="struct_cell_engineering_1_1_fat_prism.html">CellEngineering::FatPrism</a></div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00021">CellForces.hpp:21</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_op_cell__g_html"><div class="ttname"><a href="struct_cell_engineering_1_1_op_cell__g.html">CellEngineering::OpCell_g</a></div><div class="ttdoc">Calculate and assemble g vector.</div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00267">CellForces.hpp:268</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_op_cell_curl_b_html"><div class="ttname"><a href="struct_cell_engineering_1_1_op_cell_curl_b.html">CellEngineering::OpCellCurlB</a></div><div class="ttdoc">Calculate and assemble Z matrix.</div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00392">CellForces.hpp:393</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_op_cell_curl_d_html"><div class="ttname"><a href="struct_cell_engineering_1_1_op_cell_curl_d.html">CellEngineering::OpCellCurlD</a></div><div class="ttdoc">Calculate and assemble Z matrix.</div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00315">CellForces.hpp:316</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_op_cell_potential_b_html"><div class="ttname"><a href="struct_cell_engineering_1_1_op_cell_potential_b.html">CellEngineering::OpCellPotentialB</a></div><div class="ttdoc">Calculate and assemble B matrix.</div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00140">CellForces.hpp:141</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_op_cell_potential_d_html"><div class="ttname"><a href="struct_cell_engineering_1_1_op_cell_potential_d.html">CellEngineering::OpCellPotentialD</a></div><div class="ttdoc">Calculate and assemble D matrix.</div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00073">CellForces.hpp:74</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_op_cell_s_html"><div class="ttname"><a href="struct_cell_engineering_1_1_op_cell_s.html">CellEngineering::OpCellS</a></div><div class="ttdoc">Calculate and assemble S matrix.</div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00201">CellForces.hpp:202</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_op_get_disp_x_html"><div class="ttname"><a href="struct_cell_engineering_1_1_op_get_disp_x.html">CellEngineering::OpGetDispX</a></div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00057">CellForces.hpp:57</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_op_get_disp_y_html"><div class="ttname"><a href="struct_cell_engineering_1_1_op_get_disp_y.html">CellEngineering::OpGetDispY</a></div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00065">CellForces.hpp:65</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_op_virtual_curl_rho_html"><div class="ttname"><a href="struct_cell_engineering_1_1_op_virtual_curl_rho.html">CellEngineering::OpVirtualCurlRho</a></div><div class="ttdoc">Post-process tractions.</div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00528">CellForces.hpp:529</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_op_virtual_potential_rho_html"><div class="ttname"><a href="struct_cell_engineering_1_1_op_virtual_potential_rho.html">CellEngineering::OpVirtualPotentialRho</a></div><div class="ttdoc">Post-process tractions.</div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00460">CellForces.hpp:461</a></div></div>
<div class="ttc" id="astruct_cell_engineering_1_1_post_proc_traction_html"><div class="ttname"><a href="struct_cell_engineering_1_1_post_proc_traction.html">CellEngineering::PostProcTraction</a></div><div class="ttdoc">Shave results on mesh tags for post-processing.</div><div class="ttdef"><b>Definition</b> <a href="_cell_forces_8hpp_source.html#l00600">CellForces.hpp:601</a></div></div>
<div class="ttc" id="astruct_dirichlet_displacement_bc_html"><div class="ttname"><a href="struct_dirichlet_displacement_bc.html">DirichletDisplacementBc</a></div><div class="ttdoc">Set Dirichlet boundary conditions on displacements.</div><div class="ttdef"><b>Definition</b> <a href="_dirichlet_b_c_8hpp_source.html#l00057">DirichletBC.hpp:57</a></div></div>
<div class="ttc" id="astruct_hooke_html"><div class="ttname"><a href="struct_hooke.html">Hooke</a></div><div class="ttdoc">Hook equation.</div><div class="ttdef"><b>Definition</b> <a href="_hooke_8hpp_source.html#l00019">Hooke.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a151a5aaa12774c726c7a32ba250d2586"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a151a5aaa12774c726c7a32ba250d2586">MoFEM::CoreInterface::get_field_bit_number</a></div><div class="ttdeci">virtual FieldBitNumber get_field_bit_number(const std::string name) const =0</div><div class="ttdoc">get field bit number</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a727653d1367e758daf2a74cb65d4dfa5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a727653d1367e758daf2a74cb65d4dfa5">MoFEM::CoreInterface::build_adjacencies</a></div><div class="ttdeci">virtual MoFEMErrorCode build_adjacencies(const Range &amp;ents, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">build adjacencies</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a8008ad16315eb609dcb0fd88746b991a"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">MoFEM::CoreInterface::add_field</a></div><div class="ttdeci">virtual MoFEMErrorCode add_field(const std::string name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add field.</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition</b> <a href="_core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition</b> <a href="_core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition</b> <a href="_core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html_a4ff0811a785a91df31f0aeed637a34d8"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a4ff0811a785a91df31f0aeed637a34d8">MoFEM::DeprecatedCoreInterface::synchronise_entities</a></div><div class="ttdeci">DEPRECATED MoFEMErrorCode synchronise_entities(Range &amp;ent, int verb=DEFAULT_VERBOSITY)</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_core_interface_8cpp_source.html#l00041">DeprecatedCoreInterface.cpp:41</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html_a99746b844704e78167482954bb5e52b0"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a99746b844704e78167482954bb5e52b0">MoFEM::DeprecatedCoreInterface::seed_ref_level</a></div><div class="ttdeci">DEPRECATED MoFEMErrorCode seed_ref_level(const Range &amp;ents, const BitRefLevel &amp;bit, const bool only_tets=true, int verb=-1)</div><div class="ttdoc">seed entities in the range and their adjacencies in a particular BitRefLevel</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_core_interface_8cpp_source.html#l00024">DeprecatedCoreInterface.cpp:24</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_i_s_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_i_s_manager.html">MoFEM::ISManager</a></div><div class="ttdoc">Section manager is used to create indexes and sections.</div><div class="ttdef"><b>Definition</b> <a href="_i_s_manager_8hpp_source.html#l00023">ISManager.hpp:23</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_meshsets_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_meshsets_manager.html">MoFEM::MeshsetsManager</a></div><div class="ttdoc">Interface for managing meshsets containing materials and boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8hpp_source.html#l00104">MeshsetsManager.hpp:104</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_meshsets_manager_html_a0c4584c8c203e2f36d12ac01dd157661"><div class="ttname"><a href="struct_mo_f_e_m_1_1_meshsets_manager.html#a0c4584c8c203e2f36d12ac01dd157661">MoFEM::MeshsetsManager::printForceSet</a></div><div class="ttdeci">MoFEMErrorCode printForceSet() const</div><div class="ttdoc">print meshsets with force boundary conditions data structure</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00304">MeshsetsManager.cpp:304</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_meshsets_manager_html_a885fdd41538fbaa6087914c83e3abbf3"><div class="ttname"><a href="struct_mo_f_e_m_1_1_meshsets_manager.html#a885fdd41538fbaa6087914c83e3abbf3">MoFEM::MeshsetsManager::printMaterialsSet</a></div><div class="ttdeci">MoFEMErrorCode printMaterialsSet() const</div><div class="ttdoc">print meshsets with material data structure set on it</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00325">MeshsetsManager.cpp:325</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_meshsets_manager_html_afa62a3609656736c776e8ad075d36b0c"><div class="ttname"><a href="struct_mo_f_e_m_1_1_meshsets_manager.html#afa62a3609656736c776e8ad075d36b0c">MoFEM::MeshsetsManager::printDisplacementSet</a></div><div class="ttdeci">MoFEMErrorCode printDisplacementSet() const</div><div class="ttdoc">print meshsets with displacement boundary conditions data structure</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00290">MeshsetsManager.cpp:290</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism.html">MoFEM::OpCalculateInvJacForFatPrism</a></div><div class="ttdoc">Calculate inverse of jacobian for face element.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l03145">UserDataOperators.hpp:3146</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">MoFEM::OpSetInvJacH1ForFace</a></div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l02918">UserDataOperators.hpp:2919</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism.html">MoFEM::OpSetInvJacH1ForFatPrism</a></div><div class="ttdoc">Transform local reference derivatives of shape functions to global derivatives.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l03172">UserDataOperators.hpp:3173</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_set_inv_jac_hcurl_face_impl_3_012_01_4_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_set_inv_jac_hcurl_face_impl_3_012_01_4.html">MoFEM::OpSetInvJacHcurlFaceImpl&lt; 2 &gt;</a></div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l02956">UserDataOperators.hpp:2957</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_problem_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_problem.html">MoFEM::Problem</a></div><div class="ttdoc">keeps basic data about problem</div><div class="ttdef"><b>Definition</b> <a href="_problems_multi_indices_8hpp_source.html#l00054">ProblemsMultiIndices.hpp:54</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_problem_html_a403af5acea9a71bf043ff3be4c1c41ef"><div class="ttname"><a href="struct_mo_f_e_m_1_1_problem.html#a403af5acea9a71bf043ff3be4c1c41ef">MoFEM::Problem::getDofByNameEntAndEntDofIdx</a></div><div class="ttdeci">MoFEMErrorCode getDofByNameEntAndEntDofIdx(const int field_bit_number, const EntityHandle ent, const int ent_dof_idx, const RowColData row_or_col, boost::shared_ptr&lt; NumeredDofEntity &gt; &amp;dof_ptr) const</div><div class="ttdoc">get DOFs from problem</div><div class="ttdef"><b>Definition</b> <a href="_problems_multi_indices_8cpp_source.html#l00132">ProblemsMultiIndices.cpp:132</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_problem_html_a526cf0dbf74a82cbd2db0e8c64309755"><div class="ttname"><a href="struct_mo_f_e_m_1_1_problem.html#a526cf0dbf74a82cbd2db0e8c64309755">MoFEM::Problem::getSubData</a></div><div class="ttdeci">boost::shared_ptr&lt; SubProblemData &gt; &amp; getSubData() const</div><div class="ttdoc">Get main problem of sub-problem is.</div><div class="ttdef"><b>Definition</b> <a href="_problems_multi_indices_8hpp_source.html#l00119">ProblemsMultiIndices.hpp:119</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_problem_html_a54dbffef1909f2e198d0836fa96fa95e"><div class="ttname"><a href="struct_mo_f_e_m_1_1_problem.html#a54dbffef1909f2e198d0836fa96fa95e">MoFEM::Problem::numeredRowDofsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; NumeredDofEntity_multiIndex &gt; numeredRowDofsPtr</div><div class="ttdoc">store DOFs on rows for this problem</div><div class="ttdef"><b>Definition</b> <a href="_problems_multi_indices_8hpp_source.html#l00073">ProblemsMultiIndices.hpp:73</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html_a525e4d5a451a5bb8c5437d0dd2588de6"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html#a525e4d5a451a5bb8c5437d0dd2588de6">MoFEM::UnknownInterface::query_interface</a></div><div class="ttdeci">virtual MoFEMErrorCode query_interface(boost::typeindex::type_index type_index, UnknownInterface **iface) const =0</div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_op_get_common_data_at_gauss_pts_html"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_op_get_common_data_at_gauss_pts.html">NonlinearElasticElement::OpGetCommonDataAtGaussPts</a></div><div class="ttdef"><b>Definition</b> <a href="_non_linear_elastic_element_8hpp_source.html#l00362">NonLinearElasticElement.hpp:362</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_op_jacobian_piola_kirchhoff_stress_html"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_op_jacobian_piola_kirchhoff_stress.html">NonlinearElasticElement::OpJacobianPiolaKirchhoffStress</a></div><div class="ttdoc">Operator performs automatic differentiation.</div><div class="ttdef"><b>Definition</b> <a href="_non_linear_elastic_element_8hpp_source.html#l00370">NonLinearElasticElement.hpp:371</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_op_lhs_piola_kirchhoff__dx_html"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_op_lhs_piola_kirchhoff__dx.html">NonlinearElasticElement::OpLhsPiolaKirchhoff_dx</a></div><div class="ttdef"><b>Definition</b> <a href="_non_linear_elastic_element_8hpp_source.html#l00556">NonLinearElasticElement.hpp:557</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_op_rhs_piola_kirchhoff_html"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_op_rhs_piola_kirchhoff.html">NonlinearElasticElement::OpRhsPiolaKirchhoff</a></div><div class="ttdef"><b>Definition</b> <a href="_non_linear_elastic_element_8hpp_source.html#l00520">NonLinearElasticElement.hpp:521</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_html"><div class="ttname"><a href="struct_nonlinear_elastic_element.html">NonlinearElasticElement</a></div><div class="ttdoc">structure grouping operators and data used for calculation of nonlinear elastic element</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00027">HookeElement.hpp:27</a></div></div>
<div class="ttc" id="astruct_post_proc_face_on_refined_mesh_html"><div class="ttname"><a href="struct_post_proc_face_on_refined_mesh.html">PostProcFaceOnRefinedMesh</a></div><div class="ttdoc">Postprocess on face.</div><div class="ttdef"><b>Definition</b> <a href="_post_proc_on_ref_mesh_8hpp_source.html#l01032">PostProcOnRefMesh.hpp:1033</a></div></div>
<div class="ttc" id="astruct_post_proc_hook_stress_html"><div class="ttname"><a href="struct_post_proc_hook_stress.html">PostProcHookStress</a></div><div class="ttdoc">Operator post-procesing stresses for Hook isotropic material.</div><div class="ttdef"><b>Definition</b> <a href="_post_proc_hook_stresses_8hpp_source.html#l00040">PostProcHookStresses.hpp:41</a></div></div>
<div class="ttc" id="astruct_post_proc_volume_on_refined_mesh_html"><div class="ttname"><a href="struct_post_proc_volume_on_refined_mesh.html">PostProcVolumeOnRefinedMesh</a></div><div class="ttdoc">Post processing.</div><div class="ttdef"><b>Definition</b> <a href="_post_proc_on_ref_mesh_8hpp_source.html#l00955">PostProcOnRefMesh.hpp:957</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.12.0
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>
