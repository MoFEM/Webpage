<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: users_modules/basic_finite_elements/src/HookeElement.hpp File Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <script>
    window.MathJax = {
      tex: {
        tags: 'all', // Enables equation numbering
      },
      loader: {
        load: ['[tex]/boldsymbol']
      }
    };
  </script>
  <script type="text/javascript " src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.15.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4fdd23f46654bee42f0ef7ae5010b806.html">users_modules</a></li><li class="navelem"><a class="el" href="dir_0fb3e37c83410fc916ba3837ad3905e3.html">basic_finite_elements</a></li><li class="navelem"><a class="el" href="dir_0ca3dd9647a8dd6efd8896ba0551cf14.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">HookeElement.hpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="BasicFiniteElements_8hpp_source.html">BasicFiniteElements.hpp</a>&gt;</code><br />
</div>
<p><a href="HookeElement_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structNonlinearElasticElement.html">NonlinearElasticElement</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">structure grouping operators and data used for calculation of nonlinear elastic element  <a href="structNonlinearElasticElement.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structNonlinearElasticElement_1_1BlockData.html">NonlinearElasticElement::BlockData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">data for calculation heat conductivity and heat capacity elements  <a href="structNonlinearElasticElement_1_1BlockData.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structConvectiveMassElement.html">ConvectiveMassElement</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">structure grouping operators and data used for calculation of mass (convective) element \ nonlinear_elastic_elem  <a href="structConvectiveMassElement.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structConvectiveMassElement_1_1BlockData.html">ConvectiveMassElement::BlockData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">data for calculation inertia forces  <a href="structConvectiveMassElement_1_1BlockData.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDataAtIntegrationPts.html">DataAtIntegrationPts</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpCalculateStrain.html">OpCalculateStrain&lt; D &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpCalculateStrainAle.html">OpCalculateStrainAle</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpCalculateStress.html">OpCalculateStress&lt; S &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpCalculateEnergy.html">OpCalculateEnergy</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness&lt; S &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpCalculateMassMatrix.html">OpCalculateMassMatrix</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assemble mass matrix for elastic element TODO: CHANGE FORMULA *.  <a href="structOpCalculateMassMatrix.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpCalculateStiffnessScaledByDensityField.html">OpCalculateStiffnessScaledByDensityField</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAssemble.html">OpAssemble</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpRhs__dx.html">OpRhs_dx</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpLhs__dx__dx.html">OpLhs_dx_dx&lt; S &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAleRhs__dx.html">OpAleRhs_dx</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAleLhs__dx__dx.html">OpAleLhs_dx_dx&lt; S &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAleLhs__dx__dX.html">OpAleLhs_dx_dX&lt; S &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAleLhsWithDensity__dx__dX.html">OpAleLhsWithDensity_dx_dX</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAleLhsWithDensity__dX__dX.html">OpAleLhsWithDensity_dX_dX</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAleRhs__dX.html">OpAleRhs_dX</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAleLhs__dX__dX.html">OpAleLhs_dX_dX&lt; S &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAleLhsPre__dX__dx.html">OpAleLhsPre_dX_dx&lt; S &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAleLhs__dX__dx.html">OpAleLhs_dX_dx</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAnalyticalInternalStrain__dx.html">OpAnalyticalInternalStrain_dx&lt; S &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAnalyticalInternalAleStrain__dX.html">OpAnalyticalInternalAleStrain_dX&lt; S &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpAnalyticalInternalAleStrain__dx.html">OpAnalyticalInternalAleStrain_dx&lt; S &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOpPostProcHookeElement.html">OpPostProcHookeElement&lt; ELEMENT &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab02600da9e2ca129f6258b0e880c1e0e" id="r_ab02600da9e2ca129f6258b0e880c1e0e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(SM)</td></tr>
<tr class="separator:ab02600da9e2ca129f6258b0e880c1e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ad69b938437dfc95379e2431c4360a7a2" id="r_ad69b938437dfc95379e2431c4360a7a2"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="HookeElement_8hpp.html#ad69b938437dfc95379e2431c4360a7a2">MassBlockData</a> = <a class="el" href="structConvectiveMassElement_1_1BlockData.html">ConvectiveMassElement::BlockData</a></td></tr>
<tr class="separator:ad69b938437dfc95379e2431c4360a7a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1342a5bb82a44eb578a7246723649d11" id="r_a1342a5bb82a44eb578a7246723649d11"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="HookeElement_8hpp.html#a1342a5bb82a44eb578a7246723649d11">EntData</a> = <a class="el" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a></td></tr>
<tr class="separator:a1342a5bb82a44eb578a7246723649d11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee27a2ebc8f3d34a5c1ce71b2607d1a3" id="r_aee27a2ebc8f3d34a5c1ce71b2607d1a3"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a> = ForcesAndSourcesCore::UserDataOperator</td></tr>
<tr class="separator:aee27a2ebc8f3d34a5c1ce71b2607d1a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8f978f1e489a9e0ace529ba353e21e4" id="r_aa8f978f1e489a9e0ace529ba353e21e4"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="HookeElement_8hpp.html#aa8f978f1e489a9e0ace529ba353e21e4">VolUserDataOperator</a> = <a class="el" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a></td></tr>
<tr class="separator:aa8f978f1e489a9e0ace529ba353e21e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acbad9d6ebbe635c14d71762f3c5b6fcd" id="r_acbad9d6ebbe635c14d71762f3c5b6fcd"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="HookeElement_8hpp.html#acbad9d6ebbe635c14d71762f3c5b6fcd">setBlocks</a> (<a class="el" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a> &amp;m_field, boost::shared_ptr&lt; map&lt; int, <a class="el" href="structMoFEM_1_1BlockData.html">BlockData</a> &gt; &gt; &amp;block_sets_ptr)</td></tr>
<tr class="separator:acbad9d6ebbe635c14d71762f3c5b6fcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6237f89a3868d67c0a4dbd704ee03990" id="r_a6237f89a3868d67c0a4dbd704ee03990"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="HookeElement_8hpp.html#a6237f89a3868d67c0a4dbd704ee03990">addElasticElement</a> (<a class="el" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a> &amp;m_field, boost::shared_ptr&lt; map&lt; int, <a class="el" href="structMoFEM_1_1BlockData.html">BlockData</a> &gt; &gt; &amp;block_sets_ptr, const std::string element_name, const std::string x_field, const std::string X_field, const <a class="el" href="classbool.html">bool</a> ale)</td></tr>
<tr class="separator:a6237f89a3868d67c0a4dbd704ee03990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76d1b67e03b64ca1ae3edb7b0788e578" id="r_a76d1b67e03b64ca1ae3edb7b0788e578"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="HookeElement_8hpp.html#a76d1b67e03b64ca1ae3edb7b0788e578">setOperators</a> (boost::shared_ptr&lt; <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> &gt; fe_lhs_ptr, boost::shared_ptr&lt; <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> &gt; fe_rhs_ptr, boost::shared_ptr&lt; map&lt; int, <a class="el" href="structMoFEM_1_1BlockData.html">BlockData</a> &gt; &gt; block_sets_ptr, const std::string x_field, const std::string X_field, const <a class="el" href="classbool.html">bool</a> ale, const <a class="el" href="classbool.html">bool</a> field_disp, const EntityType type=MBTET, boost::shared_ptr&lt; <a class="el" href="structDataAtIntegrationPts.html">DataAtIntegrationPts</a> &gt; data_at_pts=nullptr)</td></tr>
<tr class="separator:a76d1b67e03b64ca1ae3edb7b0788e578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8b2d0d211d4aa4590cf708695ddcaa" id="r_adc8b2d0d211d4aa4590cf708695ddcaa"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="HookeElement_8hpp.html#adc8b2d0d211d4aa4590cf708695ddcaa">calculateEnergy</a> (DM dm, boost::shared_ptr&lt; map&lt; int, <a class="el" href="structMoFEM_1_1BlockData.html">BlockData</a> &gt; &gt; block_sets_ptr, const std::string x_field, const std::string X_field, const <a class="el" href="classbool.html">bool</a> ale, const <a class="el" href="classbool.html">bool</a> field_disp, <a class="el" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj</a>&lt; Vec &gt; &amp;v_energy_ptr)</td></tr>
<tr class="separator:adc8b2d0d211d4aa4590cf708695ddcaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gaa4fccd2f1b2f6c51b5cd18736ea70595" id="r_gaa4fccd2f1b2f6c51b5cd18736ea70595"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structConvectiveMassElement.html">ConvectiveMassElement</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonlinear__elastic__elem.html#gaa4fccd2f1b2f6c51b5cd18736ea70595">BlockData</a> = <a class="el" href="structNonlinearElasticElement_1_1BlockData.html">NonlinearElasticElement::BlockData</a></td></tr>
<tr class="separator:gaa4fccd2f1b2f6c51b5cd18736ea70595"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad231e62173ae2a67709c00b3c866a198" id="r_ad231e62173ae2a67709c00b3c866a198"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="HookeElement_8hpp.html#ad231e62173ae2a67709c00b3c866a198">invJac</a></td></tr>
<tr class="separator:ad231e62173ae2a67709c00b3c866a198"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab02600da9e2ca129f6258b0e880c1e0e" name="ab02600da9e2ca129f6258b0e880c1e0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab02600da9e2ca129f6258b0e880c1e0e">&#9670;&#160;</a></span>MAT_TO_DDG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAT_TO_DDG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">SM</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  &amp;(*SM)(0, 0), &amp;(*SM)(1, 0), &amp;(*SM)(2, 0), &amp;(*SM)(3, 0), &amp;(*SM)(4, 0),        \</div>
<div class="line">      &amp;(*SM)(5, 0), &amp;(*SM)(6, 0), &amp;(*SM)(7, 0), &amp;(*SM)(8, 0), &amp;(*SM)(9, 0),    \</div>
<div class="line">      &amp;(*SM)(10, 0), &amp;(*SM)(11, 0), &amp;(*SM)(12, 0), &amp;(*SM)(13, 0),              \</div>
<div class="line">      &amp;(*SM)(14, 0), &amp;(*SM)(15, 0), &amp;(*SM)(16, 0), &amp;(*SM)(17, 0),              \</div>
<div class="line">      &amp;(*SM)(18, 0), &amp;(*SM)(19, 0), &amp;(*SM)(20, 0), &amp;(*SM)(21, 0),              \</div>
<div class="line">      &amp;(*SM)(22, 0), &amp;(*SM)(23, 0), &amp;(*SM)(24, 0), &amp;(*SM)(25, 0),              \</div>
<div class="line">      &amp;(*SM)(26, 0), &amp;(*SM)(27, 0), &amp;(*SM)(28, 0), &amp;(*SM)(29, 0),              \</div>
<div class="line">      &amp;(*SM)(30, 0), &amp;(*SM)(31, 0), &amp;(*SM)(32, 0), &amp;(*SM)(33, 0),              \</div>
<div class="line">      &amp;(*SM)(34, 0), &amp;(*SM)(35, 0)</div>
</div><!-- fragment --><dl class="section examples"><dt>Examples</dt><dd><a class="el" href="HookeElement_8cpp-example.html#a76">HookeElement.cpp</a>, and <a class="el" href="HookeElement_8hpp-example.html#a69">HookeElement.hpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HookeElement_8hpp_source.html#l00142">142</a> of file <a class="el" href="HookeElement_8hpp_source.html">HookeElement.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  152</span>                                                : <span class="keyword">public</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a> {</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    <a class="code hl_struct" href="structOpCalculateStress.html">OpCalculateStress</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  155</span>                      boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts);</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  160</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line"><span class="lineno">  161</span>  };</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpCalculateEnergy.html">OpCalculateEnergy</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a> {</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    <a class="code hl_struct" href="structOpCalculateEnergy.html">OpCalculateEnergy</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  166</span>                      boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line"><span class="lineno">  167</span>                      <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a> ghost_vec = <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>());</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpCalculateEnergy.html#aacf4b4873b0416bdd9264ee1dbe64976">doWork</a>(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  172</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; <a class="code hl_variable" href="structOpCalculateEnergy.html#ab2cc832e3898addc031110f64413ca94">dataAtPts</a>;</div>
<div class="line"><span class="lineno">  173</span>    <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a> <a class="code hl_variable" href="structOpCalculateEnergy.html#a97ba5f4592381978ca5d93d517e41bde">ghostVec</a>;</div>
<div class="line"><span class="lineno">  174</span>  };</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a> {</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>    <a class="code hl_struct" href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a>(</div>
<div class="line"><span class="lineno">  179</span>        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  180</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts);</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpCalculateEshelbyStress.html#a3973777d822ad00105354038c01f3b2f">doWork</a>(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  185</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; <a class="code hl_variable" href="structOpCalculateEshelbyStress.html#a6bbc72d43bfd4ac78f50e1b6136912a2">dataAtPts</a>;</div>
<div class="line"><span class="lineno">  186</span>  };</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt;</div>
<div class="line"><span class="lineno">  189</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a> {</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    <a class="code hl_struct" href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness</a>(</div>
<div class="line"><span class="lineno">  192</span>        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  193</span>        boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line"><span class="lineno">  194</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts);</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpCalculateHomogeneousStiffness.html#a0bd52e495ceb241fcbed1bca60b0d715">doWork</a>(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  199</span>    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt;</div>
<div class="line"><span class="lineno">  200</span>        <a class="code hl_variable" href="structOpCalculateHomogeneousStiffness.html#a2445b7a298622b5ae159f63a3b2d3c7c">blockSetsPtr</a>; <span class="comment">///&lt; Structure keeping data about problem, like</span><span class="comment"></span></div>
<div class="line"><span class="lineno">  201</span><span class="comment">                      ///&lt; material parameters</span></div>
<div class="line"><span class="lineno">  202</span><span class="comment"></span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; <a class="code hl_variable" href="structOpCalculateHomogeneousStiffness.html#a8a8cedb4f8852ad43fb76181000512e7">dataAtPts</a>;</div>
<div class="line"><span class="lineno">  203</span>  };</div>
<div class="line"><span class="lineno">  204</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  205</span><span class="comment">  /** * @brief Assemble mass matrix for elastic element TODO: CHANGE FORMULA *</span></div>
<div class="line"><span class="lineno">  206</span><span class="comment">   * \f[</span></div>
<div class="line"><span class="lineno">  207</span><span class="comment">   * {\bf{M}} = \int\limits_\Omega</span></div>
<div class="line"><span class="lineno">  208</span><span class="comment">   * \f]</span></div>
<div class="line"><span class="lineno">  209</span><span class="comment">   *</span></div>
<div class="line"><span class="lineno">  210</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  211</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpCalculateMassMatrix.html">OpCalculateMassMatrix</a></div>
<div class="line"><span class="lineno">  212</span>      : <span class="keyword">public</span> VolumeElementForcesAndSourcesCore::UserDataOperator {</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> <a class="code hl_variable" href="structOpCalculateMassMatrix.html#ae5f13349069a44c19f7deb9a58216d20">locK</a>;</div>
<div class="line"><span class="lineno">  215</span>    <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> <a class="code hl_variable" href="structOpCalculateMassMatrix.html#af17428fde4b2b7ad05c13e35acdc42d7">translocK</a>;</div>
<div class="line"><span class="lineno">  216</span>    <a class="code hl_struct" href="structMoFEM_1_1BlockData.html">BlockData</a> &amp;<a class="code hl_variable" href="structOpCalculateMassMatrix.html#a3190b48af86b5447c80493ebe42e5190">dAta</a>;</div>
<div class="line"><span class="lineno">  217</span>    <a class="code hl_struct" href="structConvectiveMassElement_1_1BlockData.html">MassBlockData</a> &amp;<a class="code hl_variable" href="structOpCalculateMassMatrix.html#a95de87bca20b20db046c64ccd99f3e04">massData</a>;</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; <a class="code hl_variable" href="structOpCalculateMassMatrix.html#abd5eebc4aebc88ad11ae0e4498ac19d7">commonData</a>;</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>    <a class="code hl_struct" href="structOpCalculateMassMatrix.html">OpCalculateMassMatrix</a>(<span class="keyword">const</span> std::string row_field,</div>
<div class="line"><span class="lineno">  222</span>                          <span class="keyword">const</span> std::string col_field, <a class="code hl_struct" href="structMoFEM_1_1BlockData.html">BlockData</a> &amp;data,</div>
<div class="line"><span class="lineno">  223</span>                          <a class="code hl_struct" href="structConvectiveMassElement_1_1BlockData.html">MassBlockData</a> &amp;mass_data,</div>
<div class="line"><span class="lineno">  224</span>                          boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;common_data,</div>
<div class="line"><span class="lineno">  225</span>                          <span class="keywordtype">bool</span> symm = <span class="keyword">true</span>)</div>
<div class="line"><span class="lineno">  226</span>        : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line"><span class="lineno">  227</span>              row_field, col_field, OPROWCOL, symm),</div>
<div class="line"><span class="lineno">  228</span>          <a class="code hl_variable" href="structOpCalculateMassMatrix.html#abd5eebc4aebc88ad11ae0e4498ac19d7">commonData</a>(common_data), <a class="code hl_variable" href="structOpCalculateMassMatrix.html#a3190b48af86b5447c80493ebe42e5190">dAta</a>(data), <a class="code hl_variable" href="structOpCalculateMassMatrix.html#a95de87bca20b20db046c64ccd99f3e04">massData</a>(mass_data) {}</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    PetscErrorCode <a class="code hl_function" href="structOpCalculateMassMatrix.html#a406c43391020849bfd93faf82c49351e">doWork</a>(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line"><span class="lineno">  231</span>                          EntityType col_type,</div>
<div class="line"><span class="lineno">  232</span>                          <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line"><span class="lineno">  233</span>                          <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line"><span class="lineno">  234</span>      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>      <span class="keyword">auto</span> get_tensor2 = [](<a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a>(</div>
<div class="line"><span class="lineno">  238</span>            &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 0, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 0, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line"><span class="lineno">  239</span>            &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 0, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 1, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line"><span class="lineno">  240</span>            &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 1, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 1, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2),</div>
<div class="line"><span class="lineno">  241</span>            &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 2, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 2, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line"><span class="lineno">  242</span>            &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 2, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line"><span class="lineno">  243</span>      };</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_dofs = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line"><span class="lineno">  246</span>      <span class="keywordflow">if</span> (!row_nb_dofs)</div>
<div class="line"><span class="lineno">  247</span>        <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  248</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_dofs = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line"><span class="lineno">  249</span>      <span class="keywordflow">if</span> (!col_nb_dofs)</div>
<div class="line"><span class="lineno">  250</span>        <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  251</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="structOpCalculateMassMatrix.html#a3190b48af86b5447c80493ebe42e5190">dAta</a>.tEts.find(getFEEntityHandle()) == <a class="code hl_variable" href="structOpCalculateMassMatrix.html#a3190b48af86b5447c80493ebe42e5190">dAta</a>.tEts.end()) {</div>
<div class="line"><span class="lineno">  252</span>        <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  253</span>      }</div>
<div class="line"><span class="lineno">  254</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="structOpCalculateMassMatrix.html#a95de87bca20b20db046c64ccd99f3e04">massData</a>.<a class="code hl_variable" href="structConvectiveMassElement_1_1BlockData.html#a0f6b9d30c7356f7bdc43f0e0a6763871">tEts</a>.find(getFEEntityHandle()) == <a class="code hl_variable" href="structOpCalculateMassMatrix.html#a95de87bca20b20db046c64ccd99f3e04">massData</a>.<a class="code hl_variable" href="structConvectiveMassElement_1_1BlockData.html#a0f6b9d30c7356f7bdc43f0e0a6763871">tEts</a>.end()) {</div>
<div class="line"><span class="lineno">  255</span>        <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  256</span>      }</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> diagonal_block =</div>
<div class="line"><span class="lineno">  259</span>          (row_type == col_type) &amp;&amp; (row_side == col_side);</div>
<div class="line"><span class="lineno">  260</span>      <span class="comment">// get number of integration points</span></div>
<div class="line"><span class="lineno">  261</span>      <span class="comment">// Set size can clear local tangent matrix</span></div>
<div class="line"><span class="lineno">  262</span>      <a class="code hl_variable" href="structOpCalculateMassMatrix.html#ae5f13349069a44c19f7deb9a58216d20">locK</a>.resize(row_nb_dofs, col_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  263</span>      <a class="code hl_variable" href="structOpCalculateMassMatrix.html#ae5f13349069a44c19f7deb9a58216d20">locK</a>.clear();</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_gauss_pts = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size1();</div>
<div class="line"><span class="lineno">  266</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_functions = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>      <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  269</span>      <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno">  270</span>      <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno">  271</span>      <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>      <span class="keywordtype">double</span> density = <a class="code hl_variable" href="structOpCalculateMassMatrix.html#a95de87bca20b20db046c64ccd99f3e04">massData</a>.<a class="code hl_variable" href="structConvectiveMassElement_1_1BlockData.html#a80d482c09c0814c12ae85e5887dc9cef">rho0</a>;</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>      <span class="comment">// get integration weights</span></div>
<div class="line"><span class="lineno">  276</span>      <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>      <span class="comment">// integrate local matrix for entity block</span></div>
<div class="line"><span class="lineno">  279</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != row_nb_gauss_pts; gg++) {</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>        <span class="keyword">auto</span> t_row_base_func = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>        <span class="comment">// Get volume and integration weight</span></div>
<div class="line"><span class="lineno">  284</span>        <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * t_w;</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row_bb = 0; row_bb != row_nb_dofs / 3; row_bb++) {</div>
<div class="line"><span class="lineno">  287</span>          <span class="keyword">auto</span> t_col_base_func = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line"><span class="lineno">  288</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col_bb = 0; col_bb != col_nb_dofs / 3; col_bb++) {</div>
<div class="line"><span class="lineno">  289</span>            <span class="keyword">auto</span> t_assemble = get_tensor2(<a class="code hl_variable" href="structOpCalculateMassMatrix.html#ae5f13349069a44c19f7deb9a58216d20">locK</a>, row_bb, col_bb);</div>
<div class="line"><span class="lineno">  290</span>            t_assemble(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) += density * t_row_base_func * t_col_base_func * <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a>;</div>
<div class="line"><span class="lineno">  291</span>            <span class="comment">// Next base function for column</span></div>
<div class="line"><span class="lineno">  292</span>            ++t_col_base_func;</div>
<div class="line"><span class="lineno">  293</span>          }</div>
<div class="line"><span class="lineno">  294</span>          <span class="comment">// Next base function for row</span></div>
<div class="line"><span class="lineno">  295</span>          ++t_row_base_func;</div>
<div class="line"><span class="lineno">  296</span>        }</div>
<div class="line"><span class="lineno">  297</span>        <span class="comment">// Next integration point for getting weight</span></div>
<div class="line"><span class="lineno">  298</span>        ++t_w;</div>
<div class="line"><span class="lineno">  299</span>      }</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getKSPB(), row_data, col_data, &amp;<a class="code hl_variable" href="structOpCalculateMassMatrix.html#ae5f13349069a44c19f7deb9a58216d20">locK</a>(0, 0),</div>
<div class="line"><span class="lineno">  302</span>                          ADD_VALUES);</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>      <span class="comment">// is symmetric</span></div>
<div class="line"><span class="lineno">  305</span>      <span class="keywordflow">if</span> (row_type != col_type || row_side != col_side) {</div>
<div class="line"><span class="lineno">  306</span>        <a class="code hl_variable" href="structOpCalculateMassMatrix.html#af17428fde4b2b7ad05c13e35acdc42d7">translocK</a>.resize(col_nb_dofs, row_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  307</span>        noalias(<a class="code hl_variable" href="structOpCalculateMassMatrix.html#af17428fde4b2b7ad05c13e35acdc42d7">translocK</a>) = trans(<a class="code hl_variable" href="structOpCalculateMassMatrix.html#ae5f13349069a44c19f7deb9a58216d20">locK</a>);</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getKSPB(), col_data, row_data, &amp;<a class="code hl_variable" href="structOpCalculateMassMatrix.html#af17428fde4b2b7ad05c13e35acdc42d7">translocK</a>(0, 0),</div>
<div class="line"><span class="lineno">  310</span>                            ADD_VALUES);</div>
<div class="line"><span class="lineno">  311</span>      }</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  314</span>    }</div>
<div class="line"><span class="lineno">  315</span>  };</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpCalculateStiffnessScaledByDensityField.html">OpCalculateStiffnessScaledByDensityField</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a> {</div>
<div class="line"><span class="lineno">  318</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  319</span>    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt;</div>
<div class="line"><span class="lineno">  320</span>        <a class="code hl_variable" href="structOpCalculateStiffnessScaledByDensityField.html#a6cbd5de30d5bc2b55d6f7eb7cab68aa3">blockSetsPtr</a>; <span class="comment">///&lt; Structure keeping data about problem, like</span><span class="comment"></span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">                      ///&lt; material parameters</span></div>
<div class="line"><span class="lineno">  322</span><span class="comment"></span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; <a class="code hl_variable" href="structOpCalculateStiffnessScaledByDensityField.html#a7a4a1760faabd11596f0dcca2f4d6bb8">dataAtPts</a>;</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>    boost::shared_ptr&lt;VectorDouble&gt; <a class="code hl_variable" href="structOpCalculateStiffnessScaledByDensityField.html#ab1a2305a5692299b9e3db83e6da604a7">rhoAtGaussPtsPtr</a>;</div>
<div class="line"><span class="lineno">  325</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="structOpCalculateStiffnessScaledByDensityField.html#abc81e05004bfc87aa64a28332ee8764e">rhoN</a>; <span class="comment">///&lt; exponent n in E(p) = E * (p / p_0)^n</span></div>
<div class="line"><span class="lineno">  326</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="structOpCalculateStiffnessScaledByDensityField.html#a5519d9158a78fce4d0df3e099e801c72">rHo0</a>; <span class="comment">///&lt; p_0 reference density in E(p) = E * (p / p_0)^n</span></div>
<div class="line"><span class="lineno">  327</span>                       <span class="comment">// // where p is density, E - youngs modulus</span></div>
<div class="line"><span class="lineno">  328</span>  <span class="keyword">public</span>:</div>
<div class="line"><span class="lineno">  329</span>    <a class="code hl_struct" href="structOpCalculateStiffnessScaledByDensityField.html">OpCalculateStiffnessScaledByDensityField</a>(</div>
<div class="line"><span class="lineno">  330</span>        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  331</span>        boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line"><span class="lineno">  332</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line"><span class="lineno">  333</span>        boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n,</div>
<div class="line"><span class="lineno">  334</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0);</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpCalculateStiffnessScaledByDensityField.html#ad024c65962b53bd790c786d8c703a5b6">doWork</a>(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  337</span>  };</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a> {</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  342</span>               boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line"><span class="lineno">  343</span>               <span class="keyword">const</span> <span class="keywordtype">char</span> type, <span class="keywordtype">bool</span> symm = <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  344</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  345</span><span class="comment">    /**</span></div>
<div class="line"><span class="lineno">  346</span><span class="comment">     * \brief Do calculations for give operator</span></div>
<div class="line"><span class="lineno">  347</span><span class="comment">     * @param  row_side row side number (local number) of entity on element</span></div>
<div class="line"><span class="lineno">  348</span><span class="comment">     * @param  col_side column side number (local number) of entity on element</span></div>
<div class="line"><span class="lineno">  349</span><span class="comment">     * @param  row_type type of row entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="lineno">  350</span><span class="comment">     * @param  col_type type of column entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="lineno">  351</span><span class="comment">     * @param  row_data data for row</span></div>
<div class="line"><span class="lineno">  352</span><span class="comment">     * @param  col_data data for column</span></div>
<div class="line"><span class="lineno">  353</span><span class="comment">     * @return          error code</span></div>
<div class="line"><span class="lineno">  354</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  355</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAssemble.html#a819bee26b41fc0540ad1b75dc647b6e8">doWork</a>(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line"><span class="lineno">  356</span>                          EntityType col_type, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line"><span class="lineno">  357</span>                          <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAssemble.html#a819bee26b41fc0540ad1b75dc647b6e8">doWork</a>(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  362</span>    <span class="comment">// Finite element stiffness sub-matrix K_ij</span></div>
<div class="line"><span class="lineno">  363</span>    <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> <a class="code hl_variable" href="structOpAssemble.html#aefb7d1e9b1517844b14075f185afd2aa">K</a>;</div>
<div class="line"><span class="lineno">  364</span>    <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> <a class="code hl_variable" href="structOpAssemble.html#aac9feff92340e14bc8f295148335abce">transK</a>;</div>
<div class="line"><span class="lineno">  365</span>    <a class="code hl_class" href="classUBlasVector_3_01double_01_4.html">VectorDouble</a> <a class="code hl_variable" href="structOpAssemble.html#a3f1100d3d0af18a117f4f9a0f9b6f257">nF</a>;</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; <a class="code hl_variable" href="structOpAssemble.html#a89cdaf7af4d557c5510cc1b48c3be7e9">dataAtPts</a>;</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#ae967f785b1cef58c8f4ea26e44112f83">VectorInt</a> <a class="code hl_variable" href="structOpAssemble.html#abbfe04a89e64fc8b4dbabf0ad01e1e32">rowIndices</a>;</div>
<div class="line"><span class="lineno">  370</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#ae967f785b1cef58c8f4ea26e44112f83">VectorInt</a> <a class="code hl_variable" href="structOpAssemble.html#ab08dbd4d77e97604f6d0f7b016e0b8b0">colIndices</a>;</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structOpAssemble.html#aac58d6aecf95cf5ba53135c8fd959575">nbRows</a>;           <span class="comment">///&lt; number of dofs on rows</span></div>
<div class="line"><span class="lineno">  373</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structOpAssemble.html#a10020c5c579681cbbb11290b5ad17aa5">nbCols</a>;           <span class="comment">///&lt; number if dof on column</span></div>
<div class="line"><span class="lineno">  374</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structOpAssemble.html#aa00cc105f94b4c178f7b4c0c8495c7e6">nbIntegrationPts</a>; <span class="comment">///&lt; number of integration points</span></div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="structOpAssemble.html#a1d19204f444042ab029d5991af7dc72c">isDiag</a>;          <span class="comment">///&lt; true if this block is on diagonal</span></div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>    <span class="keyword">virtual</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAssemble.html#a16fad0cd7f025348a9f8e9edd0160fd8">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    <span class="keyword">virtual</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAssemble.html#a16fad0cd7f025348a9f8e9edd0160fd8">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  380</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  381</span><span class="comment">    /**</span></div>
<div class="line"><span class="lineno">  382</span><span class="comment">     * \brief Assemble local entity block matrix</span></div>
<div class="line"><span class="lineno">  383</span><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="lineno">  384</span><span class="comment">     * @param  col_data column data (consist base functions on column</span></div>
<div class="line"><span class="lineno">  385</span><span class="comment">     * entity)</span></div>
<div class="line"><span class="lineno">  386</span><span class="comment">     * @return          error code</span></div>
<div class="line"><span class="lineno">  387</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  388</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAssemble.html#a807f314980fbe5e2c79ad962d96fac1e">aSsemble</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="lineno">  389</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  390</span><span class="comment">    /**</span></div>
<div class="line"><span class="lineno">  391</span><span class="comment">     * \brief Assemble local entity right-hand vector</span></div>
<div class="line"><span class="lineno">  392</span><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="lineno">  393</span><span class="comment">     * @param  col_data column data (consist base functions on column</span></div>
<div class="line"><span class="lineno">  394</span><span class="comment">     * entity)</span></div>
<div class="line"><span class="lineno">  395</span><span class="comment">     * @return          error code</span></div>
<div class="line"><span class="lineno">  396</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  397</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAssemble.html#a807f314980fbe5e2c79ad962d96fac1e">aSsemble</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  398</span>  };</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpRhs__dx.html">OpRhs_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>    <a class="code hl_struct" href="structOpRhs__dx.html">OpRhs_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  403</span>             boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  406</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpRhs__dx.html#ab1b64271ff33f9afb54c5dacb8c3a193">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  407</span>  };</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a class="code hl_struct" href="structOpLhs__dx__dx.html">OpLhs_dx_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>    <a class="code hl_struct" href="structOpLhs__dx__dx.html">OpLhs_dx_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  412</span>                boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="lineno">  415</span><span class="comment">    /**</span></div>
<div class="line"><span class="lineno">  416</span><span class="comment">     * \brief Integrate B^T D B operator</span></div>
<div class="line"><span class="lineno">  417</span><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="lineno">  418</span><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="lineno">  419</span><span class="comment">     * @return error code</span></div>
<div class="line"><span class="lineno">  420</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  421</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpLhs__dx__dx.html#adfe877c964315d650dbc2976fba1ac15">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="lineno">  422</span>  };</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpAleRhs__dx.html">OpAleRhs_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>    <a class="code hl_struct" href="structOpAleRhs__dx.html">OpAleRhs_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  427</span>                boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  430</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAleRhs__dx.html#a704519a3b08de7c64046ae1b16c89530">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  431</span>  };</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a class="code hl_struct" href="structOpAleLhs__dx__dx.html">OpAleLhs_dx_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>    <a class="code hl_struct" href="structOpAleLhs__dx__dx.html">OpAleLhs_dx_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  436</span>                   boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="lineno">  439</span><span class="comment">    /**</span></div>
<div class="line"><span class="lineno">  440</span><span class="comment">     * \brief Integrate B^T D B operator</span></div>
<div class="line"><span class="lineno">  441</span><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="lineno">  442</span><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="lineno">  443</span><span class="comment">     * @return error code</span></div>
<div class="line"><span class="lineno">  444</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  445</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAleLhs__dx__dx.html#a1d4dca94c6e841cd65d3c17b9ea8155e">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="lineno">  446</span>  };</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a class="code hl_struct" href="structOpAleLhs__dx__dX.html">OpAleLhs_dx_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>    <a class="code hl_struct" href="structOpAleLhs__dx__dX.html">OpAleLhs_dx_dX</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  451</span>                   boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="lineno">  454</span><span class="comment">    /**</span></div>
<div class="line"><span class="lineno">  455</span><span class="comment">     * \brief Integrate tangent stiffness for spatial momentum</span></div>
<div class="line"><span class="lineno">  456</span><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="lineno">  457</span><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="lineno">  458</span><span class="comment">     * @return error code</span></div>
<div class="line"><span class="lineno">  459</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  460</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAleLhs__dx__dX.html#aaedf597d64a89d65c15f716434be3207">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="lineno">  461</span>  };</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpAleLhsWithDensity__dx__dX.html">OpAleLhsWithDensity_dx_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>    boost::shared_ptr&lt;VectorDouble&gt; <a class="code hl_variable" href="structOpAleLhsWithDensity__dx__dX.html#a6a30f6da7b5b1d20dd5c99af58a6be6d">rhoAtGaussPtsPtr</a>;</div>
<div class="line"><span class="lineno">  466</span>    boost::shared_ptr&lt;MatrixDouble&gt; <a class="code hl_variable" href="structOpAleLhsWithDensity__dx__dX.html#ada7a7778a4510a34ef65b5edc7cec34c">rhoGradAtGaussPtsPtr</a>;</div>
<div class="line"><span class="lineno">  467</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="structOpAleLhsWithDensity__dx__dX.html#a7247a8ee1e2301aec4d03b7c9068d1fd">rhoN</a>;</div>
<div class="line"><span class="lineno">  468</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="structOpAleLhsWithDensity__dx__dX.html#a1af7f3297e2b995c1c78ee197390eb17">rHo0</a>;</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>    <a class="code hl_struct" href="structOpAleLhsWithDensity__dx__dX.html">OpAleLhsWithDensity_dx_dX</a>(</div>
<div class="line"><span class="lineno">  471</span>        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  472</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line"><span class="lineno">  473</span>        boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts,</div>
<div class="line"><span class="lineno">  474</span>        boost::shared_ptr&lt;MatrixDouble&gt; rho_grad_at_gauss_pts,</div>
<div class="line"><span class="lineno">  475</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0);</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="lineno">  478</span><span class="comment">    /**</span></div>
<div class="line"><span class="lineno">  479</span><span class="comment">     * \brief Integrate tangent stiffness for spatial momentum</span></div>
<div class="line"><span class="lineno">  480</span><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="lineno">  481</span><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="lineno">  482</span><span class="comment">     * @return error code</span></div>
<div class="line"><span class="lineno">  483</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  484</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAleLhsWithDensity__dx__dX.html#a2262cd826e1ca74123492531c2d25d16">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="lineno">  485</span>  };</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpAleLhsWithDensity__dX__dX.html">OpAleLhsWithDensity_dX_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>    boost::shared_ptr&lt;VectorDouble&gt; <a class="code hl_variable" href="structOpAleLhsWithDensity__dX__dX.html#a3f20ec4ea0cf4e8b51ad057c9012bbe5">rhoAtGaussPtsPtr</a>;</div>
<div class="line"><span class="lineno">  490</span>    boost::shared_ptr&lt;MatrixDouble&gt; <a class="code hl_variable" href="structOpAleLhsWithDensity__dX__dX.html#a82ce116ee2a785111c6a9d63fd871452">rhoGradAtGaussPtsPtr</a>;</div>
<div class="line"><span class="lineno">  491</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="structOpAleLhsWithDensity__dX__dX.html#a3007c61d353f2b36c10341a8a8f34895">rhoN</a>;</div>
<div class="line"><span class="lineno">  492</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="structOpAleLhsWithDensity__dX__dX.html#a7e7f6d71493237fa4829512ce75a8c90">rHo0</a>;</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>    <a class="code hl_struct" href="structOpAleLhsWithDensity__dX__dX.html">OpAleLhsWithDensity_dX_dX</a>(</div>
<div class="line"><span class="lineno">  495</span>        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  496</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line"><span class="lineno">  497</span>        boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts,</div>
<div class="line"><span class="lineno">  498</span>        boost::shared_ptr&lt;MatrixDouble&gt; rho_grad_at_gauss_pts,</div>
<div class="line"><span class="lineno">  499</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0);</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="lineno">  502</span><span class="comment">    /**</span></div>
<div class="line"><span class="lineno">  503</span><span class="comment">     * \brief Integrate tangent stiffness for material momentum</span></div>
<div class="line"><span class="lineno">  504</span><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="lineno">  505</span><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="lineno">  506</span><span class="comment">     * @return error code</span></div>
<div class="line"><span class="lineno">  507</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  508</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAleLhsWithDensity__dX__dX.html#a19ba774fdf5016c8e37672ebcfb9c783">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="lineno">  509</span>  };</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpAleRhs__dX.html">OpAleRhs_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>    <a class="code hl_struct" href="structOpAleRhs__dX.html">OpAleRhs_dX</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  514</span>                boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  517</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAleRhs__dX.html#a06926630fc12089665cdca33a740ca88">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  518</span>  };</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a class="code hl_struct" href="structOpAleLhs__dX__dX.html">OpAleLhs_dX_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    <a class="code hl_struct" href="structOpAleLhs__dX__dX.html">OpAleLhs_dX_dX</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  523</span>                   boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="lineno">  526</span><span class="comment">    /**</span></div>
<div class="line"><span class="lineno">  527</span><span class="comment">     * \brief Integrate tangent stiffness for material momentum</span></div>
<div class="line"><span class="lineno">  528</span><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="lineno">  529</span><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="lineno">  530</span><span class="comment">     * @return error code</span></div>
<div class="line"><span class="lineno">  531</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  532</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAleLhs__dX__dX.html#ac0c0f8469d09a3c8d5cf24086d7a2839">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="lineno">  533</span>  };</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a class="code hl_struct" href="structOpAleLhsPre__dX__dx.html">OpAleLhsPre_dX_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a> {</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>    <a class="code hl_struct" href="structOpAleLhsPre__dX__dx.html">OpAleLhsPre_dX_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  538</span>                      boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAleLhsPre__dX__dx.html#ab77b06ce6d9d7c4c318d9fa8953decda">doWork</a>(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>  <span class="keyword">private</span>:</div>
<div class="line"><span class="lineno">  543</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; <a class="code hl_variable" href="structOpAleLhsPre__dX__dx.html#aa0ea6ee00cb6a9b468b9215324143d5a">dataAtPts</a>;</div>
<div class="line"><span class="lineno">  544</span>  };</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpAleLhs__dX__dx.html">OpAleLhs_dX_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>    <a class="code hl_struct" href="structOpAleLhs__dX__dx.html">OpAleLhs_dX_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  549</span>                   boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line"><span class="lineno">  550</span>        : <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, <a class="code hl_enumvalue" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">OPROWCOL</a>, false) {}</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="lineno">  553</span><span class="comment">    /**</span></div>
<div class="line"><span class="lineno">  554</span><span class="comment">     * \brief Integrate tangent stiffness for material momentum</span></div>
<div class="line"><span class="lineno">  555</span><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="lineno">  556</span><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="lineno">  557</span><span class="comment">     * @return error code</span></div>
<div class="line"><span class="lineno">  558</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  559</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAleLhs__dX__dx.html#ac34756cda59cfebc772ac5b1dfd56949">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="lineno">  560</span>  };</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt; <span class="keyword">struct </span><a class="code hl_struct" href="structOpAnalyticalInternalStrain__dx.html">OpAnalyticalInternalStrain_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    <span class="keyword">typedef</span> boost::function&lt;</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>        <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a>(</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a>&lt;<a class="code hl_class" href="classFTensor_1_1PackPtr.html">FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt; &amp;t_coords</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>            )</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>        &gt;</div>
<div class="line"><span class="lineno">  573</span>        <a class="code hl_typedef" href="structOpAnalyticalInternalStrain__dx.html#a469dff62979e6ddb454ceed2ab9ccabf">StrainFunction</a>;</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>    <a class="code hl_struct" href="structOpAnalyticalInternalStrain__dx.html">OpAnalyticalInternalStrain_dx</a>(</div>
<div class="line"><span class="lineno">  576</span>        <span class="keyword">const</span> std::string row_field,</div>
<div class="line"><span class="lineno">  577</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line"><span class="lineno">  578</span>        <a class="code hl_typedef" href="structOpAnalyticalInternalStrain__dx.html#a469dff62979e6ddb454ceed2ab9ccabf">StrainFunction</a> strain_fun);</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  581</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAnalyticalInternalStrain__dx.html#a6b454377db01e5d1cda97da9fc8ff89c">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  582</span>    <a class="code hl_typedef" href="structOpAnalyticalInternalStrain__dx.html#a469dff62979e6ddb454ceed2ab9ccabf">StrainFunction</a> <a class="code hl_variable" href="structOpAnalyticalInternalStrain__dx.html#abf86f95b2f931a46361f2bf52d892701">strainFun</a>;</div>
<div class="line"><span class="lineno">  583</span>  };</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt; <span class="keyword">struct </span><a class="code hl_struct" href="structOpAnalyticalInternalAleStrain__dX.html">OpAnalyticalInternalAleStrain_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>    <span class="keyword">typedef</span> boost::function&lt;</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>        <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a>(</div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span>            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a>&lt;<a class="code hl_class" href="classFTensor_1_1PackPtr.html">FTensor::PackPtr&lt;double *, 1&gt;</a>, 3&gt; &amp;t_coords</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>            )</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>        &gt;</div>
<div class="line"><span class="lineno">  596</span>        <a class="code hl_typedef" href="structOpAnalyticalInternalAleStrain__dX.html#ad9c7924be8426bcc8ecfe16cde7f5910">StrainFunction</a>;</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>    <a class="code hl_struct" href="structOpAnalyticalInternalAleStrain__dX.html">OpAnalyticalInternalAleStrain_dX</a>(</div>
<div class="line"><span class="lineno">  599</span>        <span class="keyword">const</span> std::string row_field,</div>
<div class="line"><span class="lineno">  600</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line"><span class="lineno">  601</span>        <a class="code hl_typedef" href="structOpAnalyticalInternalAleStrain__dX.html#ad9c7924be8426bcc8ecfe16cde7f5910">StrainFunction</a> strain_fun,</div>
<div class="line"><span class="lineno">  602</span>        boost::shared_ptr&lt;MatrixDouble&gt; mat_pos_at_pts_ptr);</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  605</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAnalyticalInternalAleStrain__dX.html#a2820da81b6c5dd054bee521c70a53317">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  606</span>    <a class="code hl_typedef" href="structOpAnalyticalInternalAleStrain__dX.html#ad9c7924be8426bcc8ecfe16cde7f5910">StrainFunction</a> <a class="code hl_variable" href="structOpAnalyticalInternalAleStrain__dX.html#af12f093f369ff55c4b339c71e94e2d27">strainFun</a>;</div>
<div class="line"><span class="lineno">  607</span>    boost::shared_ptr&lt;MatrixDouble&gt; <a class="code hl_variable" href="structOpAnalyticalInternalAleStrain__dX.html#a806272c893b15c760306db520bf4edb5">matPosAtPtsPtr</a>;</div>
<div class="line"><span class="lineno">  608</span>  };</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt; <span class="keyword">struct </span><a class="code hl_struct" href="structOpAnalyticalInternalAleStrain__dx.html">OpAnalyticalInternalAleStrain_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a> {</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span>    <span class="keyword">typedef</span> boost::function&lt;</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>        <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a>(</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a>&lt;<a class="code hl_class" href="classFTensor_1_1PackPtr.html">FTensor::PackPtr&lt;double *, 1&gt;</a>, 3&gt; &amp;t_coords</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>            )</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>        &gt;</div>
<div class="line"><span class="lineno">  621</span>        <a class="code hl_typedef" href="structOpAnalyticalInternalAleStrain__dx.html#a860937c7f4f83ca876fe15f21d68650d">StrainFunction</a>;</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <a class="code hl_struct" href="structOpAnalyticalInternalAleStrain__dx.html">OpAnalyticalInternalAleStrain_dx</a>(</div>
<div class="line"><span class="lineno">  624</span>        <span class="keyword">const</span> std::string row_field,</div>
<div class="line"><span class="lineno">  625</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line"><span class="lineno">  626</span>        <a class="code hl_typedef" href="structOpAnalyticalInternalAleStrain__dx.html#a860937c7f4f83ca876fe15f21d68650d">StrainFunction</a> strain_fun,</div>
<div class="line"><span class="lineno">  627</span>        boost::shared_ptr&lt;MatrixDouble&gt; mat_pos_at_pts_ptr);</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>  <span class="keyword">protected</span>:</div>
<div class="line"><span class="lineno">  630</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpAnalyticalInternalAleStrain__dx.html#a73dbd4edae5dcaca8b923a69bf15f4d6">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="lineno">  631</span>    <a class="code hl_typedef" href="structOpAnalyticalInternalAleStrain__dx.html#a860937c7f4f83ca876fe15f21d68650d">StrainFunction</a> <a class="code hl_variable" href="structOpAnalyticalInternalAleStrain__dx.html#a87e1fab6e4f7c085b6f24a5713a395eb">strainFun</a>;</div>
<div class="line"><span class="lineno">  632</span>    boost::shared_ptr&lt;MatrixDouble&gt; <a class="code hl_variable" href="structOpAnalyticalInternalAleStrain__dx.html#a4bf5ceee5e3320e5a173f5ff93116879">matPosAtPtsPtr</a>;</div>
<div class="line"><span class="lineno">  633</span>  };</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>  <span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="lineno">  636</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structOpPostProcHookeElement.html">OpPostProcHookeElement</a> : <span class="keyword">public</span> ELEMENT::UserDataOperator {</div>
<div class="line"><span class="lineno">  637</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; <a class="code hl_variable" href="structOpPostProcHookeElement.html#ad3f62c9a70b271698ea8ff9e79116ec7">dataAtPts</a>;</div>
<div class="line"><span class="lineno">  638</span>    map&lt;int, BlockData&gt;</div>
<div class="line"><span class="lineno">  639</span>        &amp;<a class="code hl_variable" href="structOpPostProcHookeElement.html#a9ae63dfef7612b59b276714feb4089e7">blockSetsPtr</a>; <span class="comment">// FIXME: (works only with the first block)</span></div>
<div class="line"><span class="lineno">  640</span>    moab::Interface &amp;<a class="code hl_variable" href="structOpPostProcHookeElement.html#aa686a9cae8d008461d5a5ef054e97d49">postProcMesh</a>;</div>
<div class="line"><span class="lineno">  641</span>    std::vector&lt;EntityHandle&gt; &amp;<a class="code hl_variable" href="structOpPostProcHookeElement.html#a4e682c7256b923b5a384d68a748ca85f">mapGaussPts</a>;</div>
<div class="line"><span class="lineno">  642</span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="structOpPostProcHookeElement.html#a199f21146d712f90e908b2c66e942b72">isALE</a>;</div>
<div class="line"><span class="lineno">  643</span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="structOpPostProcHookeElement.html#aa000fec304675ef65368b66bb6908a92">isFieldDisp</a>;</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>    <a class="code hl_struct" href="structOpPostProcHookeElement.html">OpPostProcHookeElement</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> row_field,</div>
<div class="line"><span class="lineno">  646</span>                           boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line"><span class="lineno">  647</span>                           map&lt;int, BlockData&gt; &amp;block_sets_ptr,</div>
<div class="line"><span class="lineno">  648</span>                           moab::Interface &amp;post_proc_mesh,</div>
<div class="line"><span class="lineno">  649</span>                           std::vector&lt;EntityHandle&gt; &amp;map_gauss_pts,</div>
<div class="line"><span class="lineno">  650</span>                           <span class="keywordtype">bool</span> is_ale = <span class="keyword">false</span>, <span class="keywordtype">bool</span> is_field_disp = <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>    <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structOpPostProcHookeElement.html#ab5cc40adaf02bf8c7d80a192baf88930">doWork</a>(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line"><span class="lineno">  653</span>                          <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data);</div>
<div class="line"><span class="lineno">  654</span>  };</div>
<div class="line"><span class="lineno">  655</span> </div>
<div class="line"><span class="lineno">  656</span>  <span class="keyword">static</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  657</span>  <a class="code hl_function" href="HookeElement_8hpp.html#acbad9d6ebbe635c14d71762f3c5b6fcd">setBlocks</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line"><span class="lineno">  658</span>            boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr);</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>  <span class="keyword">static</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  661</span>  <a class="code hl_function" href="HookeElement_8hpp.html#a6237f89a3868d67c0a4dbd704ee03990">addElasticElement</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line"><span class="lineno">  662</span>                    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line"><span class="lineno">  663</span>                    <span class="keyword">const</span> std::string element_name, <span class="keyword">const</span> std::string x_field,</div>
<div class="line"><span class="lineno">  664</span>                    <span class="keyword">const</span> std::string X_field, <span class="keyword">const</span> <span class="keywordtype">bool</span> ale);</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>  <span class="keyword">static</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  667</span>  <a class="code hl_function" href="HookeElement_8hpp.html#a76d1b67e03b64ca1ae3edb7b0788e578">setOperators</a>(boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_lhs_ptr,</div>
<div class="line"><span class="lineno">  668</span>               boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_rhs_ptr,</div>
<div class="line"><span class="lineno">  669</span>               boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; block_sets_ptr,</div>
<div class="line"><span class="lineno">  670</span>               <span class="keyword">const</span> std::string x_field, <span class="keyword">const</span> std::string X_field,</div>
<div class="line"><span class="lineno">  671</span>               <span class="keyword">const</span> <span class="keywordtype">bool</span> ale, <span class="keyword">const</span> <span class="keywordtype">bool</span> field_disp,</div>
<div class="line"><span class="lineno">  672</span>               <span class="keyword">const</span> EntityType type = MBTET,</div>
<div class="line"><span class="lineno">  673</span>               boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts = <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>  <span class="keyword">static</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno">  676</span>  <a class="code hl_function" href="HookeElement_8hpp.html#adc8b2d0d211d4aa4590cf708695ddcaa">calculateEnergy</a>(DM dm, boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; block_sets_ptr,</div>
<div class="line"><span class="lineno">  677</span>                  <span class="keyword">const</span> std::string x_field, <span class="keyword">const</span> std::string X_field,</div>
<div class="line"><span class="lineno">  678</span>                  <span class="keyword">const</span> <span class="keywordtype">bool</span> ale, <span class="keyword">const</span> <span class="keywordtype">bool</span> field_disp,</div>
<div class="line"><span class="lineno">  679</span>                  <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a> &amp;v_energy_ptr);</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span><span class="keyword">private</span>:</div>
<div class="line"><span class="lineno">  682</span>  <a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> <a class="code hl_variable" href="HookeElement_8hpp.html#ad231e62173ae2a67709c00b3c866a198">invJac</a>;</div>
<div class="line"><span class="lineno">  683</span>};</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span><span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> D&gt;</div>
<div class="line"><span class="lineno">  686</span>HookeElement::OpCalculateStrain&lt;D&gt;::OpCalculateStrain(</div>
<div class="line"><span class="lineno">  687</span>    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  688</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line"><span class="lineno">  689</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line"><span class="lineno">  690</span>      dataAtPts(data_at_pts) {</div>
<div class="line"><span class="lineno">  691</span>  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  692</span>}</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span><span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> D&gt;</div>
<div class="line"><span class="lineno">  695</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateStrain&lt;D&gt;::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line"><span class="lineno">  696</span>                                                          EntityType row_type,</div>
<div class="line"><span class="lineno">  697</span>                                                          <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line"><span class="lineno">  698</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  699</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  700</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno">  701</span>  <span class="comment">// get number of integration points</span></div>
<div class="line"><span class="lineno">  702</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line"><span class="lineno">  703</span>  dataAtPts-&gt;smallStrainMat-&gt;resize(6, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  704</span>  <span class="keyword">auto</span> t_strain = getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;smallStrainMat));</div>
<div class="line"><span class="lineno">  705</span>  <span class="keyword">auto</span> t_h = getFTensor2FromMat&lt;3, 3&gt;(*(dataAtPts-&gt;hMat));</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"><span class="lineno">  708</span>    t_strain(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_h(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2.;</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>    <span class="comment">// If displacement field, not field o spatial positons is given</span></div>
<div class="line"><span class="lineno">  711</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>) {</div>
<div class="line"><span class="lineno">  712</span>      t_strain(0, 0) -= 1;</div>
<div class="line"><span class="lineno">  713</span>      t_strain(1, 1) -= 1;</div>
<div class="line"><span class="lineno">  714</span>      t_strain(2, 2) -= 1;</div>
<div class="line"><span class="lineno">  715</span>    }</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>    ++t_strain;</div>
<div class="line"><span class="lineno">  718</span>    ++t_h;</div>
<div class="line"><span class="lineno">  719</span>  }</div>
<div class="line"><span class="lineno">  720</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  721</span>}</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno">  724</span>HookeElement::OpAleLhs_dx_dx&lt;S&gt;::OpAleLhs_dx_dx(</div>
<div class="line"><span class="lineno">  725</span>    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  726</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line"><span class="lineno">  727</span>    : <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, true) {}</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno">  730</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleLhs_dx_dx&lt;S&gt;::iNtegrate(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line"><span class="lineno">  731</span>                                                          <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line"><span class="lineno">  732</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line"><span class="lineno">  735</span>  <span class="comment">// second order tensor</span></div>
<div class="line"><span class="lineno">  736</span>  <span class="keyword">auto</span> get_tensor2 = [](<a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line"><span class="lineno">  737</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line"><span class="lineno">  738</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line"><span class="lineno">  739</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line"><span class="lineno">  740</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line"><span class="lineno">  741</span>  };</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  744</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno">  745</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno">  746</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>  <span class="comment">// get element volume</span></div>
<div class="line"><span class="lineno">  749</span>  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>  <span class="comment">// get intergrayion weights</span></div>
<div class="line"><span class="lineno">  752</span>  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line"><span class="lineno">  755</span>  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line"><span class="lineno">  756</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line"><span class="lineno">  759</span>  <span class="comment">// symmetry)</span></div>
<div class="line"><span class="lineno">  760</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno">  761</span>      <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"><span class="lineno">  764</span>  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>  <span class="comment">// iterate over integration points</span></div>
<div class="line"><span class="lineno">  767</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line"><span class="lineno">  770</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>    <span class="comment">// iterate over row base functions</span></div>
<div class="line"><span class="lineno">  773</span>    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line"><span class="lineno">  774</span>    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>      <span class="comment">// get sub matrix for the row</span></div>
<div class="line"><span class="lineno">  777</span>      <span class="keyword">auto</span> t_m = get_tensor2(<a class="code hl_variable" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, 3 * rr, 0);</div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span>      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line"><span class="lineno">  780</span>      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>      <a class="code hl_class" href="classFTensor_1_1Christof.html">FTensor::Christof&lt;double, 3, 3&gt;</a> t_rowD;</div>
<div class="line"><span class="lineno">  783</span>      <span class="comment">// I mix up the indices here so that it behaves like a</span></div>
<div class="line"><span class="lineno">  784</span>      <span class="comment">// Dg.  That way I don&#39;t have to have a separate wrapper</span></div>
<div class="line"><span class="lineno">  785</span>      <span class="comment">// class Christof_Expr, which simplifies things.</span></div>
<div class="line"><span class="lineno">  786</span>      t_rowD(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * (<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line"><span class="lineno">  789</span>      <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="line"><span class="lineno">  791</span>      <span class="comment">// iterate column base functions</span></div>
<div class="line"><span class="lineno">  792</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span>        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_col_diff_base_pulled;</div>
<div class="line"><span class="lineno">  795</span>        t_col_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_col_diff_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_invH(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>        <span class="comment">// integrate block local stiffens matrix</span></div>
<div class="line"><span class="lineno">  798</span>        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) += t_rowD(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>);</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>        <span class="comment">// move to next column base function</span></div>
<div class="line"><span class="lineno">  801</span>        ++t_col_diff_base;</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line"><span class="lineno">  804</span>        ++t_m;</div>
<div class="line"><span class="lineno">  805</span>      }</div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span>      <span class="comment">// move to next row base function</span></div>
<div class="line"><span class="lineno">  808</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno">  809</span>    }</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line"><span class="lineno">  812</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>    <span class="comment">// move to next integration weight</span></div>
<div class="line"><span class="lineno">  815</span>    ++t_w;</div>
<div class="line"><span class="lineno">  816</span>    ++t_D;</div>
<div class="line"><span class="lineno">  817</span>    ++t_invH;</div>
<div class="line"><span class="lineno">  818</span>  }</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  821</span>}</div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno">  824</span>HookeElement::OpCalculateHomogeneousStiffness&lt;S&gt;::</div>
<div class="line"><span class="lineno">  825</span>    OpCalculateHomogeneousStiffness(</div>
<div class="line"><span class="lineno">  826</span>        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  827</span>        boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line"><span class="lineno">  828</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts)</div>
<div class="line"><span class="lineno">  829</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line"><span class="lineno">  830</span>      blockSetsPtr(block_sets_ptr), dataAtPts(data_at_pts) {</div>
<div class="line"><span class="lineno">  831</span>  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  832</span>}</div>
<div class="line"><span class="lineno">  833</span> </div>
<div class="line"><span class="lineno">  834</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno">  835</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateHomogeneousStiffness&lt;S&gt;::doWork(</div>
<div class="line"><span class="lineno">  836</span>    <span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line"><span class="lineno">  837</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : (*blockSetsPtr)) {</div>
<div class="line"><span class="lineno">  840</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts.find(getFEEntityHandle()) != <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts.end()) {</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>      dataAtPts-&gt;stiffnessMat-&gt;resize(36, 1, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  843</span>      <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno">  844</span>          <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno">  845</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> young = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.E;</div>
<div class="line"><span class="lineno">  846</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> poisson = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.PoissonRatio;</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span>      <span class="comment">// coefficient used in intermediate calculation</span></div>
<div class="line"><span class="lineno">  849</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> coefficient = young / ((1 + poisson) * (1 - 2 * poisson));</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>      <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  852</span>      <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno">  853</span>      <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno">  854</span>      <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>      t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = 0.;</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>      t_D(0, 0, 0, 0) = 1 - poisson;</div>
<div class="line"><span class="lineno">  859</span>      t_D(1, 1, 1, 1) = 1 - poisson;</div>
<div class="line"><span class="lineno">  860</span>      t_D(2, 2, 2, 2) = 1 - poisson;</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>      t_D(0, 1, 0, 1) = 0.5 * (1 - 2 * poisson);</div>
<div class="line"><span class="lineno">  863</span>      t_D(0, 2, 0, 2) = 0.5 * (1 - 2 * poisson);</div>
<div class="line"><span class="lineno">  864</span>      t_D(1, 2, 1, 2) = 0.5 * (1 - 2 * poisson);</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>      t_D(0, 0, 1, 1) = poisson;</div>
<div class="line"><span class="lineno">  867</span>      t_D(1, 1, 0, 0) = poisson;</div>
<div class="line"><span class="lineno">  868</span>      t_D(0, 0, 2, 2) = poisson;</div>
<div class="line"><span class="lineno">  869</span>      t_D(2, 2, 0, 0) = poisson;</div>
<div class="line"><span class="lineno">  870</span>      t_D(1, 1, 2, 2) = poisson;</div>
<div class="line"><span class="lineno">  871</span>      t_D(2, 2, 1, 1) = poisson;</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>      t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= coefficient;</div>
<div class="line"><span class="lineno">  874</span> </div>
<div class="line"><span class="lineno">  875</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  876</span>    }</div>
<div class="line"><span class="lineno">  877</span>  }</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  880</span>}</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno">  883</span>HookeElement::OpCalculateStress&lt;S&gt;::OpCalculateStress(</div>
<div class="line"><span class="lineno">  884</span>    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  885</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts)</div>
<div class="line"><span class="lineno">  886</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line"><span class="lineno">  887</span>      dataAtPts(data_at_pts) {</div>
<div class="line"><span class="lineno">  888</span>  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  889</span>}</div>
<div class="line"><span class="lineno">  890</span> </div>
<div class="line"><span class="lineno">  891</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno">  892</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateStress&lt;S&gt;::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line"><span class="lineno">  893</span>                                                          EntityType row_type,</div>
<div class="line"><span class="lineno">  894</span>                                                          <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line"><span class="lineno">  895</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  896</span>  <span class="comment">// get number of integration points</span></div>
<div class="line"><span class="lineno">  897</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line"><span class="lineno">  898</span>  <span class="keyword">auto</span> t_strain = getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;smallStrainMat));</div>
<div class="line"><span class="lineno">  899</span>  dataAtPts-&gt;cauchyStressMat-&gt;resize(6, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  900</span>  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line"><span class="lineno">  901</span>      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  904</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno">  905</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno">  906</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>  <span class="comment">// elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line"><span class="lineno">  909</span>  <span class="comment">// symmetry)</span></div>
<div class="line"><span class="lineno">  910</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno">  911</span>      <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno">  912</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"><span class="lineno">  913</span>    t_cauchy_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_strain(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno">  914</span>    ++t_strain;</div>
<div class="line"><span class="lineno">  915</span>    ++t_cauchy_stress;</div>
<div class="line"><span class="lineno">  916</span>    ++t_D;</div>
<div class="line"><span class="lineno">  917</span>  }</div>
<div class="line"><span class="lineno">  918</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  919</span>}</div>
<div class="line"><span class="lineno">  920</span> </div>
<div class="line"><span class="lineno">  921</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno">  922</span>HookeElement::OpLhs_dx_dx&lt;S&gt;::OpLhs_dx_dx(</div>
<div class="line"><span class="lineno">  923</span>    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno">  924</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line"><span class="lineno">  925</span>    : <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, true) {}</div>
<div class="line"><span class="lineno">  926</span> </div>
<div class="line"><span class="lineno">  927</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno">  928</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpLhs_dx_dx&lt;S&gt;::iNtegrate(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line"><span class="lineno">  929</span>                                                       <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line"><span class="lineno">  930</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line"><span class="lineno">  933</span>  <span class="comment">// second order tensor</span></div>
<div class="line"><span class="lineno">  934</span>  <span class="keyword">auto</span> get_tensor2 = [](<a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line"><span class="lineno">  935</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line"><span class="lineno">  936</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line"><span class="lineno">  937</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line"><span class="lineno">  938</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line"><span class="lineno">  939</span>  };</div>
<div class="line"><span class="lineno">  940</span> </div>
<div class="line"><span class="lineno">  941</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  942</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno">  943</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno">  944</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno">  945</span> </div>
<div class="line"><span class="lineno">  946</span>  <span class="comment">// get element volume</span></div>
<div class="line"><span class="lineno">  947</span>  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"><span class="lineno">  948</span> </div>
<div class="line"><span class="lineno">  949</span>  <span class="comment">// get intergrayion weights</span></div>
<div class="line"><span class="lineno">  950</span>  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span>  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line"><span class="lineno">  953</span>  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line"><span class="lineno">  954</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span>  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line"><span class="lineno">  957</span>  <span class="comment">// symmetry)</span></div>
<div class="line"><span class="lineno">  958</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno">  959</span>      <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno">  960</span> </div>
<div class="line"><span class="lineno">  961</span>  <span class="comment">// iterate over integration points</span></div>
<div class="line"><span class="lineno">  962</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"><span class="lineno">  963</span> </div>
<div class="line"><span class="lineno">  964</span>    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line"><span class="lineno">  965</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol;</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>    <span class="comment">// iterate over row base functions</span></div>
<div class="line"><span class="lineno">  968</span>    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line"><span class="lineno">  969</span>    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span>      <span class="comment">// get sub matrix for the row</span></div>
<div class="line"><span class="lineno">  972</span>      <span class="keyword">auto</span> t_m = get_tensor2(<a class="code hl_variable" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, 3 * rr, 0);</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line"><span class="lineno">  975</span>      <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>      <a class="code hl_class" href="classFTensor_1_1Christof.html">FTensor::Christof&lt;double, 3, 3&gt;</a> t_rowD;</div>
<div class="line"><span class="lineno">  978</span>      <span class="comment">// I mix up the indices here so that it behaves like a</span></div>
<div class="line"><span class="lineno">  979</span>      <span class="comment">// Dg.  That way I don&#39;t have to have a separate wrapper</span></div>
<div class="line"><span class="lineno">  980</span>      <span class="comment">// class Christof_Expr, which simplifies things.</span></div>
<div class="line"><span class="lineno">  981</span>      t_rowD(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * (<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"><span class="lineno">  982</span> </div>
<div class="line"><span class="lineno">  983</span>      <span class="comment">// iterate column base functions</span></div>
<div class="line"><span class="lineno">  984</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"><span class="lineno">  985</span> </div>
<div class="line"><span class="lineno">  986</span>        <span class="comment">// integrate block local stiffens matrix</span></div>
<div class="line"><span class="lineno">  987</span>        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) += t_rowD(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>);</div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>        <span class="comment">// move to next column base function</span></div>
<div class="line"><span class="lineno">  990</span>        ++t_col_diff_base;</div>
<div class="line"><span class="lineno">  991</span> </div>
<div class="line"><span class="lineno">  992</span>        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line"><span class="lineno">  993</span>        ++t_m;</div>
<div class="line"><span class="lineno">  994</span>      }</div>
<div class="line"><span class="lineno">  995</span> </div>
<div class="line"><span class="lineno">  996</span>      <span class="comment">// move to next row base function</span></div>
<div class="line"><span class="lineno">  997</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno">  998</span>    }</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span>    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line"><span class="lineno"> 1001</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span>    <span class="comment">// move to next integration weight</span></div>
<div class="line"><span class="lineno"> 1004</span>    ++t_w;</div>
<div class="line"><span class="lineno"> 1005</span>    ++t_D;</div>
<div class="line"><span class="lineno"> 1006</span>  }</div>
<div class="line"><span class="lineno"> 1007</span> </div>
<div class="line"><span class="lineno"> 1008</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1009</span>}</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1012</span>HookeElement::OpAleLhs_dx_dX&lt;S&gt;::OpAleLhs_dx_dX(</div>
<div class="line"><span class="lineno"> 1013</span>    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno"> 1014</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line"><span class="lineno"> 1015</span>    : <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, false) {}</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1018</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleLhs_dx_dX&lt;S&gt;::iNtegrate(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line"><span class="lineno"> 1019</span>                                                          <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line"><span class="lineno"> 1020</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="line"><span class="lineno"> 1022</span>  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line"><span class="lineno"> 1023</span>  <span class="comment">// second order tensor</span></div>
<div class="line"><span class="lineno"> 1024</span>  <span class="keyword">auto</span> get_tensor2 = [](<a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line"><span class="lineno"> 1025</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line"><span class="lineno"> 1026</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line"><span class="lineno"> 1027</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line"><span class="lineno"> 1028</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line"><span class="lineno"> 1029</span>  };</div>
<div class="line"><span class="lineno"> 1030</span> </div>
<div class="line"><span class="lineno"> 1031</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1032</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno"> 1033</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno"> 1034</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno"> 1035</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;m&#39;</span>, 3&gt; <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>;</div>
<div class="line"><span class="lineno"> 1036</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;n&#39;</span>, 3&gt; <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>;</div>
<div class="line"><span class="lineno"> 1037</span> </div>
<div class="line"><span class="lineno"> 1038</span>  <span class="comment">// get element volume</span></div>
<div class="line"><span class="lineno"> 1039</span>  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"><span class="lineno"> 1040</span> </div>
<div class="line"><span class="lineno"> 1041</span>  <span class="comment">// get intergrayion weights</span></div>
<div class="line"><span class="lineno"> 1042</span>  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"><span class="lineno"> 1043</span> </div>
<div class="line"><span class="lineno"> 1044</span>  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line"><span class="lineno"> 1045</span>  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line"><span class="lineno"> 1046</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line"><span class="lineno"> 1049</span>  <span class="comment">// symmetry)</span></div>
<div class="line"><span class="lineno"> 1050</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno"> 1051</span>      <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno"> 1052</span> </div>
<div class="line"><span class="lineno"> 1053</span>  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line"><span class="lineno"> 1054</span>      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line"><span class="lineno"> 1055</span>  <span class="keyword">auto</span> t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</div>
<div class="line"><span class="lineno"> 1056</span>  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"><span class="lineno"> 1057</span>  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"><span class="lineno"> 1058</span> </div>
<div class="line"><span class="lineno"> 1059</span>  <span class="comment">// iterate over integration points</span></div>
<div class="line"><span class="lineno"> 1060</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line"><span class="lineno"> 1063</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"><span class="lineno"> 1064</span> </div>
<div class="line"><span class="lineno"> 1065</span>    <a class="code hl_class" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;double, 3, 3, 3, 3&gt;</a> t_F_dX;</div>
<div class="line"><span class="lineno"> 1066</span>    t_F_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = -(t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) * t_invH(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>)) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1067</span> </div>
<div class="line"><span class="lineno"> 1068</span>    <span class="comment">// iterate over row base functions</span></div>
<div class="line"><span class="lineno"> 1069</span>    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line"><span class="lineno"> 1070</span>    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"><span class="lineno"> 1071</span> </div>
<div class="line"><span class="lineno"> 1072</span>      <span class="comment">// get sub matrix for the row</span></div>
<div class="line"><span class="lineno"> 1073</span>      <span class="keyword">auto</span> t_m = get_tensor2(<a class="code hl_variable" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, 3 * rr, 0);</div>
<div class="line"><span class="lineno"> 1074</span> </div>
<div class="line"><span class="lineno"> 1075</span>      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line"><span class="lineno"> 1076</span>      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1077</span> </div>
<div class="line"><span class="lineno"> 1078</span>      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_stress;</div>
<div class="line"><span class="lineno"> 1079</span>      t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>      <a class="code hl_class" href="classFTensor_1_1Tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_diff_base_pulled_dX;</div>
<div class="line"><span class="lineno"> 1082</span>      t_row_diff_base_pulled_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) =</div>
<div class="line"><span class="lineno"> 1083</span>          -(t_invH(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_row_diff_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1084</span> </div>
<div class="line"><span class="lineno"> 1085</span>      <a class="code hl_class" href="classFTensor_1_1Tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_dX_stress;</div>
<div class="line"><span class="lineno"> 1086</span>      t_row_dX_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) =</div>
<div class="line"><span class="lineno"> 1087</span>          <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * (t_row_diff_base_pulled_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_cauchy_stress(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"><span class="lineno"> 1088</span> </div>
<div class="line"><span class="lineno"> 1089</span>      <a class="code hl_class" href="classFTensor_1_1Christof.html">FTensor::Christof&lt;double, 3, 3&gt;</a> t_row_D;</div>
<div class="line"><span class="lineno"> 1090</span>      t_row_D(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = (<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1091</span> </div>
<div class="line"><span class="lineno"> 1092</span>      <a class="code hl_class" href="classFTensor_1_1Tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_stress_dX;</div>
<div class="line"><span class="lineno"> 1093</span>      <span class="comment">// FIXME: This operator is not implemented, doing operation by hand</span></div>
<div class="line"><span class="lineno"> 1094</span>      <span class="comment">// t_row_stress_dX(i, m, n) = t_row_D(i, k, l) * t_F_dX(k, l, m, n);</span></div>
<div class="line"><span class="lineno"> 1095</span>      t_row_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = 0;</div>
<div class="line"><span class="lineno"> 1096</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line"><span class="lineno"> 1097</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mm = 0; mm != 3; ++mm)</div>
<div class="line"><span class="lineno"> 1098</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 3; ++nn) {</div>
<div class="line"><span class="lineno"> 1099</span>            <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_row_stress_dX(ii, mm, nn);</div>
<div class="line"><span class="lineno"> 1100</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk)</div>
<div class="line"><span class="lineno"> 1101</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 3; ++ll)</div>
<div class="line"><span class="lineno"> 1102</span>                <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> += t_row_D(ii, kk, ll) * t_F_dX(kk, ll, mm, nn);</div>
<div class="line"><span class="lineno"> 1103</span>          }</div>
<div class="line"><span class="lineno"> 1104</span> </div>
<div class="line"><span class="lineno"> 1105</span>      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line"><span class="lineno"> 1106</span>      <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span>      <span class="comment">// iterate column base functions</span></div>
<div class="line"><span class="lineno"> 1109</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"><span class="lineno"> 1110</span> </div>
<div class="line"><span class="lineno"> 1111</span>        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * (t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"><span class="lineno"> 1112</span>        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_dX_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1113</span>        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span>        <span class="comment">// move to next column base function</span></div>
<div class="line"><span class="lineno"> 1116</span>        ++t_col_diff_base;</div>
<div class="line"><span class="lineno"> 1117</span> </div>
<div class="line"><span class="lineno"> 1118</span>        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line"><span class="lineno"> 1119</span>        ++t_m;</div>
<div class="line"><span class="lineno"> 1120</span>      }</div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>      <span class="comment">// move to next row base function</span></div>
<div class="line"><span class="lineno"> 1123</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1124</span>    }</div>
<div class="line"><span class="lineno"> 1125</span> </div>
<div class="line"><span class="lineno"> 1126</span>    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line"><span class="lineno"> 1127</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>    <span class="comment">// move to next integration weight</span></div>
<div class="line"><span class="lineno"> 1130</span>    ++t_w;</div>
<div class="line"><span class="lineno"> 1131</span>    ++t_D;</div>
<div class="line"><span class="lineno"> 1132</span>    ++t_cauchy_stress;</div>
<div class="line"><span class="lineno"> 1133</span>    ++t_invH;</div>
<div class="line"><span class="lineno"> 1134</span>    ++t_h;</div>
<div class="line"><span class="lineno"> 1135</span>  }</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1138</span>}</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1141</span>HookeElement::OpAleLhs_dX_dX&lt;S&gt;::OpAleLhs_dX_dX(</div>
<div class="line"><span class="lineno"> 1142</span>    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno"> 1143</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line"><span class="lineno"> 1144</span>    : <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, true) {}</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1147</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleLhs_dX_dX&lt;S&gt;::iNtegrate(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line"><span class="lineno"> 1148</span>                                                          <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line"><span class="lineno"> 1149</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1150</span> </div>
<div class="line"><span class="lineno"> 1151</span>  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line"><span class="lineno"> 1152</span>  <span class="comment">// second order tensor</span></div>
<div class="line"><span class="lineno"> 1153</span>  <span class="keyword">auto</span> get_tensor2 = [](<a class="code hl_class" href="classUBlasMatrix_3_01double_01_4.html">MatrixDouble</a> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line"><span class="lineno"> 1154</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line"><span class="lineno"> 1155</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line"><span class="lineno"> 1156</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line"><span class="lineno"> 1157</span>        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line"><span class="lineno"> 1158</span>  };</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1161</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno"> 1162</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno"> 1163</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno"> 1164</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;m&#39;</span>, 3&gt; <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>;</div>
<div class="line"><span class="lineno"> 1165</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;n&#39;</span>, 3&gt; <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>;</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>  <span class="comment">// get element volume</span></div>
<div class="line"><span class="lineno"> 1168</span>  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"><span class="lineno"> 1169</span> </div>
<div class="line"><span class="lineno"> 1170</span>  <span class="comment">// get intergrayion weights</span></div>
<div class="line"><span class="lineno"> 1171</span>  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"><span class="lineno"> 1172</span> </div>
<div class="line"><span class="lineno"> 1173</span>  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line"><span class="lineno"> 1174</span>  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line"><span class="lineno"> 1175</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"><span class="lineno"> 1176</span> </div>
<div class="line"><span class="lineno"> 1177</span>  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line"><span class="lineno"> 1178</span>  <span class="comment">// symmetry)</span></div>
<div class="line"><span class="lineno"> 1179</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno"> 1180</span>      <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno"> 1181</span>  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line"><span class="lineno"> 1182</span>      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line"><span class="lineno"> 1183</span>  <span class="keyword">auto</span> t_strain = getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;smallStrainMat));</div>
<div class="line"><span class="lineno"> 1184</span>  <span class="keyword">auto</span> t_eshelby_stress =</div>
<div class="line"><span class="lineno"> 1185</span>      getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;eshelbyStressMat);</div>
<div class="line"><span class="lineno"> 1186</span>  <span class="keyword">auto</span> t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</div>
<div class="line"><span class="lineno"> 1187</span>  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"><span class="lineno"> 1188</span>  <span class="keyword">auto</span> t_F = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;FMat);</div>
<div class="line"><span class="lineno"> 1189</span>  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"><span class="lineno"> 1190</span> </div>
<div class="line"><span class="lineno"> 1191</span>  <span class="comment">// iterate over integration points</span></div>
<div class="line"><span class="lineno"> 1192</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"><span class="lineno"> 1193</span> </div>
<div class="line"><span class="lineno"> 1194</span>    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line"><span class="lineno"> 1195</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"><span class="lineno"> 1196</span> </div>
<div class="line"><span class="lineno"> 1197</span>    <a class="code hl_class" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;double, 3, 3, 3, 3&gt;</a> t_F_dX;</div>
<div class="line"><span class="lineno"> 1198</span>    t_F_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = -(t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) * t_invH(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>)) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span>    <a class="code hl_class" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;double, 3, 3, 3, 3&gt;</a> t_D_strain_dX;</div>
<div class="line"><span class="lineno"> 1201</span>    t_D_strain_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) = 0.;</div>
<div class="line"><span class="lineno"> 1202</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line"><span class="lineno"> 1203</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; ++jj)</div>
<div class="line"><span class="lineno"> 1204</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 3; ++ll)</div>
<div class="line"><span class="lineno"> 1205</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk) {</div>
<div class="line"><span class="lineno"> 1206</span>            <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_D_strain_dX(ii, jj, kk, ll);</div>
<div class="line"><span class="lineno"> 1207</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mm = 0; mm != 3; ++mm)</div>
<div class="line"><span class="lineno"> 1208</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 3; ++nn)</div>
<div class="line"><span class="lineno"> 1209</span>                <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> += t_D(ii, jj, mm, nn) * t_F_dX(mm, nn, kk, ll);</div>
<div class="line"><span class="lineno"> 1210</span>          }</div>
<div class="line"><span class="lineno"> 1211</span> </div>
<div class="line"><span class="lineno"> 1212</span>    <a class="code hl_class" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;double, 3, 3, 3, 3&gt;</a> t_eshelby_stress_dX;</div>
<div class="line"><span class="lineno"> 1213</span>    t_eshelby_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) = t_F(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_D_strain_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line"><span class="lineno"> 1216</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; ++jj)</div>
<div class="line"><span class="lineno"> 1217</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mm = 0; mm != 3; ++mm)</div>
<div class="line"><span class="lineno"> 1218</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 3; ++nn) {</div>
<div class="line"><span class="lineno"> 1219</span>            <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_eshelby_stress_dX(ii, jj, mm, nn);</div>
<div class="line"><span class="lineno"> 1220</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk)</div>
<div class="line"><span class="lineno"> 1221</span>              <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> += t_F_dX(kk, ii, mm, nn) * t_cauchy_stress(kk, jj);</div>
<div class="line"><span class="lineno"> 1222</span>          }</div>
<div class="line"><span class="lineno"> 1223</span> </div>
<div class="line"><span class="lineno"> 1224</span>    t_eshelby_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= -1;</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>    <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_energy_dX;</div>
<div class="line"><span class="lineno"> 1227</span>    t_energy_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = t_F_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_cauchy_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1228</span>    t_energy_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) +=</div>
<div class="line"><span class="lineno"> 1229</span>        (t_strain(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) * t_D(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>)) * t_F_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1230</span>    t_energy_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) /= 2.;</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk)</div>
<div class="line"><span class="lineno"> 1233</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 3; ++ll) {</div>
<div class="line"><span class="lineno"> 1234</span>        <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_energy_dX(kk, ll);</div>
<div class="line"><span class="lineno"> 1235</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line"><span class="lineno"> 1236</span>          t_eshelby_stress_dX(ii, ii, kk, ll) += <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line"><span class="lineno"> 1237</span>      }</div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span>    <span class="comment">// iterate over row base functions</span></div>
<div class="line"><span class="lineno"> 1240</span>    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line"><span class="lineno"> 1241</span>    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"><span class="lineno"> 1242</span> </div>
<div class="line"><span class="lineno"> 1243</span>      <span class="comment">// get sub matrix for the row</span></div>
<div class="line"><span class="lineno"> 1244</span>      <span class="keyword">auto</span> t_m = get_tensor2(<a class="code hl_variable" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, 3 * rr, 0);</div>
<div class="line"><span class="lineno"> 1245</span> </div>
<div class="line"><span class="lineno"> 1246</span>      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line"><span class="lineno"> 1247</span>      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1248</span> </div>
<div class="line"><span class="lineno"> 1249</span>      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_stress;</div>
<div class="line"><span class="lineno"> 1250</span>      t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>      <a class="code hl_class" href="classFTensor_1_1Tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_diff_base_pulled_dX;</div>
<div class="line"><span class="lineno"> 1253</span>      t_row_diff_base_pulled_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) =</div>
<div class="line"><span class="lineno"> 1254</span>          -(t_row_diff_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_invH(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>)) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1255</span> </div>
<div class="line"><span class="lineno"> 1256</span>      <a class="code hl_class" href="classFTensor_1_1Tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_dX_stress;</div>
<div class="line"><span class="lineno"> 1257</span>      t_row_dX_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) =</div>
<div class="line"><span class="lineno"> 1258</span>          <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * (t_row_diff_base_pulled_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1260</span>      <a class="code hl_class" href="classFTensor_1_1Tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_stress_dX;</div>
<div class="line"><span class="lineno"> 1261</span>      t_row_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) =</div>
<div class="line"><span class="lineno"> 1262</span>          <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line"><span class="lineno"> 1265</span>      <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line"><span class="lineno"> 1266</span> </div>
<div class="line"><span class="lineno"> 1267</span>      <span class="comment">// iterate column base functions</span></div>
<div class="line"><span class="lineno"> 1268</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * (t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"><span class="lineno"> 1271</span>        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_dX_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1272</span>        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1273</span> </div>
<div class="line"><span class="lineno"> 1274</span>        <span class="comment">// move to next column base function</span></div>
<div class="line"><span class="lineno"> 1275</span>        ++t_col_diff_base;</div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span>        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line"><span class="lineno"> 1278</span>        ++t_m;</div>
<div class="line"><span class="lineno"> 1279</span>      }</div>
<div class="line"><span class="lineno"> 1280</span> </div>
<div class="line"><span class="lineno"> 1281</span>      <span class="comment">// move to next row base function</span></div>
<div class="line"><span class="lineno"> 1282</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1283</span>    }</div>
<div class="line"><span class="lineno"> 1284</span> </div>
<div class="line"><span class="lineno"> 1285</span>    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line"><span class="lineno"> 1286</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span>    <span class="comment">// move to next integration weight</span></div>
<div class="line"><span class="lineno"> 1289</span>    ++t_w;</div>
<div class="line"><span class="lineno"> 1290</span>    ++t_D;</div>
<div class="line"><span class="lineno"> 1291</span>    ++t_cauchy_stress;</div>
<div class="line"><span class="lineno"> 1292</span>    ++t_strain;</div>
<div class="line"><span class="lineno"> 1293</span>    ++t_eshelby_stress;</div>
<div class="line"><span class="lineno"> 1294</span>    ++t_h;</div>
<div class="line"><span class="lineno"> 1295</span>    ++t_invH;</div>
<div class="line"><span class="lineno"> 1296</span>    ++t_F;</div>
<div class="line"><span class="lineno"> 1297</span>  }</div>
<div class="line"><span class="lineno"> 1298</span> </div>
<div class="line"><span class="lineno"> 1299</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1300</span>}</div>
<div class="line"><span class="lineno"> 1301</span> </div>
<div class="line"><span class="lineno"> 1302</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1303</span>HookeElement::OpAleLhsPre_dX_dx&lt;S&gt;::OpAleLhsPre_dX_dx(</div>
<div class="line"><span class="lineno"> 1304</span>    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line"><span class="lineno"> 1305</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line"><span class="lineno"> 1306</span>    : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line"><span class="lineno"> 1307</span>      dataAtPts(data_at_pts) {</div>
<div class="line"><span class="lineno"> 1308</span>  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1309</span>}</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1312</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleLhsPre_dX_dx&lt;S&gt;::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line"><span class="lineno"> 1313</span>                                                          EntityType row_type,</div>
<div class="line"><span class="lineno"> 1314</span>                                                          <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line"><span class="lineno"> 1315</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1316</span> </div>
<div class="line"><span class="lineno"> 1317</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size1();</div>
<div class="line"><span class="lineno"> 1318</span> </div>
<div class="line"><span class="lineno"> 1319</span>  <span class="keyword">auto</span> get_eshelby_stress_dx = [<span class="keyword">this</span>, nb_integration_pts]() {</div>
<div class="line"><span class="lineno"> 1320</span>    <a class="code hl_class" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3, 3, 3, 3&gt;</div>
<div class="line"><span class="lineno"> 1321</span>        t_eshelby_stress_dx;</div>
<div class="line"><span class="lineno"> 1322</span>    dataAtPts-&gt;eshelbyStress_dx-&gt;resize(81, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1323</span>    <span class="keywordtype">int</span> mm = 0;</div>
<div class="line"><span class="lineno"> 1324</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line"><span class="lineno"> 1325</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; ++jj)</div>
<div class="line"><span class="lineno"> 1326</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk)</div>
<div class="line"><span class="lineno"> 1327</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 3; ++ll)</div>
<div class="line"><span class="lineno"> 1328</span>            t_eshelby_stress_dx.ptr(ii, jj, kk, ll) =</div>
<div class="line"><span class="lineno"> 1329</span>                &amp;(*dataAtPts-&gt;eshelbyStress_dx)(mm++, 0);</div>
<div class="line"><span class="lineno"> 1330</span>    <span class="keywordflow">return</span> t_eshelby_stress_dx;</div>
<div class="line"><span class="lineno"> 1331</span>  };</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>  <span class="keyword">auto</span> t_eshelby_stress_dx = get_eshelby_stress_dx();</div>
<div class="line"><span class="lineno"> 1334</span> </div>
<div class="line"><span class="lineno"> 1335</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1336</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno"> 1337</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno"> 1338</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno"> 1339</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;m&#39;</span>, 3&gt; <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>;</div>
<div class="line"><span class="lineno"> 1340</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;n&#39;</span>, 3&gt; <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>;</div>
<div class="line"><span class="lineno"> 1341</span> </div>
<div class="line"><span class="lineno"> 1342</span>  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line"><span class="lineno"> 1343</span>  <span class="comment">// symmetry)</span></div>
<div class="line"><span class="lineno"> 1344</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno"> 1345</span>      <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno"> 1346</span>  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line"><span class="lineno"> 1347</span>      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line"><span class="lineno"> 1348</span>  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"><span class="lineno"> 1349</span>  <span class="keyword">auto</span> t_F = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;FMat);</div>
<div class="line"><span class="lineno"> 1350</span> </div>
<div class="line"><span class="lineno"> 1351</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span>    t_eshelby_stress_dx(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) =</div>
<div class="line"><span class="lineno"> 1354</span>        (t_F(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_D(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>)) * t_invH(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line"><span class="lineno"> 1356</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; ++jj)</div>
<div class="line"><span class="lineno"> 1357</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mm = 0; mm != 3; ++mm)</div>
<div class="line"><span class="lineno"> 1358</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 3; ++nn) {</div>
<div class="line"><span class="lineno"> 1359</span>            <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_eshelby_stress_dx(ii, jj, mm, nn);</div>
<div class="line"><span class="lineno"> 1360</span>            <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> += t_invH(nn, ii) * t_cauchy_stress(mm, jj);</div>
<div class="line"><span class="lineno"> 1361</span>          }</div>
<div class="line"><span class="lineno"> 1362</span>    t_eshelby_stress_dx(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= -1;</div>
<div class="line"><span class="lineno"> 1363</span> </div>
<div class="line"><span class="lineno"> 1364</span>    <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_energy_dx;</div>
<div class="line"><span class="lineno"> 1365</span>    t_energy_dx(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) = t_invH(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1366</span> </div>
<div class="line"><span class="lineno"> 1367</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mm = 0; mm != 3; ++mm)</div>
<div class="line"><span class="lineno"> 1368</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 3; ++nn) {</div>
<div class="line"><span class="lineno"> 1369</span>        <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_energy_dx(mm, nn);</div>
<div class="line"><span class="lineno"> 1370</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line"><span class="lineno"> 1371</span>          t_eshelby_stress_dx(ii, ii, mm, nn) += <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line"><span class="lineno"> 1372</span>      }</div>
<div class="line"><span class="lineno"> 1373</span> </div>
<div class="line"><span class="lineno"> 1374</span>    ++t_D;</div>
<div class="line"><span class="lineno"> 1375</span>    ++t_invH;</div>
<div class="line"><span class="lineno"> 1376</span>    ++t_cauchy_stress;</div>
<div class="line"><span class="lineno"> 1377</span>    ++t_eshelby_stress_dx;</div>
<div class="line"><span class="lineno"> 1378</span>    ++t_F;</div>
<div class="line"><span class="lineno"> 1379</span>  }</div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1382</span>}</div>
<div class="line"><span class="lineno"> 1383</span> </div>
<div class="line"><span class="lineno"> 1384</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="lineno"> 1385</span>HookeElement::OpPostProcHookeElement&lt;ELEMENT&gt;::OpPostProcHookeElement(</div>
<div class="line"><span class="lineno"> 1386</span>    <span class="keyword">const</span> <span class="keywordtype">string</span> row_field, boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line"><span class="lineno"> 1387</span>    map&lt;int, BlockData&gt; &amp;block_sets_ptr, moab::Interface &amp;post_proc_mesh,</div>
<div class="line"><span class="lineno"> 1388</span>    std::vector&lt;EntityHandle&gt; &amp;map_gauss_pts, <span class="keywordtype">bool</span> is_ale, <span class="keywordtype">bool</span> is_field_disp)</div>
<div class="line"><span class="lineno"> 1389</span>    : <a class="code hl_class" href="classELEMENT.html">ELEMENT</a>::<a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(row_field, <a class="code hl_typedef" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line"><span class="lineno"> 1390</span>      dataAtPts(data_at_pts), blockSetsPtr(block_sets_ptr),</div>
<div class="line"><span class="lineno"> 1391</span>      postProcMesh(post_proc_mesh), mapGaussPts(map_gauss_pts), isALE(is_ale),</div>
<div class="line"><span class="lineno"> 1392</span>      isFieldDisp(is_field_disp) {}</div>
<div class="line"><span class="lineno"> 1393</span> </div>
<div class="line"><span class="lineno"> 1394</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="lineno"> 1395</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpPostProcHookeElement&lt;ELEMENT&gt;::doWork(</div>
<div class="line"><span class="lineno"> 1396</span>    <span class="keywordtype">int</span> side, EntityType type, <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line"><span class="lineno"> 1397</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1398</span> </div>
<div class="line"><span class="lineno"> 1399</span>  <span class="keywordflow">if</span> (type != MBVERTEX) {</div>
<div class="line"><span class="lineno"> 1400</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 1401</span>  }</div>
<div class="line"><span class="lineno"> 1402</span> </div>
<div class="line"><span class="lineno"> 1403</span>  <span class="keyword">auto</span> tensor_to_tensor = [](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;t1, <span class="keyword">auto</span> &amp;t2) {</div>
<div class="line"><span class="lineno"> 1404</span>    t2(0, 0) = t1(0, 0);</div>
<div class="line"><span class="lineno"> 1405</span>    t2(1, 1) = t1(1, 1);</div>
<div class="line"><span class="lineno"> 1406</span>    t2(2, 2) = t1(2, 2);</div>
<div class="line"><span class="lineno"> 1407</span>    t2(0, 1) = t2(1, 0) = t1(1, 0);</div>
<div class="line"><span class="lineno"> 1408</span>    t2(0, 2) = t2(2, 0) = t1(2, 0);</div>
<div class="line"><span class="lineno"> 1409</span>    t2(1, 2) = t2(2, 1) = t1(2, 1);</div>
<div class="line"><span class="lineno"> 1410</span>  };</div>
<div class="line"><span class="lineno"> 1411</span> </div>
<div class="line"><span class="lineno"> 1412</span>  std::array&lt;double, 9&gt; def_val;</div>
<div class="line"><span class="lineno"> 1413</span>  def_val.fill(0);</div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span>  <span class="keyword">auto</span> make_tag = [&amp;](<span class="keyword">auto</span> name, <span class="keyword">auto</span> size) {</div>
<div class="line"><span class="lineno"> 1416</span>    Tag <a class="code hl_variable" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><span class="lineno"> 1417</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(name, size, MB_TYPE_DOUBLE, <a class="code hl_variable" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>,</div>
<div class="line"><span class="lineno"> 1418</span>                                       MB_TAG_CREAT | MB_TAG_SPARSE,</div>
<div class="line"><span class="lineno"> 1419</span>                                       def_val.data());</div>
<div class="line"><span class="lineno"> 1420</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><span class="lineno"> 1421</span>  };</div>
<div class="line"><span class="lineno"> 1422</span> </div>
<div class="line"><span class="lineno"> 1423</span>  <span class="keyword">auto</span> th_stress = make_tag(<span class="stringliteral">&quot;STRESS&quot;</span>, 9);</div>
<div class="line"><span class="lineno"> 1424</span>  <span class="keyword">auto</span> th_psi = make_tag(<span class="stringliteral">&quot;ENERGY&quot;</span>, 1);</div>
<div class="line"><span class="lineno"> 1425</span> </div>
<div class="line"><span class="lineno"> 1426</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = mapGaussPts.size();</div>
<div class="line"><span class="lineno"> 1427</span> </div>
<div class="line"><span class="lineno"> 1428</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1429</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno"> 1430</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno"> 1431</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>  <span class="keyword">auto</span> t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</div>
<div class="line"><span class="lineno"> 1434</span>  <span class="keyword">auto</span> t_H = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;HMat);</div>
<div class="line"><span class="lineno"> 1435</span> </div>
<div class="line"><span class="lineno"> 1436</span>  dataAtPts-&gt;stiffnessMat-&gt;resize(36, 1, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1437</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno"> 1438</span>      <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno"> 1439</span> </div>
<div class="line"><span class="lineno"> 1440</span>  <a class="code hl_class" href="classEntityHandle.html">EntityHandle</a> ent = this-&gt;getFEEntityHandle();</div>
<div class="line"><span class="lineno"> 1441</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> = <a class="code hl_function" href="namespaceMoFEM.html#a01f67868b6366749021d5258535655cd">type_from_handle</a>(ent);</div>
<div class="line"><span class="lineno"> 1442</span>  <a class="code hl_class" href="classEntityHandle.html">EntityHandle</a> ent_3d = ent;</div>
<div class="line"><span class="lineno"> 1443</span>  <span class="keywordflow">if</span> (type == MBTRI || type == MBQUAD) {</div>
<div class="line"><span class="lineno"> 1444</span>    <a class="code hl_class" href="classRange.html">Range</a> ents;</div>
<div class="line"><span class="lineno"> 1445</span>    <span class="keyword">auto</span> &amp;m_field = this-&gt;getPtrFE()-&gt;mField;</div>
<div class="line"><span class="lineno"> 1446</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().get_adjacencies(&amp;ent, 1, 3, <span class="keyword">false</span>, ents,</div>
<div class="line"><span class="lineno"> 1447</span>                                              moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 1448</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno"> 1449</span>    <span class="keywordflow">if</span> (ents.empty())</div>
<div class="line"><span class="lineno"> 1450</span>      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><span class="lineno"> 1451</span>              <span class="stringliteral">&quot;Could not find a 3D element adjacent to a given face element&quot;</span>);</div>
<div class="line"><span class="lineno"> 1452</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1453</span>    ent_3d = ents.front();</div>
<div class="line"><span class="lineno"> 1454</span>  }</div>
<div class="line"><span class="lineno"> 1455</span> </div>
<div class="line"><span class="lineno"> 1456</span>  <span class="keywordtype">bool</span> found_block = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1457</span>  <span class="keywordtype">int</span> block_id = -1;</div>
<div class="line"><span class="lineno"> 1458</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : (blockSetsPtr)) {</div>
<div class="line"><span class="lineno"> 1459</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts.find(ent_3d) != <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts.end()) {</div>
<div class="line"><span class="lineno"> 1460</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> young = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.E;</div>
<div class="line"><span class="lineno"> 1461</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> poisson = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.PoissonRatio;</div>
<div class="line"><span class="lineno"> 1462</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> coefficient = young / ((1 + poisson) * (1 - 2 * poisson));</div>
<div class="line"><span class="lineno"> 1463</span>      block_id = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.iD;</div>
<div class="line"><span class="lineno"> 1464</span> </div>
<div class="line"><span class="lineno"> 1465</span>      t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = 0.;</div>
<div class="line"><span class="lineno"> 1466</span>      t_D(0, 0, 0, 0) = t_D(1, 1, 1, 1) = t_D(2, 2, 2, 2) = 1 - poisson;</div>
<div class="line"><span class="lineno"> 1467</span>      t_D(0, 1, 0, 1) = t_D(0, 2, 0, 2) = t_D(1, 2, 1, 2) =</div>
<div class="line"><span class="lineno"> 1468</span>          0.5 * (1 - 2 * poisson);</div>
<div class="line"><span class="lineno"> 1469</span>      t_D(0, 0, 1, 1) = t_D(1, 1, 0, 0) = t_D(0, 0, 2, 2) = t_D(2, 2, 0, 0) =</div>
<div class="line"><span class="lineno"> 1470</span>          t_D(1, 1, 2, 2) = t_D(2, 2, 1, 1) = poisson;</div>
<div class="line"><span class="lineno"> 1471</span>      t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= coefficient;</div>
<div class="line"><span class="lineno"> 1472</span> </div>
<div class="line"><span class="lineno"> 1473</span>      found_block = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1474</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1475</span>    }</div>
<div class="line"><span class="lineno"> 1476</span>  }</div>
<div class="line"><span class="lineno"> 1477</span>  <span class="keywordflow">if</span> (!found_block)</div>
<div class="line"><span class="lineno"> 1478</span>    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><span class="lineno"> 1479</span>            <span class="stringliteral">&quot;Element not found in any of material blocksets&quot;</span>);</div>
<div class="line"><span class="lineno"> 1480</span> </div>
<div class="line"><span class="lineno"> 1481</span>  <span class="keywordtype">int</span> def_val_int = 0;</div>
<div class="line"><span class="lineno"> 1482</span>  Tag tag_mat;</div>
<div class="line"><span class="lineno"> 1483</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;MAT_ELASTIC&quot;</span>, 1, MB_TYPE_INTEGER, tag_mat,</div>
<div class="line"><span class="lineno"> 1484</span>                                     MB_TAG_CREAT | MB_TAG_SPARSE, &amp;def_val_int);</div>
<div class="line"><span class="lineno"> 1485</span>  <span class="keywordtype">double</span> detH = 0.;</div>
<div class="line"><span class="lineno"> 1486</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_invH;</div>
<div class="line"><span class="lineno"> 1487</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_F;</div>
<div class="line"><span class="lineno"> 1488</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_stress;</div>
<div class="line"><span class="lineno"> 1489</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_small_strain;</div>
<div class="line"><span class="lineno"> 1490</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a> t_stress_symm;</div>
<div class="line"><span class="lineno"> 1491</span>  <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a> t_small_strain_symm;</div>
<div class="line"><span class="lineno"> 1492</span> </div>
<div class="line"><span class="lineno"> 1493</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"><span class="lineno"> 1494</span> </div>
<div class="line"><span class="lineno"> 1495</span>    <span class="keywordflow">if</span> (isFieldDisp) {</div>
<div class="line"><span class="lineno"> 1496</span>      t_h(0, 0) += 1;</div>
<div class="line"><span class="lineno"> 1497</span>      t_h(1, 1) += 1;</div>
<div class="line"><span class="lineno"> 1498</span>      t_h(2, 2) += 1;</div>
<div class="line"><span class="lineno"> 1499</span>    }</div>
<div class="line"><span class="lineno"> 1500</span> </div>
<div class="line"><span class="lineno"> 1501</span>    <span class="keywordflow">if</span> (!isALE) {</div>
<div class="line"><span class="lineno"> 1502</span>      t_small_strain_symm(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_h(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2.;</div>
<div class="line"><span class="lineno"> 1503</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1504</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#ae3a0416ae2eb4b327e43ef2dfc21a15a">determinantTensor3by3</a>(t_H, detH);</div>
<div class="line"><span class="lineno"> 1505</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a7064ec9e939c81c212cc726272c0e088">invertTensor3by3</a>(t_H, detH, t_invH);</div>
<div class="line"><span class="lineno"> 1506</span>      t_F(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1507</span>      t_small_strain_symm(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_F(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_F(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2.;</div>
<div class="line"><span class="lineno"> 1508</span>      ++t_H;</div>
<div class="line"><span class="lineno"> 1509</span>    }</div>
<div class="line"><span class="lineno"> 1510</span> </div>
<div class="line"><span class="lineno"> 1511</span>    t_small_strain_symm(0, 0) -= 1;</div>
<div class="line"><span class="lineno"> 1512</span>    t_small_strain_symm(1, 1) -= 1;</div>
<div class="line"><span class="lineno"> 1513</span>    t_small_strain_symm(2, 2) -= 1;</div>
<div class="line"><span class="lineno"> 1514</span> </div>
<div class="line"><span class="lineno"> 1515</span>    <span class="comment">// symmetric tensors need improvement</span></div>
<div class="line"><span class="lineno"> 1516</span>    t_stress_symm(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_small_strain_symm(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1517</span>    tensor_to_tensor(t_stress_symm, t_stress);</div>
<div class="line"><span class="lineno"> 1518</span> </div>
<div class="line"><span class="lineno"> 1519</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> psi = 0.5 * t_stress_symm(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_small_strain_symm(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1520</span> </div>
<div class="line"><span class="lineno"> 1521</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_psi, &amp;mapGaussPts[gg], 1, &amp;psi);</div>
<div class="line"><span class="lineno"> 1522</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_stress, &amp;mapGaussPts[gg], 1,</div>
<div class="line"><span class="lineno"> 1523</span>                                     &amp;t_stress(0, 0));</div>
<div class="line"><span class="lineno"> 1524</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(tag_mat, &amp;mapGaussPts[gg], 1,</div>
<div class="line"><span class="lineno"> 1525</span>                                     &amp;block_id);</div>
<div class="line"><span class="lineno"> 1526</span> </div>
<div class="line"><span class="lineno"> 1527</span>    ++t_h;</div>
<div class="line"><span class="lineno"> 1528</span>  }</div>
<div class="line"><span class="lineno"> 1529</span> </div>
<div class="line"><span class="lineno"> 1530</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1531</span>}</div>
<div class="line"><span class="lineno"> 1532</span> </div>
<div class="line"><span class="lineno"> 1533</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1534</span>HookeElement::OpAnalyticalInternalStrain_dx&lt;S&gt;::OpAnalyticalInternalStrain_dx(</div>
<div class="line"><span class="lineno"> 1535</span>    <span class="keyword">const</span> std::string row_field,</div>
<div class="line"><span class="lineno"> 1536</span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line"><span class="lineno"> 1537</span>    StrainFunction strain_fun)</div>
<div class="line"><span class="lineno"> 1538</span>    : <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a>(row_field, row_field, data_at_pts, OPROW, true),</div>
<div class="line"><span class="lineno"> 1539</span>      strainFun(strain_fun) {}</div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1542</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><span class="lineno"> 1543</span>HookeElement::OpAnalyticalInternalStrain_dx&lt;S&gt;::iNtegrate(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line"><span class="lineno"> 1544</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1545</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno"> 1546</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno"> 1547</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno"> 1548</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1549</span> </div>
<div class="line"><span class="lineno"> 1550</span>  <span class="keyword">auto</span> get_tensor1 = [](<a class="code hl_class" href="classUBlasVector_3_01double_01_4.html">VectorDouble</a> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line"><span class="lineno"> 1551</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line"><span class="lineno"> 1552</span>        &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 0), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 1), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 2));</div>
<div class="line"><span class="lineno"> 1553</span>  };</div>
<div class="line"><span class="lineno"> 1554</span> </div>
<div class="line"><span class="lineno"> 1555</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line"><span class="lineno"> 1556</span>  <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line"><span class="lineno"> 1557</span> </div>
<div class="line"><span class="lineno"> 1558</span>  <span class="comment">// get element volume</span></div>
<div class="line"><span class="lineno"> 1559</span>  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"><span class="lineno"> 1560</span>  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"><span class="lineno"> 1561</span> </div>
<div class="line"><span class="lineno"> 1562</span>  nF.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1563</span>  nF.clear();</div>
<div class="line"><span class="lineno"> 1564</span> </div>
<div class="line"><span class="lineno"> 1565</span>  <span class="comment">// elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line"><span class="lineno"> 1566</span>  <span class="comment">// symmetry)</span></div>
<div class="line"><span class="lineno"> 1567</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno"> 1568</span>      <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno"> 1569</span> </div>
<div class="line"><span class="lineno"> 1570</span>  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line"><span class="lineno"> 1571</span>  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line"><span class="lineno"> 1572</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"><span class="lineno"> 1573</span> </div>
<div class="line"><span class="lineno"> 1574</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"><span class="lineno"> 1575</span> </div>
<div class="line"><span class="lineno"> 1576</span>    <span class="keyword">auto</span> t_fun_strain = strainFun(t_coords);</div>
<div class="line"><span class="lineno"> 1577</span>    <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a> t_stress;</div>
<div class="line"><span class="lineno"> 1578</span>    t_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_fun_strain(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1579</span> </div>
<div class="line"><span class="lineno"> 1580</span>    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line"><span class="lineno"> 1581</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol;</div>
<div class="line"><span class="lineno"> 1582</span> </div>
<div class="line"><span class="lineno"> 1583</span>    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"><span class="lineno"> 1584</span> </div>
<div class="line"><span class="lineno"> 1585</span>    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line"><span class="lineno"> 1586</span>    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"><span class="lineno"> 1587</span>      t_nf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1588</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1589</span>      ++t_nf;</div>
<div class="line"><span class="lineno"> 1590</span>    }</div>
<div class="line"><span class="lineno"> 1591</span> </div>
<div class="line"><span class="lineno"> 1592</span>    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line"><span class="lineno"> 1593</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1594</span> </div>
<div class="line"><span class="lineno"> 1595</span>    ++t_w;</div>
<div class="line"><span class="lineno"> 1596</span>    ++t_coords;</div>
<div class="line"><span class="lineno"> 1597</span>    ++t_D;</div>
<div class="line"><span class="lineno"> 1598</span>  }</div>
<div class="line"><span class="lineno"> 1599</span> </div>
<div class="line"><span class="lineno"> 1600</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1601</span>}</div>
<div class="line"><span class="lineno"> 1602</span> </div>
<div class="line"><span class="lineno"> 1603</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1604</span>HookeElement::OpAnalyticalInternalAleStrain_dX&lt;S&gt;::</div>
<div class="line"><span class="lineno"> 1605</span>    OpAnalyticalInternalAleStrain_dX(</div>
<div class="line"><span class="lineno"> 1606</span>        <span class="keyword">const</span> std::string row_field,</div>
<div class="line"><span class="lineno"> 1607</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line"><span class="lineno"> 1608</span>        StrainFunction strain_fun,</div>
<div class="line"><span class="lineno"> 1609</span>        boost::shared_ptr&lt;MatrixDouble&gt; mat_pos_at_pts_ptr)</div>
<div class="line"><span class="lineno"> 1610</span>    : <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a>(row_field, row_field, data_at_pts, OPROW, true),</div>
<div class="line"><span class="lineno"> 1611</span>      strainFun(strain_fun), matPosAtPtsPtr(mat_pos_at_pts_ptr) {}</div>
<div class="line"><span class="lineno"> 1612</span> </div>
<div class="line"><span class="lineno"> 1613</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1614</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAnalyticalInternalAleStrain_dX&lt;S&gt;::iNtegrate(</div>
<div class="line"><span class="lineno"> 1615</span>    <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line"><span class="lineno"> 1616</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1617</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno"> 1618</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno"> 1619</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno"> 1620</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1621</span> </div>
<div class="line"><span class="lineno"> 1622</span>  <span class="keyword">auto</span> get_tensor1 = [](<a class="code hl_class" href="classUBlasVector_3_01double_01_4.html">VectorDouble</a> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line"><span class="lineno"> 1623</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line"><span class="lineno"> 1624</span>        &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 0), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 1), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 2));</div>
<div class="line"><span class="lineno"> 1625</span>  };</div>
<div class="line"><span class="lineno"> 1626</span> </div>
<div class="line"><span class="lineno"> 1627</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line"><span class="lineno"> 1628</span> </div>
<div class="line"><span class="lineno"> 1629</span>  <span class="keyword">auto</span> get_coords = [&amp;]() { <span class="keywordflow">return</span> getFTensor1FromMat&lt;3&gt;(*matPosAtPtsPtr); };</div>
<div class="line"><span class="lineno"> 1630</span>  <span class="keyword">auto</span> t_coords = get_coords();</div>
<div class="line"><span class="lineno"> 1631</span> </div>
<div class="line"><span class="lineno"> 1632</span>  <span class="comment">// get element volume</span></div>
<div class="line"><span class="lineno"> 1633</span>  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"><span class="lineno"> 1634</span>  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"><span class="lineno"> 1635</span> </div>
<div class="line"><span class="lineno"> 1636</span>  nF.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1637</span>  nF.clear();</div>
<div class="line"><span class="lineno"> 1638</span> </div>
<div class="line"><span class="lineno"> 1639</span>  <span class="comment">// elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line"><span class="lineno"> 1640</span>  <span class="comment">// symmetry)</span></div>
<div class="line"><span class="lineno"> 1641</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno"> 1642</span>      <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno"> 1643</span>  <span class="keyword">auto</span> t_F = getFTensor2FromMat&lt;3, 3&gt;(*(dataAtPts-&gt;FMat));</div>
<div class="line"><span class="lineno"> 1644</span>  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"><span class="lineno"> 1645</span>  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"><span class="lineno"> 1646</span> </div>
<div class="line"><span class="lineno"> 1647</span>  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line"><span class="lineno"> 1648</span>  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line"><span class="lineno"> 1649</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"><span class="lineno"> 1650</span> </div>
<div class="line"><span class="lineno"> 1651</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"><span class="lineno"> 1652</span> </div>
<div class="line"><span class="lineno"> 1653</span>    <span class="keyword">auto</span> t_fun_strain = strainFun(t_coords);</div>
<div class="line"><span class="lineno"> 1654</span>    <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a> t_stress;</div>
<div class="line"><span class="lineno"> 1655</span>    t_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_fun_strain(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1656</span>    <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_eshelby_stress;</div>
<div class="line"><span class="lineno"> 1657</span>    t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -t_F(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_stress(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1658</span> </div>
<div class="line"><span class="lineno"> 1659</span>    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line"><span class="lineno"> 1660</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"><span class="lineno"> 1661</span> </div>
<div class="line"><span class="lineno"> 1662</span>    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"><span class="lineno"> 1663</span> </div>
<div class="line"><span class="lineno"> 1664</span>    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line"><span class="lineno"> 1665</span>    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"><span class="lineno"> 1666</span>      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line"><span class="lineno"> 1667</span>      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1668</span>      t_nf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1669</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1670</span>      ++t_nf;</div>
<div class="line"><span class="lineno"> 1671</span>    }</div>
<div class="line"><span class="lineno"> 1672</span> </div>
<div class="line"><span class="lineno"> 1673</span>    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line"><span class="lineno"> 1674</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1675</span> </div>
<div class="line"><span class="lineno"> 1676</span>    ++t_w;</div>
<div class="line"><span class="lineno"> 1677</span>    ++t_coords;</div>
<div class="line"><span class="lineno"> 1678</span>    ++t_F;</div>
<div class="line"><span class="lineno"> 1679</span>    ++t_invH;</div>
<div class="line"><span class="lineno"> 1680</span>    ++t_D;</div>
<div class="line"><span class="lineno"> 1681</span>  }</div>
<div class="line"><span class="lineno"> 1682</span> </div>
<div class="line"><span class="lineno"> 1683</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1684</span>}</div>
<div class="line"><span class="lineno"> 1685</span> </div>
<div class="line"><span class="lineno"> 1686</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1687</span>HookeElement::OpAnalyticalInternalAleStrain_dx&lt;S&gt;::</div>
<div class="line"><span class="lineno"> 1688</span>    OpAnalyticalInternalAleStrain_dx(</div>
<div class="line"><span class="lineno"> 1689</span>        <span class="keyword">const</span> std::string row_field,</div>
<div class="line"><span class="lineno"> 1690</span>        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line"><span class="lineno"> 1691</span>        StrainFunction strain_fun,</div>
<div class="line"><span class="lineno"> 1692</span>        boost::shared_ptr&lt;MatrixDouble&gt; mat_pos_at_pts_ptr)</div>
<div class="line"><span class="lineno"> 1693</span>    : <a class="code hl_struct" href="structOpAssemble.html">OpAssemble</a>(row_field, row_field, data_at_pts, OPROW, true),</div>
<div class="line"><span class="lineno"> 1694</span>      strainFun(strain_fun), matPosAtPtsPtr(mat_pos_at_pts_ptr) {}</div>
<div class="line"><span class="lineno"> 1695</span> </div>
<div class="line"><span class="lineno"> 1696</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><span class="lineno"> 1697</span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAnalyticalInternalAleStrain_dx&lt;S&gt;::iNtegrate(</div>
<div class="line"><span class="lineno"> 1698</span>    <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line"><span class="lineno"> 1699</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1700</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno"> 1701</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno"> 1702</span>  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno"> 1703</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1704</span> </div>
<div class="line"><span class="lineno"> 1705</span>  <span class="keyword">auto</span> get_tensor1 = [](<a class="code hl_class" href="classUBlasVector_3_01double_01_4.html">VectorDouble</a> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line"><span class="lineno"> 1706</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line"><span class="lineno"> 1707</span>        &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 0), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 1), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 2));</div>
<div class="line"><span class="lineno"> 1708</span>  };</div>
<div class="line"><span class="lineno"> 1709</span> </div>
<div class="line"><span class="lineno"> 1710</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line"><span class="lineno"> 1711</span> </div>
<div class="line"><span class="lineno"> 1712</span>  <span class="keyword">auto</span> get_coords = [&amp;]() { <span class="keywordflow">return</span> getFTensor1FromMat&lt;3&gt;(*matPosAtPtsPtr); };</div>
<div class="line"><span class="lineno"> 1713</span>  <span class="keyword">auto</span> t_coords = get_coords();</div>
<div class="line"><span class="lineno"> 1714</span> </div>
<div class="line"><span class="lineno"> 1715</span>  <span class="comment">// get element volume</span></div>
<div class="line"><span class="lineno"> 1716</span>  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"><span class="lineno"> 1717</span>  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"><span class="lineno"> 1718</span> </div>
<div class="line"><span class="lineno"> 1719</span>  nF.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1720</span>  nF.clear();</div>
<div class="line"><span class="lineno"> 1721</span> </div>
<div class="line"><span class="lineno"> 1722</span>  <span class="comment">// elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line"><span class="lineno"> 1723</span>  <span class="comment">// symmetry)</span></div>
<div class="line"><span class="lineno"> 1724</span>  <a class="code hl_class" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line"><span class="lineno"> 1725</span>      <a class="code hl_define" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"><span class="lineno"> 1726</span>  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"><span class="lineno"> 1727</span>  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"><span class="lineno"> 1728</span> </div>
<div class="line"><span class="lineno"> 1729</span>  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line"><span class="lineno"> 1730</span>  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line"><span class="lineno"> 1731</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"><span class="lineno"> 1732</span> </div>
<div class="line"><span class="lineno"> 1733</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"><span class="lineno"> 1734</span> </div>
<div class="line"><span class="lineno"> 1735</span>    <span class="keyword">auto</span> t_fun_strain = strainFun(t_coords);</div>
<div class="line"><span class="lineno"> 1736</span>    <a class="code hl_class" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a> t_stress;</div>
<div class="line"><span class="lineno"> 1737</span>    t_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_fun_strain(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1738</span> </div>
<div class="line"><span class="lineno"> 1739</span>    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line"><span class="lineno"> 1740</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"><span class="lineno"> 1741</span> </div>
<div class="line"><span class="lineno"> 1742</span>    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"><span class="lineno"> 1743</span> </div>
<div class="line"><span class="lineno"> 1744</span>    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line"><span class="lineno"> 1745</span>    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"><span class="lineno"> 1746</span>      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line"><span class="lineno"> 1747</span>      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1748</span>      t_nf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="lineno"> 1749</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1750</span>      ++t_nf;</div>
<div class="line"><span class="lineno"> 1751</span>    }</div>
<div class="line"><span class="lineno"> 1752</span> </div>
<div class="line"><span class="lineno"> 1753</span>    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line"><span class="lineno"> 1754</span>      ++t_row_diff_base;</div>
<div class="line"><span class="lineno"> 1755</span> </div>
<div class="line"><span class="lineno"> 1756</span>    ++t_w;</div>
<div class="line"><span class="lineno"> 1757</span>    ++t_coords;</div>
<div class="line"><span class="lineno"> 1758</span>    ++t_invH;</div>
<div class="line"><span class="lineno"> 1759</span>    ++t_D;</div>
<div class="line"><span class="lineno"> 1760</span>  }</div>
<div class="line"><span class="lineno"> 1761</span> </div>
<div class="line"><span class="lineno"> 1762</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1763</span>}</div>
<div class="line"><span class="lineno"> 1764</span> </div>
<div class="line"><span class="lineno"> 1765</span><span class="preprocessor">#endif </span><span class="comment">// __HOOKE_ELEMENT_HPP</span></div>
<div class="ttc" id="aHookeElement_8hpp_html_a6237f89a3868d67c0a4dbd704ee03990"><div class="ttname"><a href="HookeElement_8hpp.html#a6237f89a3868d67c0a4dbd704ee03990">addElasticElement</a></div><div class="ttdeci">static MoFEMErrorCode addElasticElement(MoFEM::Interface &amp;m_field, boost::shared_ptr&lt; map&lt; int, BlockData &gt; &gt; &amp;block_sets_ptr, const std::string element_name, const std::string x_field, const std::string X_field, const bool ale)</div></div>
<div class="ttc" id="aHookeElement_8hpp_html_a76d1b67e03b64ca1ae3edb7b0788e578"><div class="ttname"><a href="HookeElement_8hpp.html#a76d1b67e03b64ca1ae3edb7b0788e578">setOperators</a></div><div class="ttdeci">static MoFEMErrorCode setOperators(boost::shared_ptr&lt; ForcesAndSourcesCore &gt; fe_lhs_ptr, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; fe_rhs_ptr, boost::shared_ptr&lt; map&lt; int, BlockData &gt; &gt; block_sets_ptr, const std::string x_field, const std::string X_field, const bool ale, const bool field_disp, const EntityType type=MBTET, boost::shared_ptr&lt; DataAtIntegrationPts &gt; data_at_pts=nullptr)</div></div>
<div class="ttc" id="aHookeElement_8hpp_html_ab02600da9e2ca129f6258b0e880c1e0e"><div class="ttname"><a href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a></div><div class="ttdeci">#define MAT_TO_DDG(SM)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00142">HookeElement.hpp:142</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_acbad9d6ebbe635c14d71762f3c5b6fcd"><div class="ttname"><a href="HookeElement_8hpp.html#acbad9d6ebbe635c14d71762f3c5b6fcd">setBlocks</a></div><div class="ttdeci">static MoFEMErrorCode setBlocks(MoFEM::Interface &amp;m_field, boost::shared_ptr&lt; map&lt; int, BlockData &gt; &gt; &amp;block_sets_ptr)</div></div>
<div class="ttc" id="aHookeElement_8hpp_html_ad231e62173ae2a67709c00b3c866a198"><div class="ttname"><a href="HookeElement_8hpp.html#ad231e62173ae2a67709c00b3c866a198">invJac</a></div><div class="ttdeci">MatrixDouble invJac</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00683">HookeElement.hpp:683</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_adc8b2d0d211d4aa4590cf708695ddcaa"><div class="ttname"><a href="HookeElement_8hpp.html#adc8b2d0d211d4aa4590cf708695ddcaa">calculateEnergy</a></div><div class="ttdeci">static MoFEMErrorCode calculateEnergy(DM dm, boost::shared_ptr&lt; map&lt; int, BlockData &gt; &gt; block_sets_ptr, const std::string x_field, const std::string X_field, const bool ale, const bool field_disp, SmartPetscObj&lt; Vec &gt; &amp;v_energy_ptr)</div></div>
<div class="ttc" id="aHookeElement_8hpp_html_aee27a2ebc8f3d34a5c1ce71b2607d1a3"><div class="ttname"><a href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a></div><div class="ttdeci">ForcesAndSourcesCore::UserDataOperator UserDataOperator</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00075">HookeElement.hpp:75</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="aclassELEMENT_html"><div class="ttname"><a href="classELEMENT.html">ELEMENT</a></div></div>
<div class="ttc" id="aclassEntityHandle_html"><div class="ttname"><a href="classEntityHandle.html">EntityHandle</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Christof_html"><div class="ttname"><a href="classFTensor_1_1Christof.html">FTensor::Christof</a></div><div class="ttdef"><b>Definition</b> <a href="Christof__value_8hpp_source.html#l00009">Christof_value.hpp:10</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Ddg_html"><div class="ttname"><a href="classFTensor_1_1Ddg.html">FTensor::Ddg</a></div><div class="ttdef"><b>Definition</b> <a href="Ddg__value_8hpp_source.html#l00007">Ddg_value.hpp:8</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition</b> <a href="Index_8hpp_source.html#l00023">Index.hpp:24</a></div></div>
<div class="ttc" id="aclassFTensor_1_1PackPtr_html"><div class="ttname"><a href="classFTensor_1_1PackPtr.html">FTensor::PackPtr</a></div><div class="ttdef"><b>Definition</b> <a href="FTensor_8hpp_source.html#l00054">FTensor.hpp:55</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2__symmetric_html"><div class="ttname"><a href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor2__symmetric__value_8hpp_source.html#l00013">Tensor2_symmetric_value.hpp:14</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2_html"><div class="ttname"><a href="classFTensor_1_1Tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:17</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor3_html"><div class="ttname"><a href="classFTensor_1_1Tensor3.html">FTensor::Tensor3</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor3__value_8hpp_source.html#l00012">Tensor3_value.hpp:13</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor4_html"><div class="ttname"><a href="classFTensor_1_1Tensor4.html">FTensor::Tensor4</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor4__value_8hpp_source.html#l00018">Tensor4_value.hpp:19</a></div></div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div></div>
<div class="ttc" id="aclassUBlasMatrix_3_01double_01_4_html"><div class="ttname"><a href="classUBlasMatrix_3_01double_01_4.html">UBlasMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassUBlasVector_3_01double_01_4_html"><div class="ttname"><a href="classUBlasVector_3_01double_01_4.html">UBlasVector&lt; double &gt;</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00463">definitions.h:463</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00432">definitions.h:432</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00551">definitions.h:551</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_ad8657a5ec76e12f3066fb4b4eb75ace9"><div class="ttname"><a href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a></div><div class="ttdeci">double D</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00044">initial_diffusion.cpp:44</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_afd53743d1af6bfa2856255b23b5a41a9"><div class="ttname"><a href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a></div><div class="ttdeci">const double n</div><div class="ttdoc">refractive index of diffusive medium</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00038">initial_diffusion.cpp:38</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_ae967f785b1cef58c8f4ea26e44112f83"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#ae967f785b1cef58c8f4ea26e44112f83">MoFEM::Types::VectorInt</a></div><div class="ttdeci">UBlasVector&lt; int &gt; VectorInt</div><div class="ttdef"><b>Definition</b> <a href="Types_8hpp_source.html#l00067">Types.hpp:67</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a01f67868b6366749021d5258535655cd"><div class="ttname"><a href="namespaceMoFEM.html#a01f67868b6366749021d5258535655cd">MoFEM::type_from_handle</a></div><div class="ttdeci">auto type_from_handle(const EntityHandle h)</div><div class="ttdoc">get type from entity handle</div><div class="ttdef"><b>Definition</b> <a href="Templates_8hpp_source.html#l01898">Templates.hpp:1898</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a0689d2a630ba3cee683b02982b467c77"><div class="ttname"><a href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">MoFEM::K</a></div><div class="ttdeci">VectorDouble K</div><div class="ttdef"><b>Definition</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00125">Projection10NodeCoordsOnField.cpp:125</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a7064ec9e939c81c212cc726272c0e088"><div class="ttname"><a href="namespaceMoFEM.html#a7064ec9e939c81c212cc726272c0e088">MoFEM::invertTensor3by3</a></div><div class="ttdeci">MoFEMErrorCode invertTensor3by3(ublas::matrix&lt; T, L, A &gt; &amp;jac_data, ublas::vector&lt; T, A &gt; &amp;det_data, ublas::matrix&lt; T, L, A &gt; &amp;inv_jac_data)</div><div class="ttdoc">Calculate inverse of tensor rank 2 at integration points.</div><div class="ttdef"><b>Definition</b> <a href="Templates_8hpp_source.html#l01588">Templates.hpp:1588</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a75aed9eb5f422c1955dbbdacb26c2b38"><div class="ttname"><a href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">MoFEM::th</a></div><div class="ttdeci">Tag th</div><div class="ttdef"><b>Definition</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00122">Projection10NodeCoordsOnField.cpp:122</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l01644">EntitiesFieldData.hpp:1644</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ae3a0416ae2eb4b327e43ef2dfc21a15a"><div class="ttname"><a href="namespaceMoFEM.html#ae3a0416ae2eb4b327e43ef2dfc21a15a">MoFEM::determinantTensor3by3</a></div><div class="ttdeci">static auto determinantTensor3by3(T &amp;t)</div><div class="ttdoc">Calculate the determinant of a 3x3 matrix or a tensor of rank 2.</div><div class="ttdef"><b>Definition</b> <a href="Templates_8hpp_source.html#l01540">Templates.hpp:1540</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a80e685c1c2056739a335dd39b1981ef7"><div class="ttname"><a href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">convert.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="anamespacesdf__wavy__2d_html_ab736ce7138c0ba29f61877ebea4f2bc6"><div class="ttname"><a href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">sdf_wavy_2d.w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition</b> <a href="sdf__wavy__2d_8py_source.html#l00006">sdf_wavy_2d.py:6</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1BlockData_html"><div class="ttname"><a href="structConvectiveMassElement_1_1BlockData.html">ConvectiveMassElement::BlockData</a></div><div class="ttdoc">data for calculation inertia forces</div><div class="ttdef"><b>Definition</b> <a href="ConvectiveMassElement_8hpp_source.html#l00116">ConvectiveMassElement.hpp:116</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1BlockData_html_a0f6b9d30c7356f7bdc43f0e0a6763871"><div class="ttname"><a href="structConvectiveMassElement_1_1BlockData.html#a0f6b9d30c7356f7bdc43f0e0a6763871">ConvectiveMassElement::BlockData::tEts</a></div><div class="ttdeci">Range tEts</div><div class="ttdoc">elements in block set</div><div class="ttdef"><b>Definition</b> <a href="ConvectiveMassElement_8hpp_source.html#l00119">ConvectiveMassElement.hpp:119</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1BlockData_html_a80d482c09c0814c12ae85e5887dc9cef"><div class="ttname"><a href="structConvectiveMassElement_1_1BlockData.html#a80d482c09c0814c12ae85e5887dc9cef">ConvectiveMassElement::BlockData::rho0</a></div><div class="ttdeci">double rho0</div><div class="ttdoc">reference density</div><div class="ttdef"><b>Definition</b> <a href="ConvectiveMassElement_8hpp_source.html#l00117">ConvectiveMassElement.hpp:117</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BlockData_html"><div class="ttname"><a href="structMoFEM_1_1BlockData.html">MoFEM::BlockData</a></div><div class="ttdef"><b>Definition</b> <a href="MeshsetsManager_8cpp_source.html#l00766">MeshsetsManager.cpp:766</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a0488e04e389071c795c0233b028de015"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">MoFEM::EntitiesFieldData::EntData::getFTensor1DiffN</a></div><div class="ttdeci">FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, Tensor_Dim &gt;, Tensor_Dim &gt; getFTensor1DiffN(const FieldApproximationBase base)</div><div class="ttdoc">Get derivatives of base functions.</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8cpp_source.html#l00526">EntitiesFieldData.cpp:526</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a1effe6c5260104eb70a930d993942675"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">MoFEM::EntitiesFieldData::EntData::getFTensor0N</a></div><div class="ttdeci">FTensor::Tensor0&lt; FTensor::PackPtr&lt; double *, 1 &gt; &gt; getFTensor0N(const FieldApproximationBase base)</div><div class="ttdoc">Get base function as Tensor0.</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l01502">EntitiesFieldData.hpp:1502</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a6803bfc79169740e108bd5e2666de739"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">MoFEM::EntitiesFieldData::EntData::getN</a></div><div class="ttdeci">MatrixDouble &amp; getN(const FieldApproximationBase base)</div><div class="ttdoc">get base functions this return matrix (nb. of rows is equal to nb. of Gauss pts, nb....</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l01318">EntitiesFieldData.hpp:1318</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_ae5f8ff17de93c9dbb9701dc0bf067b2e"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">MoFEM::EntitiesFieldData::EntData::getIndices</a></div><div class="ttdeci">const VectorInt &amp; getIndices() const</div><div class="ttdoc">Get global indices of dofs on entity.</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l01214">EntitiesFieldData.hpp:1214</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html_ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">MoFEM::ForcesAndSourcesCore::UserDataOperator::OPROWCOL</a></div><div class="ttdeci">@ OPROWCOL</div><div class="ttdoc">operator doWork is executed on FE rows &amp;columns</div><div class="ttdef"><b>Definition</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00569">ForcesAndSourcesCore.hpp:569</a></div></div>
<div class="ttc" id="astructMoFEM_1_1SmartPetscObj_html"><div class="ttname"><a href="structMoFEM_1_1SmartPetscObj.html">MoFEM::SmartPetscObj</a></div><div class="ttdoc">intrusive_ptr for managing petsc objects</div><div class="ttdef"><b>Definition</b> <a href="PetscSmartObj_8hpp_source.html#l00082">PetscSmartObj.hpp:83</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00109">VolumeElementForcesAndSourcesCore.hpp:110</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">MoFEM::VolumeElementForcesAndSourcesCore</a></div><div class="ttdoc">Volume finite element base.</div><div class="ttdef"><b>Definition</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00026">VolumeElementForcesAndSourcesCore.hpp:26</a></div></div>
<div class="ttc" id="astructOpAleLhsPre__dX__dx_html"><div class="ttname"><a href="structOpAleLhsPre__dX__dx.html">OpAleLhsPre_dX_dx</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00536">HookeElement.hpp:536</a></div></div>
<div class="ttc" id="astructOpAleLhsPre__dX__dx_html_aa0ea6ee00cb6a9b468b9215324143d5a"><div class="ttname"><a href="structOpAleLhsPre__dX__dx.html#aa0ea6ee00cb6a9b468b9215324143d5a">OpAleLhsPre_dX_dx::dataAtPts</a></div><div class="ttdeci">boost::shared_ptr&lt; DataAtIntegrationPts &gt; dataAtPts</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00544">HookeElement.hpp:544</a></div></div>
<div class="ttc" id="astructOpAleLhsPre__dX__dx_html_ab77b06ce6d9d7c4c318d9fa8953decda"><div class="ttname"><a href="structOpAleLhsPre__dX__dx.html#ab77b06ce6d9d7c4c318d9fa8953decda">OpAleLhsPre_dX_dx::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, EntityType row_type, EntData &amp;row_data)</div><div class="ttdoc">Operator for linear form, usually to calculate values on right hand side.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l01313">HookeElement.hpp:1313</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dX__dX_html"><div class="ttname"><a href="structOpAleLhsWithDensity__dX__dX.html">OpAleLhsWithDensity_dX_dX</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00488">HookeElement.hpp:488</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dX__dX_html_a19ba774fdf5016c8e37672ebcfb9c783"><div class="ttname"><a href="structOpAleLhsWithDensity__dX__dX.html#a19ba774fdf5016c8e37672ebcfb9c783">OpAleLhsWithDensity_dX_dX::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Integrate tangent stiffness for material momentum.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l00896">HookeElement.cpp:896</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dX__dX_html_a3007c61d353f2b36c10341a8a8f34895"><div class="ttname"><a href="structOpAleLhsWithDensity__dX__dX.html#a3007c61d353f2b36c10341a8a8f34895">OpAleLhsWithDensity_dX_dX::rhoN</a></div><div class="ttdeci">const double rhoN</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00492">HookeElement.hpp:492</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dX__dX_html_a3f20ec4ea0cf4e8b51ad057c9012bbe5"><div class="ttname"><a href="structOpAleLhsWithDensity__dX__dX.html#a3f20ec4ea0cf4e8b51ad057c9012bbe5">OpAleLhsWithDensity_dX_dX::rhoAtGaussPtsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; VectorDouble &gt; rhoAtGaussPtsPtr</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00490">HookeElement.hpp:490</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dX__dX_html_a7e7f6d71493237fa4829512ce75a8c90"><div class="ttname"><a href="structOpAleLhsWithDensity__dX__dX.html#a7e7f6d71493237fa4829512ce75a8c90">OpAleLhsWithDensity_dX_dX::rHo0</a></div><div class="ttdeci">const double rHo0</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00493">HookeElement.hpp:493</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dX__dX_html_a82ce116ee2a785111c6a9d63fd871452"><div class="ttname"><a href="structOpAleLhsWithDensity__dX__dX.html#a82ce116ee2a785111c6a9d63fd871452">OpAleLhsWithDensity_dX_dX::rhoGradAtGaussPtsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; MatrixDouble &gt; rhoGradAtGaussPtsPtr</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00491">HookeElement.hpp:491</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dx__dX_html"><div class="ttname"><a href="structOpAleLhsWithDensity__dx__dX.html">OpAleLhsWithDensity_dx_dX</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00464">HookeElement.hpp:464</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dx__dX_html_a1af7f3297e2b995c1c78ee197390eb17"><div class="ttname"><a href="structOpAleLhsWithDensity__dx__dX.html#a1af7f3297e2b995c1c78ee197390eb17">OpAleLhsWithDensity_dx_dX::rHo0</a></div><div class="ttdeci">const double rHo0</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00469">HookeElement.hpp:469</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dx__dX_html_a2262cd826e1ca74123492531c2d25d16"><div class="ttname"><a href="structOpAleLhsWithDensity__dx__dX.html#a2262cd826e1ca74123492531c2d25d16">OpAleLhsWithDensity_dx_dX::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Integrate tangent stiffness for spatial momentum.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l01003">HookeElement.cpp:1003</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dx__dX_html_a6a30f6da7b5b1d20dd5c99af58a6be6d"><div class="ttname"><a href="structOpAleLhsWithDensity__dx__dX.html#a6a30f6da7b5b1d20dd5c99af58a6be6d">OpAleLhsWithDensity_dx_dX::rhoAtGaussPtsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; VectorDouble &gt; rhoAtGaussPtsPtr</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00466">HookeElement.hpp:466</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dx__dX_html_a7247a8ee1e2301aec4d03b7c9068d1fd"><div class="ttname"><a href="structOpAleLhsWithDensity__dx__dX.html#a7247a8ee1e2301aec4d03b7c9068d1fd">OpAleLhsWithDensity_dx_dX::rhoN</a></div><div class="ttdeci">const double rhoN</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00468">HookeElement.hpp:468</a></div></div>
<div class="ttc" id="astructOpAleLhsWithDensity__dx__dX_html_ada7a7778a4510a34ef65b5edc7cec34c"><div class="ttname"><a href="structOpAleLhsWithDensity__dx__dX.html#ada7a7778a4510a34ef65b5edc7cec34c">OpAleLhsWithDensity_dx_dX::rhoGradAtGaussPtsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; MatrixDouble &gt; rhoGradAtGaussPtsPtr</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00467">HookeElement.hpp:467</a></div></div>
<div class="ttc" id="astructOpAleLhs__dX__dX_html"><div class="ttname"><a href="structOpAleLhs__dX__dX.html">OpAleLhs_dX_dX</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00521">HookeElement.hpp:521</a></div></div>
<div class="ttc" id="astructOpAleLhs__dX__dX_html_ac0c0f8469d09a3c8d5cf24086d7a2839"><div class="ttname"><a href="structOpAleLhs__dX__dX.html#ac0c0f8469d09a3c8d5cf24086d7a2839">OpAleLhs_dX_dX::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Integrate tangent stiffness for material momentum.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l01148">HookeElement.hpp:1148</a></div></div>
<div class="ttc" id="astructOpAleLhs__dX__dx_html"><div class="ttname"><a href="structOpAleLhs__dX__dx.html">OpAleLhs_dX_dx</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00547">HookeElement.hpp:547</a></div></div>
<div class="ttc" id="astructOpAleLhs__dX__dx_html_ac34756cda59cfebc772ac5b1dfd56949"><div class="ttname"><a href="structOpAleLhs__dX__dx.html#ac34756cda59cfebc772ac5b1dfd56949">OpAleLhs_dX_dx::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Integrate tangent stiffness for material momentum.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l00787">HookeElement.cpp:787</a></div></div>
<div class="ttc" id="astructOpAleLhs__dx__dX_html"><div class="ttname"><a href="structOpAleLhs__dx__dX.html">OpAleLhs_dx_dX</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00449">HookeElement.hpp:449</a></div></div>
<div class="ttc" id="astructOpAleLhs__dx__dX_html_aaedf597d64a89d65c15f716434be3207"><div class="ttname"><a href="structOpAleLhs__dx__dX.html#aaedf597d64a89d65c15f716434be3207">OpAleLhs_dx_dX::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Integrate tangent stiffness for spatial momentum.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l01019">HookeElement.hpp:1019</a></div></div>
<div class="ttc" id="astructOpAleLhs__dx__dx_html"><div class="ttname"><a href="structOpAleLhs__dx__dx.html">OpAleLhs_dx_dx</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00434">HookeElement.hpp:434</a></div></div>
<div class="ttc" id="astructOpAleLhs__dx__dx_html_a1d4dca94c6e841cd65d3c17b9ea8155e"><div class="ttname"><a href="structOpAleLhs__dx__dx.html#a1d4dca94c6e841cd65d3c17b9ea8155e">OpAleLhs_dx_dx::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Integrate B^T D B operator.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00731">HookeElement.hpp:731</a></div></div>
<div class="ttc" id="astructOpAleRhs__dX_html"><div class="ttname"><a href="structOpAleRhs__dX.html">OpAleRhs_dX</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00512">HookeElement.hpp:512</a></div></div>
<div class="ttc" id="astructOpAleRhs__dX_html_a06926630fc12089665cdca33a740ca88"><div class="ttname"><a href="structOpAleRhs__dX.html#a06926630fc12089665cdca33a740ca88">OpAleRhs_dX::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l00456">HookeElement.cpp:456</a></div></div>
<div class="ttc" id="astructOpAleRhs__dx_html"><div class="ttname"><a href="structOpAleRhs__dx.html">OpAleRhs_dx</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00425">HookeElement.hpp:425</a></div></div>
<div class="ttc" id="astructOpAleRhs__dx_html_a704519a3b08de7c64046ae1b16c89530"><div class="ttname"><a href="structOpAleRhs__dx.html#a704519a3b08de7c64046ae1b16c89530">OpAleRhs_dx::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l00400">HookeElement.cpp:400</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalAleStrain__dX_html"><div class="ttname"><a href="structOpAnalyticalInternalAleStrain__dX.html">OpAnalyticalInternalAleStrain_dX</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00586">HookeElement.hpp:586</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalAleStrain__dX_html_a2820da81b6c5dd054bee521c70a53317"><div class="ttname"><a href="structOpAnalyticalInternalAleStrain__dX.html#a2820da81b6c5dd054bee521c70a53317">OpAnalyticalInternalAleStrain_dX::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l01615">HookeElement.hpp:1615</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalAleStrain__dX_html_a806272c893b15c760306db520bf4edb5"><div class="ttname"><a href="structOpAnalyticalInternalAleStrain__dX.html#a806272c893b15c760306db520bf4edb5">OpAnalyticalInternalAleStrain_dX::matPosAtPtsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; MatrixDouble &gt; matPosAtPtsPtr</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00608">HookeElement.hpp:608</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalAleStrain__dX_html_ad9c7924be8426bcc8ecfe16cde7f5910"><div class="ttname"><a href="structOpAnalyticalInternalAleStrain__dX.html#ad9c7924be8426bcc8ecfe16cde7f5910">OpAnalyticalInternalAleStrain_dX::StrainFunction</a></div><div class="ttdeci">boost::function&lt; FTensor::Tensor2_symmetric&lt; double, 3 &gt;(FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, 1 &gt;, 3 &gt; &amp;t_coords) &gt; StrainFunction</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00597">HookeElement.hpp:597</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalAleStrain__dX_html_af12f093f369ff55c4b339c71e94e2d27"><div class="ttname"><a href="structOpAnalyticalInternalAleStrain__dX.html#af12f093f369ff55c4b339c71e94e2d27">OpAnalyticalInternalAleStrain_dX::strainFun</a></div><div class="ttdeci">StrainFunction strainFun</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00607">HookeElement.hpp:607</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalAleStrain__dx_html"><div class="ttname"><a href="structOpAnalyticalInternalAleStrain__dx.html">OpAnalyticalInternalAleStrain_dx</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00611">HookeElement.hpp:611</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalAleStrain__dx_html_a4bf5ceee5e3320e5a173f5ff93116879"><div class="ttname"><a href="structOpAnalyticalInternalAleStrain__dx.html#a4bf5ceee5e3320e5a173f5ff93116879">OpAnalyticalInternalAleStrain_dx::matPosAtPtsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; MatrixDouble &gt; matPosAtPtsPtr</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00633">HookeElement.hpp:633</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalAleStrain__dx_html_a73dbd4edae5dcaca8b923a69bf15f4d6"><div class="ttname"><a href="structOpAnalyticalInternalAleStrain__dx.html#a73dbd4edae5dcaca8b923a69bf15f4d6">OpAnalyticalInternalAleStrain_dx::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l01698">HookeElement.hpp:1698</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalAleStrain__dx_html_a860937c7f4f83ca876fe15f21d68650d"><div class="ttname"><a href="structOpAnalyticalInternalAleStrain__dx.html#a860937c7f4f83ca876fe15f21d68650d">OpAnalyticalInternalAleStrain_dx::StrainFunction</a></div><div class="ttdeci">boost::function&lt; FTensor::Tensor2_symmetric&lt; double, 3 &gt;(FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, 1 &gt;, 3 &gt; &amp;t_coords) &gt; StrainFunction</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00622">HookeElement.hpp:622</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalAleStrain__dx_html_a87e1fab6e4f7c085b6f24a5713a395eb"><div class="ttname"><a href="structOpAnalyticalInternalAleStrain__dx.html#a87e1fab6e4f7c085b6f24a5713a395eb">OpAnalyticalInternalAleStrain_dx::strainFun</a></div><div class="ttdeci">StrainFunction strainFun</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00632">HookeElement.hpp:632</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalStrain__dx_html"><div class="ttname"><a href="structOpAnalyticalInternalStrain__dx.html">OpAnalyticalInternalStrain_dx</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00563">HookeElement.hpp:563</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalStrain__dx_html_a469dff62979e6ddb454ceed2ab9ccabf"><div class="ttname"><a href="structOpAnalyticalInternalStrain__dx.html#a469dff62979e6ddb454ceed2ab9ccabf">OpAnalyticalInternalStrain_dx::StrainFunction</a></div><div class="ttdeci">boost::function&lt; FTensor::Tensor2_symmetric&lt; double, 3 &gt;(FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, 3 &gt;, 3 &gt; &amp;t_coords) &gt; StrainFunction</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00574">HookeElement.hpp:574</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalStrain__dx_html_a6b454377db01e5d1cda97da9fc8ff89c"><div class="ttname"><a href="structOpAnalyticalInternalStrain__dx.html#a6b454377db01e5d1cda97da9fc8ff89c">OpAnalyticalInternalStrain_dx::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l01544">HookeElement.hpp:1544</a></div></div>
<div class="ttc" id="astructOpAnalyticalInternalStrain__dx_html_abf86f95b2f931a46361f2bf52d892701"><div class="ttname"><a href="structOpAnalyticalInternalStrain__dx.html#abf86f95b2f931a46361f2bf52d892701">OpAnalyticalInternalStrain_dx::strainFun</a></div><div class="ttdeci">StrainFunction strainFun</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00583">HookeElement.hpp:583</a></div></div>
<div class="ttc" id="astructOpAssemble_html"><div class="ttname"><a href="structOpAssemble.html">OpAssemble</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00340">HookeElement.hpp:340</a></div></div>
<div class="ttc" id="astructOpAssemble_html_a10020c5c579681cbbb11290b5ad17aa5"><div class="ttname"><a href="structOpAssemble.html#a10020c5c579681cbbb11290b5ad17aa5">OpAssemble::nbCols</a></div><div class="ttdeci">int nbCols</div><div class="ttdoc">number if dof on column</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00374">HookeElement.hpp:374</a></div></div>
<div class="ttc" id="astructOpAssemble_html_a16fad0cd7f025348a9f8e9edd0160fd8"><div class="ttname"><a href="structOpAssemble.html#a16fad0cd7f025348a9f8e9edd0160fd8">OpAssemble::iNtegrate</a></div><div class="ttdeci">virtual MoFEMErrorCode iNtegrate(EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l00247">HookeElement.cpp:247</a></div></div>
<div class="ttc" id="astructOpAssemble_html_a1d19204f444042ab029d5991af7dc72c"><div class="ttname"><a href="structOpAssemble.html#a1d19204f444042ab029d5991af7dc72c">OpAssemble::isDiag</a></div><div class="ttdeci">bool isDiag</div><div class="ttdoc">true if this block is on diagonal</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00376">HookeElement.hpp:376</a></div></div>
<div class="ttc" id="astructOpAssemble_html_a3f1100d3d0af18a117f4f9a0f9b6f257"><div class="ttname"><a href="structOpAssemble.html#a3f1100d3d0af18a117f4f9a0f9b6f257">OpAssemble::nF</a></div><div class="ttdeci">VectorDouble nF</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00366">HookeElement.hpp:366</a></div></div>
<div class="ttc" id="astructOpAssemble_html_a807f314980fbe5e2c79ad962d96fac1e"><div class="ttname"><a href="structOpAssemble.html#a807f314980fbe5e2c79ad962d96fac1e">OpAssemble::aSsemble</a></div><div class="ttdeci">MoFEMErrorCode aSsemble(EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Assemble local entity block matrix.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l00260">HookeElement.cpp:260</a></div></div>
<div class="ttc" id="astructOpAssemble_html_a819bee26b41fc0540ad1b75dc647b6e8"><div class="ttname"><a href="structOpAssemble.html#a819bee26b41fc0540ad1b75dc647b6e8">OpAssemble::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Do calculations for give operator.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l00176">HookeElement.cpp:176</a></div></div>
<div class="ttc" id="astructOpAssemble_html_a89cdaf7af4d557c5510cc1b48c3be7e9"><div class="ttname"><a href="structOpAssemble.html#a89cdaf7af4d557c5510cc1b48c3be7e9">OpAssemble::dataAtPts</a></div><div class="ttdeci">boost::shared_ptr&lt; DataAtIntegrationPts &gt; dataAtPts</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00368">HookeElement.hpp:368</a></div></div>
<div class="ttc" id="astructOpAssemble_html_aa00cc105f94b4c178f7b4c0c8495c7e6"><div class="ttname"><a href="structOpAssemble.html#aa00cc105f94b4c178f7b4c0c8495c7e6">OpAssemble::nbIntegrationPts</a></div><div class="ttdeci">int nbIntegrationPts</div><div class="ttdoc">number of integration points</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00375">HookeElement.hpp:375</a></div></div>
<div class="ttc" id="astructOpAssemble_html_aac58d6aecf95cf5ba53135c8fd959575"><div class="ttname"><a href="structOpAssemble.html#aac58d6aecf95cf5ba53135c8fd959575">OpAssemble::nbRows</a></div><div class="ttdeci">int nbRows</div><div class="ttdoc">number of dofs on rows</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00373">HookeElement.hpp:373</a></div></div>
<div class="ttc" id="astructOpAssemble_html_aac9feff92340e14bc8f295148335abce"><div class="ttname"><a href="structOpAssemble.html#aac9feff92340e14bc8f295148335abce">OpAssemble::transK</a></div><div class="ttdeci">MatrixDouble transK</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00365">HookeElement.hpp:365</a></div></div>
<div class="ttc" id="astructOpAssemble_html_ab08dbd4d77e97604f6d0f7b016e0b8b0"><div class="ttname"><a href="structOpAssemble.html#ab08dbd4d77e97604f6d0f7b016e0b8b0">OpAssemble::colIndices</a></div><div class="ttdeci">VectorInt colIndices</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00371">HookeElement.hpp:371</a></div></div>
<div class="ttc" id="astructOpAssemble_html_abbfe04a89e64fc8b4dbabf0ad01e1e32"><div class="ttname"><a href="structOpAssemble.html#abbfe04a89e64fc8b4dbabf0ad01e1e32">OpAssemble::rowIndices</a></div><div class="ttdeci">VectorInt rowIndices</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00370">HookeElement.hpp:370</a></div></div>
<div class="ttc" id="astructOpAssemble_html_aefb7d1e9b1517844b14075f185afd2aa"><div class="ttname"><a href="structOpAssemble.html#aefb7d1e9b1517844b14075f185afd2aa">OpAssemble::K</a></div><div class="ttdeci">MatrixDouble K</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00364">HookeElement.hpp:364</a></div></div>
<div class="ttc" id="astructOpCalculateEnergy_html"><div class="ttname"><a href="structOpCalculateEnergy.html">OpCalculateEnergy</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00164">HookeElement.hpp:164</a></div></div>
<div class="ttc" id="astructOpCalculateEnergy_html_a97ba5f4592381978ca5d93d517e41bde"><div class="ttname"><a href="structOpCalculateEnergy.html#a97ba5f4592381978ca5d93d517e41bde">OpCalculateEnergy::ghostVec</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; ghostVec</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00174">HookeElement.hpp:174</a></div></div>
<div class="ttc" id="astructOpCalculateEnergy_html_aacf4b4873b0416bdd9264ee1dbe64976"><div class="ttname"><a href="structOpCalculateEnergy.html#aacf4b4873b0416bdd9264ee1dbe64976">OpCalculateEnergy::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, EntityType row_type, EntData &amp;row_data)</div><div class="ttdoc">Operator for linear form, usually to calculate values on right hand side.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l00081">HookeElement.cpp:81</a></div></div>
<div class="ttc" id="astructOpCalculateEnergy_html_ab2cc832e3898addc031110f64413ca94"><div class="ttname"><a href="structOpCalculateEnergy.html#ab2cc832e3898addc031110f64413ca94">OpCalculateEnergy::dataAtPts</a></div><div class="ttdeci">boost::shared_ptr&lt; DataAtIntegrationPts &gt; dataAtPts</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00173">HookeElement.hpp:173</a></div></div>
<div class="ttc" id="astructOpCalculateEshelbyStress_html"><div class="ttname"><a href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00177">HookeElement.hpp:177</a></div></div>
<div class="ttc" id="astructOpCalculateEshelbyStress_html_a3973777d822ad00105354038c01f3b2f"><div class="ttname"><a href="structOpCalculateEshelbyStress.html#a3973777d822ad00105354038c01f3b2f">OpCalculateEshelbyStress::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, EntityType row_type, EntData &amp;row_data)</div><div class="ttdoc">Operator for linear form, usually to calculate values on right hand side.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l00138">HookeElement.cpp:138</a></div></div>
<div class="ttc" id="astructOpCalculateEshelbyStress_html_a6bbc72d43bfd4ac78f50e1b6136912a2"><div class="ttname"><a href="structOpCalculateEshelbyStress.html#a6bbc72d43bfd4ac78f50e1b6136912a2">OpCalculateEshelbyStress::dataAtPts</a></div><div class="ttdeci">boost::shared_ptr&lt; DataAtIntegrationPts &gt; dataAtPts</div><div class="ttdoc">data at integration pts</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00186">HookeElement.hpp:186</a></div></div>
<div class="ttc" id="astructOpCalculateHomogeneousStiffness_html"><div class="ttname"><a href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00190">HookeElement.hpp:190</a></div></div>
<div class="ttc" id="astructOpCalculateHomogeneousStiffness_html_a0bd52e495ceb241fcbed1bca60b0d715"><div class="ttname"><a href="structOpCalculateHomogeneousStiffness.html#a0bd52e495ceb241fcbed1bca60b0d715">OpCalculateHomogeneousStiffness::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, EntityType row_type, EntData &amp;row_data)</div><div class="ttdoc">Operator for linear form, usually to calculate values on right hand side.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00836">HookeElement.hpp:836</a></div></div>
<div class="ttc" id="astructOpCalculateHomogeneousStiffness_html_a2445b7a298622b5ae159f63a3b2d3c7c"><div class="ttname"><a href="structOpCalculateHomogeneousStiffness.html#a2445b7a298622b5ae159f63a3b2d3c7c">OpCalculateHomogeneousStiffness::blockSetsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; map&lt; int, BlockData &gt; &gt; blockSetsPtr</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00201">HookeElement.hpp:201</a></div></div>
<div class="ttc" id="astructOpCalculateHomogeneousStiffness_html_a8a8cedb4f8852ad43fb76181000512e7"><div class="ttname"><a href="structOpCalculateHomogeneousStiffness.html#a8a8cedb4f8852ad43fb76181000512e7">OpCalculateHomogeneousStiffness::dataAtPts</a></div><div class="ttdeci">boost::shared_ptr&lt; DataAtIntegrationPts &gt; dataAtPts</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00203">HookeElement.hpp:203</a></div></div>
<div class="ttc" id="astructOpCalculateMassMatrix_html"><div class="ttname"><a href="structOpCalculateMassMatrix.html">OpCalculateMassMatrix</a></div><div class="ttdoc">Assemble mass matrix for elastic element TODO: CHANGE FORMULA *.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00212">HookeElement.hpp:213</a></div></div>
<div class="ttc" id="astructOpCalculateMassMatrix_html_a3190b48af86b5447c80493ebe42e5190"><div class="ttname"><a href="structOpCalculateMassMatrix.html#a3190b48af86b5447c80493ebe42e5190">OpCalculateMassMatrix::dAta</a></div><div class="ttdeci">BlockData &amp; dAta</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00217">HookeElement.hpp:217</a></div></div>
<div class="ttc" id="astructOpCalculateMassMatrix_html_a406c43391020849bfd93faf82c49351e"><div class="ttname"><a href="structOpCalculateMassMatrix.html#a406c43391020849bfd93faf82c49351e">OpCalculateMassMatrix::doWork</a></div><div class="ttdeci">PetscErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00231">HookeElement.hpp:231</a></div></div>
<div class="ttc" id="astructOpCalculateMassMatrix_html_a95de87bca20b20db046c64ccd99f3e04"><div class="ttname"><a href="structOpCalculateMassMatrix.html#a95de87bca20b20db046c64ccd99f3e04">OpCalculateMassMatrix::massData</a></div><div class="ttdeci">MassBlockData &amp; massData</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00218">HookeElement.hpp:218</a></div></div>
<div class="ttc" id="astructOpCalculateMassMatrix_html_abd5eebc4aebc88ad11ae0e4498ac19d7"><div class="ttname"><a href="structOpCalculateMassMatrix.html#abd5eebc4aebc88ad11ae0e4498ac19d7">OpCalculateMassMatrix::commonData</a></div><div class="ttdeci">boost::shared_ptr&lt; DataAtIntegrationPts &gt; commonData</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00220">HookeElement.hpp:220</a></div></div>
<div class="ttc" id="astructOpCalculateMassMatrix_html_ae5f13349069a44c19f7deb9a58216d20"><div class="ttname"><a href="structOpCalculateMassMatrix.html#ae5f13349069a44c19f7deb9a58216d20">OpCalculateMassMatrix::locK</a></div><div class="ttdeci">MatrixDouble locK</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00215">HookeElement.hpp:215</a></div></div>
<div class="ttc" id="astructOpCalculateMassMatrix_html_af17428fde4b2b7ad05c13e35acdc42d7"><div class="ttname"><a href="structOpCalculateMassMatrix.html#af17428fde4b2b7ad05c13e35acdc42d7">OpCalculateMassMatrix::translocK</a></div><div class="ttdeci">MatrixDouble translocK</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00216">HookeElement.hpp:216</a></div></div>
<div class="ttc" id="astructOpCalculateStiffnessScaledByDensityField_html"><div class="ttname"><a href="structOpCalculateStiffnessScaledByDensityField.html">OpCalculateStiffnessScaledByDensityField</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00318">HookeElement.hpp:318</a></div></div>
<div class="ttc" id="astructOpCalculateStiffnessScaledByDensityField_html_a5519d9158a78fce4d0df3e099e801c72"><div class="ttname"><a href="structOpCalculateStiffnessScaledByDensityField.html#a5519d9158a78fce4d0df3e099e801c72">OpCalculateStiffnessScaledByDensityField::rHo0</a></div><div class="ttdeci">const double rHo0</div><div class="ttdoc">p_0 reference density in E(p) = E * (p / p_0)^n</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00327">HookeElement.hpp:327</a></div></div>
<div class="ttc" id="astructOpCalculateStiffnessScaledByDensityField_html_a6cbd5de30d5bc2b55d6f7eb7cab68aa3"><div class="ttname"><a href="structOpCalculateStiffnessScaledByDensityField.html#a6cbd5de30d5bc2b55d6f7eb7cab68aa3">OpCalculateStiffnessScaledByDensityField::blockSetsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; map&lt; int, BlockData &gt; &gt; blockSetsPtr</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00321">HookeElement.hpp:321</a></div></div>
<div class="ttc" id="astructOpCalculateStiffnessScaledByDensityField_html_a7a4a1760faabd11596f0dcca2f4d6bb8"><div class="ttname"><a href="structOpCalculateStiffnessScaledByDensityField.html#a7a4a1760faabd11596f0dcca2f4d6bb8">OpCalculateStiffnessScaledByDensityField::dataAtPts</a></div><div class="ttdeci">boost::shared_ptr&lt; DataAtIntegrationPts &gt; dataAtPts</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00323">HookeElement.hpp:323</a></div></div>
<div class="ttc" id="astructOpCalculateStiffnessScaledByDensityField_html_ab1a2305a5692299b9e3db83e6da604a7"><div class="ttname"><a href="structOpCalculateStiffnessScaledByDensityField.html#ab1a2305a5692299b9e3db83e6da604a7">OpCalculateStiffnessScaledByDensityField::rhoAtGaussPtsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; VectorDouble &gt; rhoAtGaussPtsPtr</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00325">HookeElement.hpp:325</a></div></div>
<div class="ttc" id="astructOpCalculateStiffnessScaledByDensityField_html_abc81e05004bfc87aa64a28332ee8764e"><div class="ttname"><a href="structOpCalculateStiffnessScaledByDensityField.html#abc81e05004bfc87aa64a28332ee8764e">OpCalculateStiffnessScaledByDensityField::rhoN</a></div><div class="ttdeci">const double rhoN</div><div class="ttdoc">exponent n in E(p) = E * (p / p_0)^n</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00326">HookeElement.hpp:326</a></div></div>
<div class="ttc" id="astructOpCalculateStiffnessScaledByDensityField_html_ad024c65962b53bd790c786d8c703a5b6"><div class="ttname"><a href="structOpCalculateStiffnessScaledByDensityField.html#ad024c65962b53bd790c786d8c703a5b6">OpCalculateStiffnessScaledByDensityField::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, EntityType row_type, EntData &amp;row_data)</div><div class="ttdoc">Operator for linear form, usually to calculate values on right hand side.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l01108">HookeElement.cpp:1108</a></div></div>
<div class="ttc" id="astructOpCalculateStress_html"><div class="ttname"><a href="structOpCalculateStress.html">OpCalculateStress</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00153">HookeElement.hpp:153</a></div></div>
<div class="ttc" id="astructOpLhs__dx__dx_html"><div class="ttname"><a href="structOpLhs__dx__dx.html">OpLhs_dx_dx</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00410">HookeElement.hpp:410</a></div></div>
<div class="ttc" id="astructOpLhs__dx__dx_html_adfe877c964315d650dbc2976fba1ac15"><div class="ttname"><a href="structOpLhs__dx__dx.html#adfe877c964315d650dbc2976fba1ac15">OpLhs_dx_dx::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Integrate B^T D B operator.</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00929">HookeElement.hpp:929</a></div></div>
<div class="ttc" id="astructOpPostProcHookeElement_html"><div class="ttname"><a href="structOpPostProcHookeElement.html">OpPostProcHookeElement</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00637">HookeElement.hpp:637</a></div></div>
<div class="ttc" id="astructOpPostProcHookeElement_html_a199f21146d712f90e908b2c66e942b72"><div class="ttname"><a href="structOpPostProcHookeElement.html#a199f21146d712f90e908b2c66e942b72">OpPostProcHookeElement::isALE</a></div><div class="ttdeci">bool isALE</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00643">HookeElement.hpp:643</a></div></div>
<div class="ttc" id="astructOpPostProcHookeElement_html_a4e682c7256b923b5a384d68a748ca85f"><div class="ttname"><a href="structOpPostProcHookeElement.html#a4e682c7256b923b5a384d68a748ca85f">OpPostProcHookeElement::mapGaussPts</a></div><div class="ttdeci">std::vector&lt; EntityHandle &gt; &amp; mapGaussPts</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00642">HookeElement.hpp:642</a></div></div>
<div class="ttc" id="astructOpPostProcHookeElement_html_a9ae63dfef7612b59b276714feb4089e7"><div class="ttname"><a href="structOpPostProcHookeElement.html#a9ae63dfef7612b59b276714feb4089e7">OpPostProcHookeElement::blockSetsPtr</a></div><div class="ttdeci">map&lt; int, BlockData &gt; &amp; blockSetsPtr</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00640">HookeElement.hpp:640</a></div></div>
<div class="ttc" id="astructOpPostProcHookeElement_html_aa000fec304675ef65368b66bb6908a92"><div class="ttname"><a href="structOpPostProcHookeElement.html#aa000fec304675ef65368b66bb6908a92">OpPostProcHookeElement::isFieldDisp</a></div><div class="ttdeci">bool isFieldDisp</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00644">HookeElement.hpp:644</a></div></div>
<div class="ttc" id="astructOpPostProcHookeElement_html_aa686a9cae8d008461d5a5ef054e97d49"><div class="ttname"><a href="structOpPostProcHookeElement.html#aa686a9cae8d008461d5a5ef054e97d49">OpPostProcHookeElement::postProcMesh</a></div><div class="ttdeci">moab::Interface &amp; postProcMesh</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00641">HookeElement.hpp:641</a></div></div>
<div class="ttc" id="astructOpPostProcHookeElement_html_ab5cc40adaf02bf8c7d80a192baf88930"><div class="ttname"><a href="structOpPostProcHookeElement.html#ab5cc40adaf02bf8c7d80a192baf88930">OpPostProcHookeElement::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int side, EntityType type, EntitiesFieldData::EntData &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l01396">HookeElement.hpp:1396</a></div></div>
<div class="ttc" id="astructOpPostProcHookeElement_html_ad3f62c9a70b271698ea8ff9e79116ec7"><div class="ttname"><a href="structOpPostProcHookeElement.html#ad3f62c9a70b271698ea8ff9e79116ec7">OpPostProcHookeElement::dataAtPts</a></div><div class="ttdeci">boost::shared_ptr&lt; DataAtIntegrationPts &gt; dataAtPts</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00638">HookeElement.hpp:638</a></div></div>
<div class="ttc" id="astructOpRhs__dx_html"><div class="ttname"><a href="structOpRhs__dx.html">OpRhs_dx</a></div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8hpp_source.html#l00401">HookeElement.hpp:401</a></div></div>
<div class="ttc" id="astructOpRhs__dx_html_ab1b64271ff33f9afb54c5dacb8c3a193"><div class="ttname"><a href="structOpRhs__dx.html#ab1b64271ff33f9afb54c5dacb8c3a193">OpRhs_dx::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntData &amp;row_data)</div><div class="ttdef"><b>Definition</b> <a href="HookeElement_8cpp_source.html#l00347">HookeElement.cpp:347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a1342a5bb82a44eb578a7246723649d11" name="a1342a5bb82a44eb578a7246723649d11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1342a5bb82a44eb578a7246723649d11">&#9670;&#160;</a></span>EntData</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntData</a> =  <a class="el" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="HookeElement_8hpp_source.html#l00074">74</a> of file <a class="el" href="HookeElement_8hpp_source.html">HookeElement.hpp</a>.</p>

</div>
</div>
<a id="ad69b938437dfc95379e2431c4360a7a2" name="ad69b938437dfc95379e2431c4360a7a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad69b938437dfc95379e2431c4360a7a2">&#9670;&#160;</a></span>MassBlockData</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="elasticity_8cpp.html#ad69b938437dfc95379e2431c4360a7a2">MassBlockData</a> =  <a class="el" href="structConvectiveMassElement_1_1BlockData.html">ConvectiveMassElement::BlockData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="HookeElement_8hpp_source.html#l00072">72</a> of file <a class="el" href="HookeElement_8hpp_source.html">HookeElement.hpp</a>.</p>

</div>
</div>
<a id="aee27a2ebc8f3d34a5c1ce71b2607d1a3" name="aee27a2ebc8f3d34a5c1ce71b2607d1a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee27a2ebc8f3d34a5c1ce71b2607d1a3">&#9670;&#160;</a></span>UserDataOperator</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a> =  ForcesAndSourcesCore::UserDataOperator</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="HookeElement_8hpp_source.html#l00075">75</a> of file <a class="el" href="HookeElement_8hpp_source.html">HookeElement.hpp</a>.</p>

</div>
</div>
<a id="aa8f978f1e489a9e0ace529ba353e21e4" name="aa8f978f1e489a9e0ace529ba353e21e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8f978f1e489a9e0ace529ba353e21e4">&#9670;&#160;</a></span>VolUserDataOperator</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="elasticity_8cpp.html#aa8f978f1e489a9e0ace529ba353e21e4">VolUserDataOperator</a> =  <a class="el" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="HookeElement_8hpp_source.html#l00076">76</a> of file <a class="el" href="HookeElement_8hpp_source.html">HookeElement.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6237f89a3868d67c0a4dbd704ee03990" name="a6237f89a3868d67c0a4dbd704ee03990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6237f89a3868d67c0a4dbd704ee03990">&#9670;&#160;</a></span>addElasticElement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> addElasticElement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a> &amp;&#160;</td>
          <td class="paramname"><em>m_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; map&lt; int, <a class="el" href="structMoFEM_1_1BlockData.html">BlockData</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>block_sets_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>element_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>x_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>X_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>ale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="HookeElement_8hpp-example.html#a61">HookeElement.hpp</a>.</dd>
</dl>

</div>
</div>
<a id="adc8b2d0d211d4aa4590cf708695ddcaa" name="adc8b2d0d211d4aa4590cf708695ddcaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8b2d0d211d4aa4590cf708695ddcaa">&#9670;&#160;</a></span>calculateEnergy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> calculateEnergy </td>
          <td>(</td>
          <td class="paramtype">DM&#160;</td>
          <td class="paramname"><em>dm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; map&lt; int, <a class="el" href="structMoFEM_1_1BlockData.html">BlockData</a> &gt; &gt;&#160;</td>
          <td class="paramname"><em>block_sets_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>x_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>X_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>ale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>field_disp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj</a>&lt; Vec &gt; &amp;&#160;</td>
          <td class="paramname"><em>v_energy_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="HookeElement_8hpp-example.html#a63">HookeElement.hpp</a>.</dd>
</dl>

</div>
</div>
<a id="acbad9d6ebbe635c14d71762f3c5b6fcd" name="acbad9d6ebbe635c14d71762f3c5b6fcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbad9d6ebbe635c14d71762f3c5b6fcd">&#9670;&#160;</a></span>setBlocks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> setBlocks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a> &amp;&#160;</td>
          <td class="paramname"><em>m_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; map&lt; int, <a class="el" href="structMoFEM_1_1BlockData.html">BlockData</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>block_sets_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="HookeElement_8hpp-example.html#a59">HookeElement.hpp</a>.</dd>
</dl>

</div>
</div>
<a id="a76d1b67e03b64ca1ae3edb7b0788e578" name="a76d1b67e03b64ca1ae3edb7b0788e578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76d1b67e03b64ca1ae3edb7b0788e578">&#9670;&#160;</a></span>setOperators()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> setOperators </td>
          <td>(</td>
          <td class="paramtype">boost::shared_ptr&lt; <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> &gt;&#160;</td>
          <td class="paramname"><em>fe_lhs_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> &gt;&#160;</td>
          <td class="paramname"><em>fe_rhs_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; map&lt; int, <a class="el" href="structMoFEM_1_1BlockData.html">BlockData</a> &gt; &gt;&#160;</td>
          <td class="paramname"><em>block_sets_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>x_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>X_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>ale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>field_disp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const EntityType&#160;</td>
          <td class="paramname"><em>type</em> = <code>MBTET</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; <a class="el" href="structDataAtIntegrationPts.html">DataAtIntegrationPts</a> &gt;&#160;</td>
          <td class="paramname"><em>data_at_pts</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="HookeElement_8hpp-example.html#a62">HookeElement.hpp</a>.</dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad231e62173ae2a67709c00b3c866a198" name="ad231e62173ae2a67709c00b3c866a198"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad231e62173ae2a67709c00b3c866a198">&#9670;&#160;</a></span>invJac</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> invJac</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="HookeElement_8hpp-example.html#a64">HookeElement.hpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HookeElement_8hpp_source.html#l00683">683</a> of file <a class="el" href="HookeElement_8hpp_source.html">HookeElement.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.8
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>