<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.12.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: HookeElement.hpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script>
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">HookeElement.hpp</div></div>
</div><!--header-->
<div class="contents">
<p>Operators and data structures for linear elastic analysis.</p>
<p>Operators and data structures for linear elastic analysisImplemention of operators for <a class="el" href="struct_hooke.html" title="Hook equation.">Hooke</a> material. Implementation is extended to the case when the mesh is moving as results of topological changes, also the calculation of material forces and associated tangent matrices are added to implementation.</p>
<p>In other words, spatial deformation is small but topological changes large.</p>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file HookeElement.hpp</span></div>
<div class="line"><span class="comment"> * \example HookeElement.hpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \brief Operators and data structures for linear elastic</span></div>
<div class="line"><span class="comment"> * analysis</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Implemention of operators for Hooke material. Implementation is extended to</span></div>
<div class="line"><span class="comment"> * the case when the mesh is moving as results of topological changes, also the</span></div>
<div class="line"><span class="comment"> * calculation of material forces and associated tangent matrices are added to</span></div>
<div class="line"><span class="comment"> * implementation.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * In other words, spatial deformation is small but topological changes large.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef __HOOKE_ELEMENT_HPP</span></div>
<div class="line"><span class="preprocessor">#define __HOOKE_ELEMENT_HPP</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef __BASICFINITEELEMENTS_HPP__</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_basic_finite_elements_8hpp.html">BasicFiniteElements.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// __BASICFINITEELEMENTS_HPP__</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef __NONLINEAR_ELASTIC_HPP</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a id="_a0" name="_a0"></a><a class="code hl_struct" href="struct_nonlinear_elastic_element.html">NonlinearElasticElement</a> {</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /** \brief data for calculation heat conductivity and heat capacity elements</span></div>
<div class="line"><span class="comment">   * \ingroup nonlinear_elastic_elem</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">struct </span><a id="_a1" name="_a1"></a><a class="code hl_struct" href="struct_block_data.html">BlockData</a> {</div>
<div class="line">    <span class="keywordtype">int</span> <a id="a2" name="a2"></a><a class="code hl_variable" href="struct_nonlinear_elastic_element_1_1_block_data.html#af5b66ddec9ecb4867174e6472ec3be9d">iD</a>;</div>
<div class="line">    <span class="keywordtype">double</span> <a id="a3" name="a3"></a><a class="code hl_variable" href="struct_nonlinear_elastic_element_1_1_block_data.html#a3ace669cc0a863e24507ab148fa076e8">E</a>;</div>
<div class="line">    <span class="keywordtype">double</span> <a id="a4" name="a4"></a><a class="code hl_variable" href="struct_nonlinear_elastic_element_1_1_block_data.html#a13c65beb8ac81c83ea156ea7b2c9e67d">PoissonRatio</a>;</div>
<div class="line">    <a id="_a5" name="_a5"></a><a class="code hl_class" href="class_range.html">Range</a> <a id="a6" name="a6"></a><a class="code hl_variable" href="struct_nonlinear_elastic_element_1_1_block_data.html#af42f782f66b80d745ba30bc8f20a6a15">tEts</a>; <span class="comment">///&lt; constrains elements in block set</span></div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> <a id="a7" name="a7"></a><a class="code hl_variable" href="struct_nonlinear_elastic_element_1_1_block_data.html#a0d20590055637c87ad4102befe2fbf63">forcesOnlyOnEntitiesRow</a>;</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> <a id="a8" name="a8"></a><a class="code hl_variable" href="struct_nonlinear_elastic_element_1_1_block_data.html#a5f054b9b0e9aaab6ced590aaf49e8237">forcesOnlyOnEntitiesCol</a>;</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// __NONLINEAR_ELASTIC_HPP</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** \brief structure grouping operators and data used for calculation of</span></div>
<div class="line"><span class="comment"> * nonlinear elastic element \ingroup nonlinear_elastic_elem</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * In order to assemble matrices and right hand vectors, the loops over</span></div>
<div class="line"><span class="comment"> * elements, entities over that elements and finally loop over integration</span></div>
<div class="line"><span class="comment"> * points are executed.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Following implementation separate those three categories of loops and to each</span></div>
<div class="line"><span class="comment"> * loop attach operator.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef __CONVECTIVE_MASS_ELEMENT_HPP</span></div>
<div class="line"><span class="keyword">struct </span><a id="_a9" name="_a9"></a><a class="code hl_struct" href="struct_convective_mass_element.html">ConvectiveMassElement</a> {<span class="comment"></span></div>
<div class="line"><span class="comment">  /** \brief data for calculation inertia forces</span></div>
<div class="line"><span class="comment">   * \ingroup user_modules</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">struct </span><a class="code hl_struct" href="struct_block_data.html">BlockData</a> {</div>
<div class="line">    <span class="keywordtype">double</span> <a id="a10" name="a10"></a><a class="code hl_variable" href="struct_convective_mass_element_1_1_block_data.html#a80d482c09c0814c12ae85e5887dc9cef">rho0</a>;     <span class="comment">///&lt; reference density</span></div>
<div class="line">    VectorDouble <a id="a11" name="a11"></a><a class="code hl_variable" href="struct_convective_mass_element_1_1_block_data.html#a80e4eca8e8e2d8cc16950f37180c33e9">a0</a>; <span class="comment">///&lt; constant acceleration</span></div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> <a id="a12" name="a12"></a><a class="code hl_variable" href="struct_convective_mass_element_1_1_block_data.html#a0f6b9d30c7356f7bdc43f0e0a6763871">tEts</a>;      <span class="comment">///&lt; elements in block set</span></div>
<div class="line">  };</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">//__CONVECTIVE_MASS_ELEMENT_HPP</span></div>
<div class="line"><span class="keyword">struct </span><a id="_a13" name="_a13"></a><a class="code hl_class" href="class_hooke_element.html">HookeElement</a> {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_struct" href="struct_block_data.html">BlockData</a> = <a id="_a14" name="_a14"></a><a class="code hl_struct" href="struct_nonlinear_elastic_element_1_1_block_data.html">NonlinearElasticElement::BlockData</a>;</div>
<div class="line">  <span class="keyword">using </span><a id="_a15" name="_a15"></a><a class="code hl_struct" href="struct_convective_mass_element_1_1_block_data.html">MassBlockData</a> = <a class="code hl_struct" href="struct_convective_mass_element_1_1_block_data.html">ConvectiveMassElement::BlockData</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a id="_a16" name="_a16"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> = EntitiesFieldData::EntData;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a> = ForcesAndSourcesCore::UserDataOperator;</div>
<div class="line">  <span class="keyword">using </span><a id="_a17" name="_a17"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a> =</div>
<div class="line">      VolumeElementForcesAndSourcesCore::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a18" name="_a18"></a><a class="code hl_struct" href="struct_data_at_integration_pts.html">DataAtIntegrationPts</a> {</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; smallStrainMat;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; hMat;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; FMat;</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; HMat;</div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; detHVec;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; invHMat;</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; cauchyStressMat;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; stiffnessMat;</div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; energyVec;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; eshelbyStressMat;</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; eshelbyStress_dx;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_data_at_integration_pts.html">DataAtIntegrationPts</a>() {</div>
<div class="line"> </div>
<div class="line">      smallStrainMat = boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> MatrixDouble());</div>
<div class="line">      hMat = boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> MatrixDouble());</div>
<div class="line">      FMat = boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> MatrixDouble());</div>
<div class="line"> </div>
<div class="line">      HMat = boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> MatrixDouble());</div>
<div class="line">      detHVec = boost::shared_ptr&lt;VectorDouble&gt;(<span class="keyword">new</span> VectorDouble());</div>
<div class="line">      invHMat = boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> MatrixDouble());</div>
<div class="line"> </div>
<div class="line">      cauchyStressMat = boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> MatrixDouble());</div>
<div class="line">      stiffnessMat = boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> MatrixDouble());</div>
<div class="line">      energyVec = boost::shared_ptr&lt;VectorDouble&gt;(<span class="keyword">new</span> VectorDouble());</div>
<div class="line">      eshelbyStressMat = boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> MatrixDouble());</div>
<div class="line"> </div>
<div class="line">      eshelbyStress_dx = boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> MatrixDouble());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> forcesOnlyOnEntitiesRow;</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> forcesOnlyOnEntitiesCol;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> D = false&gt;</div>
<div class="line">  <span class="keyword">struct </span><a id="_a19" name="_a19"></a><a class="code hl_struct" href="struct_op_calculate_strain.html">OpCalculateStrain</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_calculate_strain.html">OpCalculateStrain</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                      boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a20" name="_a20"></a><a class="code hl_struct" href="struct_op_calculate_strain_ale.html">OpCalculateStrainAle</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_calculate_strain_ale.html">OpCalculateStrainAle</a>(<span class="keyword">const</span> std::string row_field,</div>
<div class="line">                         <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                         boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAT_TO_DDG(SM)                                                         \</span></div>
<div class="line"><span class="preprocessor">  &amp;(*SM)(0, 0), &amp;(*SM)(1, 0), &amp;(*SM)(2, 0), &amp;(*SM)(3, 0), &amp;(*SM)(4, 0),        \</span></div>
<div class="line"><span class="preprocessor">      &amp;(*SM)(5, 0), &amp;(*SM)(6, 0), &amp;(*SM)(7, 0), &amp;(*SM)(8, 0), &amp;(*SM)(9, 0),    \</span></div>
<div class="line"><span class="preprocessor">      &amp;(*SM)(10, 0), &amp;(*SM)(11, 0), &amp;(*SM)(12, 0), &amp;(*SM)(13, 0),              \</span></div>
<div class="line"><span class="preprocessor">      &amp;(*SM)(14, 0), &amp;(*SM)(15, 0), &amp;(*SM)(16, 0), &amp;(*SM)(17, 0),              \</span></div>
<div class="line"><span class="preprocessor">      &amp;(*SM)(18, 0), &amp;(*SM)(19, 0), &amp;(*SM)(20, 0), &amp;(*SM)(21, 0),              \</span></div>
<div class="line"><span class="preprocessor">      &amp;(*SM)(22, 0), &amp;(*SM)(23, 0), &amp;(*SM)(24, 0), &amp;(*SM)(25, 0),              \</span></div>
<div class="line"><span class="preprocessor">      &amp;(*SM)(26, 0), &amp;(*SM)(27, 0), &amp;(*SM)(28, 0), &amp;(*SM)(29, 0),              \</span></div>
<div class="line"><span class="preprocessor">      &amp;(*SM)(30, 0), &amp;(*SM)(31, 0), &amp;(*SM)(32, 0), &amp;(*SM)(33, 0),              \</span></div>
<div class="line"><span class="preprocessor">      &amp;(*SM)(34, 0), &amp;(*SM)(35, 0)</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a id="_a21" name="_a21"></a><a class="code hl_struct" href="struct_op_calculate_stress.html">OpCalculateStress</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_calculate_stress.html">OpCalculateStress</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                      boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a22" name="_a22"></a><a class="code hl_struct" href="struct_op_calculate_energy.html">OpCalculateEnergy</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_calculate_energy.html">OpCalculateEnergy</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                      boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">                      SmartPetscObj&lt;Vec&gt; ghost_vec = SmartPetscObj&lt;Vec&gt;());</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line">    SmartPetscObj&lt;Vec&gt; ghostVec;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a23" name="_a23"></a><a class="code hl_struct" href="struct_op_calculate_eshelby_stress.html">OpCalculateEshelbyStress</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_calculate_eshelby_stress.html">OpCalculateEshelbyStress</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt;</div>
<div class="line">  <span class="keyword">struct </span><a id="_a24" name="_a24"></a><a class="code hl_struct" href="struct_op_calculate_homogeneous_stiffness.html">OpCalculateHomogeneousStiffness</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_calculate_homogeneous_stiffness.html">OpCalculateHomogeneousStiffness</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">        boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt;</div>
<div class="line">        blockSetsPtr; <span class="comment">///&lt; Structure keeping data about problem, like</span><span class="comment"></span></div>
<div class="line"><span class="comment">                      ///&lt; material parameters</span></div>
<div class="line"><span class="comment"></span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line">  };</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /** * @brief Assemble mass matrix for elastic element TODO: CHANGE FORMULA *</span></div>
<div class="line"><span class="comment">   * \f[</span></div>
<div class="line"><span class="comment">   * {\bf{M}} = \int\limits_\Omega</span></div>
<div class="line"><span class="comment">   * \f]</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">struct </span><a id="_a25" name="_a25"></a><a class="code hl_struct" href="struct_op_calculate_mass_matrix.html">OpCalculateMassMatrix</a></div>
<div class="line">      : <span class="keyword">public</span> VolumeElementForcesAndSourcesCore::UserDataOperator {</div>
<div class="line"> </div>
<div class="line">    MatrixDouble locK;</div>
<div class="line">    MatrixDouble translocK;</div>
<div class="line">    <a class="code hl_struct" href="struct_block_data.html">BlockData</a> &amp;dAta;</div>
<div class="line">    <a class="code hl_struct" href="struct_convective_mass_element_1_1_block_data.html">MassBlockData</a> &amp;massData;</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; commonData;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_calculate_mass_matrix.html">OpCalculateMassMatrix</a>(<span class="keyword">const</span> std::string row_field,</div>
<div class="line">                          <span class="keyword">const</span> std::string col_field, <a class="code hl_struct" href="struct_block_data.html">BlockData</a> &amp;data,</div>
<div class="line">                          <a class="code hl_struct" href="struct_convective_mass_element_1_1_block_data.html">MassBlockData</a> &amp;mass_data,</div>
<div class="line">                          boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;common_data,</div>
<div class="line">                          <span class="keywordtype">bool</span> symm = <span class="keyword">true</span>)</div>
<div class="line">        : VolumeElementForcesAndSourcesCore::<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(</div>
<div class="line">              row_field, col_field, OPROWCOL, symm),</div>
<div class="line">          commonData(common_data), dAta(data), massData(mass_data) {}</div>
<div class="line"> </div>
<div class="line">    PetscErrorCode doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                          EntityType col_type,</div>
<div class="line">                          EntitiesFieldData::EntData &amp;row_data,</div>
<div class="line">                          EntitiesFieldData::EntData &amp;col_data) {</div>
<div class="line">      <a id="a26" name="a26"></a><a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_tensor2 = [](MatrixDouble &amp;<a id="a27" name="a27"></a><a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a id="a28" name="a28"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">        <span class="keywordflow">return</span> <a id="_a29" name="_a29"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a>(</div>
<div class="line">            &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 0, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 0, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">            &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 0, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 1, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">            &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 1, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 1, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2),</div>
<div class="line">            &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 2, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 2, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">            &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(3 * r + 2, 3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line">      <span class="keywordflow">if</span> (!row_nb_dofs)</div>
<div class="line">        <a id="a30" name="a30"></a><a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line">      <span class="keywordflow">if</span> (!col_nb_dofs)</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">      <span class="keywordflow">if</span> (dAta.<a id="a31" name="a31"></a><a class="code hl_variable" href="struct_block_data.html#a1fcd0017d588eefcbdc769576213b8f3">tEts</a>.find(getFEEntityHandle()) == dAta.<a class="code hl_variable" href="struct_block_data.html#a1fcd0017d588eefcbdc769576213b8f3">tEts</a>.end()) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (massData.<a class="code hl_variable" href="struct_convective_mass_element_1_1_block_data.html#a0f6b9d30c7356f7bdc43f0e0a6763871">tEts</a>.find(getFEEntityHandle()) == massData.<a class="code hl_variable" href="struct_convective_mass_element_1_1_block_data.html#a0f6b9d30c7356f7bdc43f0e0a6763871">tEts</a>.end()) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">bool</span> diagonal_block =</div>
<div class="line">          (row_type == col_type) &amp;&amp; (row_side == col_side);</div>
<div class="line">      <span class="comment">// get number of integration points</span></div>
<div class="line">      <span class="comment">// Set size can clear local tangent matrix</span></div>
<div class="line">      locK.resize(row_nb_dofs, col_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">      locK.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_gauss_pts = row_data.getN().size1();</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_functions = row_data.getN().size2();</div>
<div class="line"> </div>
<div class="line">      <a id="_a32" name="_a32"></a><a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a id="a33" name="a33"></a><a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a id="a34" name="a34"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a id="a35" name="a35"></a><a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a id="a36" name="a36"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> density = massData.<a class="code hl_variable" href="struct_convective_mass_element_1_1_block_data.html#a80d482c09c0814c12ae85e5887dc9cef">rho0</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get integration weights</span></div>
<div class="line">      <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// integrate local matrix for entity block</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != row_nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> t_row_base_func = row_data.getFTensor0N(gg, 0);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Get volume and integration weight</span></div>
<div class="line">        <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * t_w;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row_bb = 0; row_bb != row_nb_dofs / 3; row_bb++) {</div>
<div class="line">          <span class="keyword">auto</span> t_col_base_func = col_data.getFTensor0N(gg, 0);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col_bb = 0; col_bb != col_nb_dofs / 3; col_bb++) {</div>
<div class="line">            <span class="keyword">auto</span> t_assemble = get_tensor2(locK, row_bb, col_bb);</div>
<div class="line">            t_assemble(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) += density * t_row_base_func * t_col_base_func * <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a>;</div>
<div class="line">            <span class="comment">// Next base function for column</span></div>
<div class="line">            ++t_col_base_func;</div>
<div class="line">          }</div>
<div class="line">          <span class="comment">// Next base function for row</span></div>
<div class="line">          ++t_row_base_func;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// Next integration point for getting weight</span></div>
<div class="line">        ++t_w;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a id="a37" name="a37"></a><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getKSPB(), row_data, col_data, &amp;locK(0, 0),</div>
<div class="line">                          ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// is symmetric</span></div>
<div class="line">      <span class="keywordflow">if</span> (row_type != col_type || row_side != col_side) {</div>
<div class="line">        translocK.resize(col_nb_dofs, row_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">        noalias(translocK) = trans(locK);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getKSPB(), col_data, row_data, &amp;translocK(0, 0),</div>
<div class="line">                            ADD_VALUES);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a id="a38" name="a38"></a><a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a39" name="_a39"></a><a class="code hl_struct" href="struct_op_calculate_stiffness_scaled_by_density_field.html">OpCalculateStiffnessScaledByDensityField</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a> {</div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt;</div>
<div class="line">        blockSetsPtr; <span class="comment">///&lt; Structure keeping data about problem, like</span><span class="comment"></span></div>
<div class="line"><span class="comment">                      ///&lt; material parameters</span></div>
<div class="line"><span class="comment"></span>    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; rhoAtGaussPtsPtr;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> rhoN; <span class="comment">///&lt; exponent n in E(p) = E * (p / p_0)^n</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> rHo0; <span class="comment">///&lt; p_0 reference density in E(p) = E * (p / p_0)^n</span></div>
<div class="line">                       <span class="comment">// // where p is density, E - youngs modulus</span></div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <a class="code hl_struct" href="struct_op_calculate_stiffness_scaled_by_density_field.html">OpCalculateStiffnessScaledByDensityField</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">        boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">        boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n,</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a40" name="_a40"></a><a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">               boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">               <span class="keyword">const</span> <span class="keywordtype">char</span> type, <span class="keywordtype">bool</span> symm = <span class="keyword">false</span>);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * \brief Do calculations for give operator</span></div>
<div class="line"><span class="comment">     * @param  row_side row side number (local number) of entity on element</span></div>
<div class="line"><span class="comment">     * @param  col_side column side number (local number) of entity on element</span></div>
<div class="line"><span class="comment">     * @param  row_type type of row entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="comment">     * @param  col_type type of column entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="comment">     * @param  row_data data for row</span></div>
<div class="line"><span class="comment">     * @param  col_data data for column</span></div>
<div class="line"><span class="comment">     * @return          error code</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                          EntityType col_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    <span class="comment">// Finite element stiffness sub-matrix K_ij</span></div>
<div class="line">    MatrixDouble <a class="code hl_variable" href="namespace_mo_f_e_m.html#a0689d2a630ba3cee683b02982b467c77">K</a>;</div>
<div class="line">    MatrixDouble transK;</div>
<div class="line">    VectorDouble nF;</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line"> </div>
<div class="line">    VectorInt rowIndices;</div>
<div class="line">    VectorInt colIndices;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> nbRows;           <span class="comment">///&lt; number of dofs on rows</span></div>
<div class="line">    <span class="keywordtype">int</span> nbCols;           <span class="comment">///&lt; number if dof on column</span></div>
<div class="line">    <span class="keywordtype">int</span> nbIntegrationPts; <span class="comment">///&lt; number of integration points</span></div>
<div class="line">    <span class="keywordtype">bool</span> isDiag;          <span class="comment">///&lt; true if this block is on diagonal</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * \brief Assemble local entity block matrix</span></div>
<div class="line"><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">     * @param  col_data column data (consist base functions on column</span></div>
<div class="line"><span class="comment">     * entity)</span></div>
<div class="line"><span class="comment">     * @return          error code</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> aSsemble(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * \brief Assemble local entity right-hand vector</span></div>
<div class="line"><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">     * @param  col_data column data (consist base functions on column</span></div>
<div class="line"><span class="comment">     * entity)</span></div>
<div class="line"><span class="comment">     * @return          error code</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> aSsemble(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a41" name="_a41"></a><a class="code hl_struct" href="struct_op_rhs__dx.html">OpRhs_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_rhs__dx.html">OpRhs_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">             boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a id="_a42" name="_a42"></a><a class="code hl_struct" href="struct_op_lhs__dx__dx.html">OpLhs_dx_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_lhs__dx__dx.html">OpLhs_dx_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * \brief Integrate B^T D B operator</span></div>
<div class="line"><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">     * @return error code</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a43" name="_a43"></a><a class="code hl_struct" href="struct_op_ale_rhs__dx.html">OpAleRhs_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_ale_rhs__dx.html">OpAleRhs_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a id="_a44" name="_a44"></a><a class="code hl_struct" href="struct_op_ale_lhs__dx__dx.html">OpAleLhs_dx_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_ale_lhs__dx__dx.html">OpAleLhs_dx_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                   boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * \brief Integrate B^T D B operator</span></div>
<div class="line"><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">     * @return error code</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a id="_a45" name="_a45"></a><a class="code hl_struct" href="struct_op_ale_lhs__dx__d_x.html">OpAleLhs_dx_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_ale_lhs__dx__d_x.html">OpAleLhs_dx_dX</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                   boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * \brief Integrate tangent stiffness for spatial momentum</span></div>
<div class="line"><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">     * @return error code</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a46" name="_a46"></a><a class="code hl_struct" href="struct_op_ale_lhs_with_density__dx__d_x.html">OpAleLhsWithDensity_dx_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; rhoAtGaussPtsPtr;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; rhoGradAtGaussPtsPtr;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> rhoN;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> rHo0;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_ale_lhs_with_density__dx__d_x.html">OpAleLhsWithDensity_dx_dX</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line">        boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts,</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; rho_grad_at_gauss_pts,</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * \brief Integrate tangent stiffness for spatial momentum</span></div>
<div class="line"><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">     * @return error code</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a47" name="_a47"></a><a class="code hl_struct" href="struct_op_ale_lhs_with_density__d_x__d_x.html">OpAleLhsWithDensity_dX_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; rhoAtGaussPtsPtr;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; rhoGradAtGaussPtsPtr;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> rhoN;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> rHo0;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_ale_lhs_with_density__d_x__d_x.html">OpAleLhsWithDensity_dX_dX</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line">        boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts,</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; rho_grad_at_gauss_pts,</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * \brief Integrate tangent stiffness for material momentum</span></div>
<div class="line"><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">     * @return error code</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a48" name="_a48"></a><a class="code hl_struct" href="struct_op_ale_rhs__d_x.html">OpAleRhs_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_ale_rhs__d_x.html">OpAleRhs_dX</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a id="_a49" name="_a49"></a><a class="code hl_struct" href="struct_op_ale_lhs__d_x__d_x.html">OpAleLhs_dX_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_ale_lhs__d_x__d_x.html">OpAleLhs_dX_dX</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                   boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * \brief Integrate tangent stiffness for material momentum</span></div>
<div class="line"><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">     * @return error code</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S = 0&gt; <span class="keyword">struct </span><a id="_a50" name="_a50"></a><a class="code hl_struct" href="struct_op_ale_lhs_pre__d_x__dx.html">OpAleLhsPre_dX_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_ale_lhs_pre__d_x__dx.html">OpAleLhsPre_dX_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                      boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a51" name="_a51"></a><a class="code hl_struct" href="struct_op_ale_lhs__d_x__dx.html">OpAleLhs_dX_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_ale_lhs__d_x__dx.html">OpAleLhs_dX_dx</a>(<span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">                   boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">        : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, false) {}</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * \brief Integrate tangent stiffness for material momentum</span></div>
<div class="line"><span class="comment">     * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">     * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">     * @return error code</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt; <span class="keyword">struct </span><a id="_a52" name="_a52"></a><a class="code hl_struct" href="struct_op_analytical_internal_strain__dx.html">OpAnalyticalInternalStrain_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">typedef</span> boost::function&lt;</div>
<div class="line"> </div>
<div class="line">        <a id="_a53" name="_a53"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a>(</div>
<div class="line"> </div>
<div class="line">            <a id="_a54" name="_a54"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1</a>&lt;<a id="_a55" name="_a55"></a><a class="code hl_class" href="class_f_tensor_1_1_pack_ptr.html">FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt; &amp;t_coords</div>
<div class="line"> </div>
<div class="line">            )</div>
<div class="line"> </div>
<div class="line">        &gt;</div>
<div class="line">        StrainFunction;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_analytical_internal_strain__dx.html">OpAnalyticalInternalStrain_dx</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">        StrainFunction strain_fun);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line">    StrainFunction strainFun;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt; <span class="keyword">struct </span><a id="_a56" name="_a56"></a><a class="code hl_struct" href="struct_op_analytical_internal_ale_strain__d_x.html">OpAnalyticalInternalAleStrain_dX</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">typedef</span> boost::function&lt;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a>(</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1</a>&lt;<a class="code hl_class" href="class_f_tensor_1_1_pack_ptr.html">FTensor::PackPtr&lt;double *, 1&gt;</a>, 3&gt; &amp;t_coords</div>
<div class="line"> </div>
<div class="line">            )</div>
<div class="line"> </div>
<div class="line">        &gt;</div>
<div class="line">        StrainFunction;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_analytical_internal_ale_strain__d_x.html">OpAnalyticalInternalAleStrain_dX</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line">        StrainFunction strain_fun,</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; mat_pos_at_pts_ptr);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line">    StrainFunction strainFun;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; matPosAtPtsPtr;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt; <span class="keyword">struct </span><a id="_a57" name="_a57"></a><a class="code hl_struct" href="struct_op_analytical_internal_ale_strain__dx.html">OpAnalyticalInternalAleStrain_dx</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a> {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">typedef</span> boost::function&lt;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a>(</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1</a>&lt;<a class="code hl_class" href="class_f_tensor_1_1_pack_ptr.html">FTensor::PackPtr&lt;double *, 1&gt;</a>, 3&gt; &amp;t_coords</div>
<div class="line"> </div>
<div class="line">            )</div>
<div class="line"> </div>
<div class="line">        &gt;</div>
<div class="line">        StrainFunction;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_analytical_internal_ale_strain__dx.html">OpAnalyticalInternalAleStrain_dx</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line">        StrainFunction strain_fun,</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; mat_pos_at_pts_ptr);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">protected</span>:</div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data);</div>
<div class="line">    StrainFunction strainFun;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; matPosAtPtsPtr;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line">  <span class="keyword">struct </span><a id="_a58" name="_a58"></a><a class="code hl_struct" href="struct_op_post_proc_hooke_element.html">OpPostProcHookeElement</a> : <span class="keyword">public</span> ELEMENT::UserDataOperator {</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; dataAtPts;</div>
<div class="line">    map&lt;int, BlockData&gt;</div>
<div class="line">        &amp;blockSetsPtr; <span class="comment">// FIXME: (works only with the first block)</span></div>
<div class="line">    moab::Interface &amp;postProcMesh;</div>
<div class="line">    std::vector&lt;EntityHandle&gt; &amp;mapGaussPts;</div>
<div class="line">    <span class="keywordtype">bool</span> isALE;</div>
<div class="line">    <span class="keywordtype">bool</span> isFieldDisp;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_op_post_proc_hooke_element.html">OpPostProcHookeElement</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> row_field,</div>
<div class="line">                           boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">                           map&lt;int, BlockData&gt; &amp;block_sets_ptr,</div>
<div class="line">                           moab::Interface &amp;post_proc_mesh,</div>
<div class="line">                           std::vector&lt;EntityHandle&gt; &amp;map_gauss_pts,</div>
<div class="line">                           <span class="keywordtype">bool</span> is_ale = <span class="keyword">false</span>, <span class="keywordtype">bool</span> is_field_disp = <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line">                          EntitiesFieldData::EntData &amp;data);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">  <a id="a59" name="a59"></a><a class="code hl_function" href="_hooke_element_8hpp.html#acbad9d6ebbe635c14d71762f3c5b6fcd">setBlocks</a>(<a id="_a60" name="_a60"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">            boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">  <a id="a61" name="a61"></a><a class="code hl_function" href="_hooke_element_8hpp.html#ada897c167ff3f09114c0d8082e6f8225">addElasticElement</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line">                    <span class="keyword">const</span> std::string element_name, <span class="keyword">const</span> std::string x_field,</div>
<div class="line">                    <span class="keyword">const</span> std::string X_field, <span class="keyword">const</span> <span class="keywordtype">bool</span> ale);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">  <a id="a62" name="a62"></a><a class="code hl_function" href="_hooke_element_8hpp.html#a76d1b67e03b64ca1ae3edb7b0788e578">setOperators</a>(boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_lhs_ptr,</div>
<div class="line">               boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_rhs_ptr,</div>
<div class="line">               boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; block_sets_ptr,</div>
<div class="line">               <span class="keyword">const</span> std::string x_field, <span class="keyword">const</span> std::string X_field,</div>
<div class="line">               <span class="keyword">const</span> <span class="keywordtype">bool</span> ale, <span class="keyword">const</span> <span class="keywordtype">bool</span> field_disp,</div>
<div class="line">               <span class="keyword">const</span> EntityType type = MBTET,</div>
<div class="line">               boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts = <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">  <a id="a63" name="a63"></a><a class="code hl_function" href="_hooke_element_8hpp.html#adc8b2d0d211d4aa4590cf708695ddcaa">calculateEnergy</a>(DM dm, boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; block_sets_ptr,</div>
<div class="line">                  <span class="keyword">const</span> std::string x_field, <span class="keyword">const</span> std::string X_field,</div>
<div class="line">                  <span class="keyword">const</span> <span class="keywordtype">bool</span> ale, <span class="keyword">const</span> <span class="keywordtype">bool</span> field_disp,</div>
<div class="line">                  SmartPetscObj&lt;Vec&gt; &amp;v_energy_ptr);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  MatrixDouble <a id="a64" name="a64"></a><a class="code hl_variable" href="_hooke_element_8hpp.html#ad231e62173ae2a67709c00b3c866a198">invJac</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> D&gt;</div>
<div class="line">HookeElement::OpCalculateStrain&lt;D&gt;::OpCalculateStrain(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line">      dataAtPts(data_at_pts) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> D&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateStrain&lt;D&gt;::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line">                                                          EntityType row_type,</div>
<div class="line">                                                          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">  dataAtPts-&gt;smallStrainMat-&gt;resize(6, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> t_strain = getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;smallStrainMat));</div>
<div class="line">  <span class="keyword">auto</span> t_h = getFTensor2FromMat&lt;3, 3&gt;(*(dataAtPts-&gt;hMat));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">    t_strain(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_h(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2.;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// If displacement field, not field o spatial positons is given</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a id="a65" name="a65"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>) {</div>
<div class="line">      t_strain(0, 0) -= 1;</div>
<div class="line">      t_strain(1, 1) -= 1;</div>
<div class="line">      t_strain(2, 2) -= 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ++t_strain;</div>
<div class="line">    ++t_h;</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line">HookeElement::OpAleLhs_dx_dx&lt;S&gt;::OpAleLhs_dx_dx(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, true) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleLhs_dx_dx&lt;S&gt;::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line">  <span class="comment">// second order tensor</span></div>
<div class="line">  <span class="keyword">auto</span> get_tensor2 = [](MatrixDouble &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a id="a66" name="a66"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a id="a67" name="a67"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <a id="_a68" name="_a68"></a><a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">      <a id="a69" name="a69"></a><a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a id="a70" name="a70"></a><a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// iterate over row base functions</span></div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get sub matrix for the row</span></div>
<div class="line">      <span class="keyword">auto</span> t_m = get_tensor2(K, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <a id="_a71" name="_a71"></a><a class="code hl_class" href="class_f_tensor_1_1_christof.html">FTensor::Christof&lt;double, 3, 3&gt;</a> t_rowD;</div>
<div class="line">      <span class="comment">// I mix up the indices here so that it behaves like a</span></div>
<div class="line">      <span class="comment">// Dg.  That way I don&#39;t have to have a separate wrapper</span></div>
<div class="line">      <span class="comment">// class Christof_Expr, which simplifies things.</span></div>
<div class="line">      t_rowD(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * (<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">      <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// iterate column base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_col_diff_base_pulled;</div>
<div class="line">        t_col_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_col_diff_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_invH(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// integrate block local stiffens matrix</span></div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) += t_rowD(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next column base function</span></div>
<div class="line">        ++t_col_diff_base;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">        ++t_m;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next row base function</span></div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// move to next integration weight</span></div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_D;</div>
<div class="line">    ++t_invH;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line">HookeElement::OpCalculateHomogeneousStiffness&lt;S&gt;::</div>
<div class="line">    OpCalculateHomogeneousStiffness(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">        boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line">      blockSetsPtr(block_sets_ptr), dataAtPts(data_at_pts) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateHomogeneousStiffness&lt;S&gt;::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : (*blockSetsPtr)) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts.find(getFEEntityHandle()) != <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts.end()) {</div>
<div class="line"> </div>
<div class="line">      dataAtPts-&gt;stiffnessMat-&gt;resize(36, 1, <span class="keyword">false</span>);</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">          <a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> young = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.E;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> poisson = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.PoissonRatio;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// coefficient used in intermediate calculation</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> coefficient = young / ((1 + poisson) * (1 - 2 * poisson));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">      t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = 0.;</div>
<div class="line"> </div>
<div class="line">      t_D(0, 0, 0, 0) = 1 - poisson;</div>
<div class="line">      t_D(1, 1, 1, 1) = 1 - poisson;</div>
<div class="line">      t_D(2, 2, 2, 2) = 1 - poisson;</div>
<div class="line"> </div>
<div class="line">      t_D(0, 1, 0, 1) = 0.5 * (1 - 2 * poisson);</div>
<div class="line">      t_D(0, 2, 0, 2) = 0.5 * (1 - 2 * poisson);</div>
<div class="line">      t_D(1, 2, 1, 2) = 0.5 * (1 - 2 * poisson);</div>
<div class="line"> </div>
<div class="line">      t_D(0, 0, 1, 1) = poisson;</div>
<div class="line">      t_D(1, 1, 0, 0) = poisson;</div>
<div class="line">      t_D(0, 0, 2, 2) = poisson;</div>
<div class="line">      t_D(2, 2, 0, 0) = poisson;</div>
<div class="line">      t_D(1, 1, 2, 2) = poisson;</div>
<div class="line">      t_D(2, 2, 1, 1) = poisson;</div>
<div class="line"> </div>
<div class="line">      t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= coefficient;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line">HookeElement::OpCalculateStress&lt;S&gt;::OpCalculateStress(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line">      dataAtPts(data_at_pts) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateStress&lt;S&gt;::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line">                                                          EntityType row_type,</div>
<div class="line">                                                          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_strain = getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;smallStrainMat));</div>
<div class="line">  dataAtPts-&gt;cauchyStressMat-&gt;resize(6, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">      <a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">    t_cauchy_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_strain(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line">    ++t_strain;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_D;</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line">HookeElement::OpLhs_dx_dx&lt;S&gt;::OpLhs_dx_dx(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, true) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpLhs_dx_dx&lt;S&gt;::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                       <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line">  <span class="comment">// second order tensor</span></div>
<div class="line">  <span class="keyword">auto</span> get_tensor2 = [](MatrixDouble &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">      <a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// iterate over row base functions</span></div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get sub matrix for the row</span></div>
<div class="line">      <span class="keyword">auto</span> t_m = get_tensor2(K, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">      <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_christof.html">FTensor::Christof&lt;double, 3, 3&gt;</a> t_rowD;</div>
<div class="line">      <span class="comment">// I mix up the indices here so that it behaves like a</span></div>
<div class="line">      <span class="comment">// Dg.  That way I don&#39;t have to have a separate wrapper</span></div>
<div class="line">      <span class="comment">// class Christof_Expr, which simplifies things.</span></div>
<div class="line">      t_rowD(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * (<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// iterate column base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// integrate block local stiffens matrix</span></div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) += t_rowD(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next column base function</span></div>
<div class="line">        ++t_col_diff_base;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">        ++t_m;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next row base function</span></div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// move to next integration weight</span></div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_D;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line">HookeElement::OpAleLhs_dx_dX&lt;S&gt;::OpAleLhs_dx_dX(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, false) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleLhs_dx_dX&lt;S&gt;::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line">  <span class="comment">// second order tensor</span></div>
<div class="line">  <span class="keyword">auto</span> get_tensor2 = [](MatrixDouble &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;m&#39;</span>, 3&gt; <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;n&#39;</span>, 3&gt; <a id="a72" name="a72"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">      <a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line">  <span class="keyword">auto</span> t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <a id="_a73" name="_a73"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor4.html">FTensor::Tensor4&lt;double, 3, 3, 3, 3&gt;</a> t_F_dX;</div>
<div class="line">    t_F_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = -(t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) * t_invH(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>)) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// iterate over row base functions</span></div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get sub matrix for the row</span></div>
<div class="line">      <span class="keyword">auto</span> t_m = get_tensor2(K, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_stress;</div>
<div class="line">      t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">      <a id="_a74" name="_a74"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_diff_base_pulled_dX;</div>
<div class="line">      t_row_diff_base_pulled_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) =</div>
<div class="line">          -(t_invH(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_row_diff_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_dX_stress;</div>
<div class="line">      t_row_dX_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) =</div>
<div class="line">          <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * (t_row_diff_base_pulled_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_cauchy_stress(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_christof.html">FTensor::Christof&lt;double, 3, 3&gt;</a> t_row_D;</div>
<div class="line">      t_row_D(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = (<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_stress_dX;</div>
<div class="line">      <span class="comment">// FIXME: This operator is not implemented, doing operation by hand</span></div>
<div class="line">      <span class="comment">// t_row_stress_dX(i, m, n) = t_row_D(i, k, l) * t_F_dX(k, l, m, n);</span></div>
<div class="line">      t_row_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mm = 0; mm != 3; ++mm)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 3; ++nn) {</div>
<div class="line">            <span class="keyword">auto</span> &amp;<a id="a75" name="a75"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_row_stress_dX(ii, mm, nn);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk)</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 3; ++ll)</div>
<div class="line">                <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> += t_row_D(ii, kk, ll) * t_F_dX(kk, ll, mm, nn);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">      <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// iterate column base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"> </div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * (t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_dX_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next column base function</span></div>
<div class="line">        ++t_col_diff_base;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">        ++t_m;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next row base function</span></div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// move to next integration weight</span></div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_D;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++t_h;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line">HookeElement::OpAleLhs_dX_dX&lt;S&gt;::OpAleLhs_dX_dX(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, true) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleLhs_dX_dX&lt;S&gt;::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line">  <span class="comment">// second order tensor</span></div>
<div class="line">  <span class="keyword">auto</span> get_tensor2 = [](MatrixDouble &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">        &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;m&#39;</span>, 3&gt; <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;n&#39;</span>, 3&gt; <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">      <a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line">  <span class="keyword">auto</span> t_strain = getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;smallStrainMat));</div>
<div class="line">  <span class="keyword">auto</span> t_eshelby_stress =</div>
<div class="line">      getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;eshelbyStressMat);</div>
<div class="line">  <span class="keyword">auto</span> t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> t_F = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;FMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor4.html">FTensor::Tensor4&lt;double, 3, 3, 3, 3&gt;</a> t_F_dX;</div>
<div class="line">    t_F_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = -(t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) * t_invH(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>)) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor4.html">FTensor::Tensor4&lt;double, 3, 3, 3, 3&gt;</a> t_D_strain_dX;</div>
<div class="line">    t_D_strain_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) = 0.;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; ++jj)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 3; ++ll)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk) {</div>
<div class="line">            <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_D_strain_dX(ii, jj, kk, ll);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mm = 0; mm != 3; ++mm)</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 3; ++nn)</div>
<div class="line">                <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> += t_D(ii, jj, mm, nn) * t_F_dX(mm, nn, kk, ll);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor4.html">FTensor::Tensor4&lt;double, 3, 3, 3, 3&gt;</a> t_eshelby_stress_dX;</div>
<div class="line">    t_eshelby_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) = t_F(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_D_strain_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; ++jj)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mm = 0; mm != 3; ++mm)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 3; ++nn) {</div>
<div class="line">            <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_eshelby_stress_dX(ii, jj, mm, nn);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk)</div>
<div class="line">              <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> += t_F_dX(kk, ii, mm, nn) * t_cauchy_stress(kk, jj);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">    t_eshelby_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= -1;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_energy_dX;</div>
<div class="line">    t_energy_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = t_F_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_cauchy_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    t_energy_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) +=</div>
<div class="line">        (t_strain(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) * t_D(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>)) * t_F_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line">    t_energy_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) /= 2.;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 3; ++ll) {</div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_energy_dX(kk, ll);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line">          t_eshelby_stress_dX(ii, ii, kk, ll) += <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// iterate over row base functions</span></div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get sub matrix for the row</span></div>
<div class="line">      <span class="keyword">auto</span> t_m = get_tensor2(K, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_stress;</div>
<div class="line">      t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_diff_base_pulled_dX;</div>
<div class="line">      t_row_diff_base_pulled_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) =</div>
<div class="line">          -(t_row_diff_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_invH(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>)) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_dX_stress;</div>
<div class="line">      t_row_dX_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) =</div>
<div class="line">          <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * (t_row_diff_base_pulled_dX(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_stress_dX;</div>
<div class="line">      t_row_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) =</div>
<div class="line">          <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">      <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// iterate column base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"> </div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * (t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_dX_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_stress_dX(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next column base function</span></div>
<div class="line">        ++t_col_diff_base;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">        ++t_m;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next row base function</span></div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// move to next integration weight</span></div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_D;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_strain;</div>
<div class="line">    ++t_eshelby_stress;</div>
<div class="line">    ++t_h;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++t_F;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line">HookeElement::OpAleLhsPre_dX_dx&lt;S&gt;::OpAleLhsPre_dX_dx(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line">      dataAtPts(data_at_pts) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleLhsPre_dX_dx&lt;S&gt;::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line">                                                          EntityType row_type,</div>
<div class="line">                                                          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size1();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_eshelby_stress_dx = [<span class="keyword">this</span>, nb_integration_pts]() {</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor4.html">FTensor::Tensor4&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3, 3, 3, 3&gt;</div>
<div class="line">        t_eshelby_stress_dx;</div>
<div class="line">    dataAtPts-&gt;eshelbyStress_dx-&gt;resize(81, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">    <span class="keywordtype">int</span> mm = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; ++jj)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 3; ++ll)</div>
<div class="line">            t_eshelby_stress_dx.ptr(ii, jj, kk, ll) =</div>
<div class="line">                &amp;(*dataAtPts-&gt;eshelbyStress_dx)(mm++, 0);</div>
<div class="line">    <span class="keywordflow">return</span> t_eshelby_stress_dx;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_eshelby_stress_dx = get_eshelby_stress_dx();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;m&#39;</span>, 3&gt; <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;n&#39;</span>, 3&gt; <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">      <a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> t_F = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;FMat);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    t_eshelby_stress_dx(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) =</div>
<div class="line">        (t_F(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_D(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>)) * t_invH(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; ++jj)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mm = 0; mm != 3; ++mm)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 3; ++nn) {</div>
<div class="line">            <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_eshelby_stress_dx(ii, jj, mm, nn);</div>
<div class="line">            <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> += t_invH(nn, ii) * t_cauchy_stress(mm, jj);</div>
<div class="line">          }</div>
<div class="line">    t_eshelby_stress_dx(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= -1;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_energy_dx;</div>
<div class="line">    t_energy_dx(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) = t_invH(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mm = 0; mm != 3; ++mm)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 3; ++nn) {</div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = t_energy_dx(mm, nn);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line">          t_eshelby_stress_dx(ii, ii, mm, nn) += <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    ++t_D;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_eshelby_stress_dx;</div>
<div class="line">    ++t_F;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line">HookeElement::OpPostProcHookeElement&lt;ELEMENT&gt;::OpPostProcHookeElement(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">string</span> row_field, boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">    map&lt;int, BlockData&gt; &amp;block_sets_ptr, moab::Interface &amp;post_proc_mesh,</div>
<div class="line">    std::vector&lt;EntityHandle&gt; &amp;map_gauss_pts, <span class="keywordtype">bool</span> is_ale, <span class="keywordtype">bool</span> is_field_disp)</div>
<div class="line">    : <a id="_a76" name="_a76"></a><a class="code hl_class" href="class_e_l_e_m_e_n_t.html">ELEMENT</a>::<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(row_field, <a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line">      dataAtPts(data_at_pts), blockSetsPtr(block_sets_ptr),</div>
<div class="line">      postProcMesh(post_proc_mesh), mapGaussPts(map_gauss_pts), isALE(is_ale),</div>
<div class="line">      isFieldDisp(is_field_disp) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpPostProcHookeElement&lt;ELEMENT&gt;::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> side, EntityType type, EntitiesFieldData::EntData &amp;data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (type != MBVERTEX) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> tensor_to_tensor = [](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;t1, <span class="keyword">auto</span> &amp;t2) {</div>
<div class="line">    t2(0, 0) = t1(0, 0);</div>
<div class="line">    t2(1, 1) = t1(1, 1);</div>
<div class="line">    t2(2, 2) = t1(2, 2);</div>
<div class="line">    t2(0, 1) = t2(1, 0) = t1(1, 0);</div>
<div class="line">    t2(0, 2) = t2(2, 0) = t1(2, 0);</div>
<div class="line">    t2(1, 2) = t2(2, 1) = t1(2, 1);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  std::array&lt;double, 9&gt; def_val;</div>
<div class="line">  def_val.fill(0);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> make_tag = [&amp;](<span class="keyword">auto</span> name, <span class="keyword">auto</span> size) {</div>
<div class="line">    <a id="_a77" name="_a77"></a><a class="code hl_class" href="class_tag.html">Tag</a> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(name, size, MB_TYPE_DOUBLE, th,</div>
<div class="line">                                       MB_TAG_CREAT | MB_TAG_SPARSE,</div>
<div class="line">                                       def_val.data());</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> th_stress = make_tag(<span class="stringliteral">&quot;STRESS&quot;</span>, 9);</div>
<div class="line">  <span class="keyword">auto</span> th_psi = make_tag(<span class="stringliteral">&quot;ENERGY&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = mapGaussPts.size();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</div>
<div class="line">  <span class="keyword">auto</span> t_H = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;HMat);</div>
<div class="line"> </div>
<div class="line">  dataAtPts-&gt;stiffnessMat-&gt;resize(36, 1, <span class="keyword">false</span>);</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">      <a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"> </div>
<div class="line">  <a id="_a78" name="_a78"></a><a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent = this-&gt;getFEEntityHandle();</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_variable" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> = <a class="code hl_function" href="namespace_mo_f_e_m.html#a01f67868b6366749021d5258535655cd">type_from_handle</a>(ent);</div>
<div class="line">  <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent_3d = ent;</div>
<div class="line">  <span class="keywordflow">if</span> (type == MBTRI || type == MBQUAD) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line">    <span class="keyword">auto</span> &amp;m_field = this-&gt;getPtrFE()-&gt;mField;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().get_adjacencies(&amp;ent, 1, 3, <span class="keyword">false</span>, ents,</div>
<div class="line">                                              moab::Interface::UNION);</div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">    <span class="keywordflow">if</span> (ents.empty())</div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a id="a79" name="a79"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">              <span class="stringliteral">&quot;Could not find a 3D element adjacent to a given face element&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    ent_3d = ents.front();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">bool</span> found_block = <span class="keyword">false</span>;</div>
<div class="line">  <span class="keywordtype">int</span> block_id = -1;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : (blockSetsPtr)) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts.find(ent_3d) != <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts.end()) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> young = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.E;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> poisson = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.PoissonRatio;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> coefficient = young / ((1 + poisson) * (1 - 2 * poisson));</div>
<div class="line">      block_id = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.iD;</div>
<div class="line"> </div>
<div class="line">      t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = 0.;</div>
<div class="line">      t_D(0, 0, 0, 0) = t_D(1, 1, 1, 1) = t_D(2, 2, 2, 2) = 1 - poisson;</div>
<div class="line">      t_D(0, 1, 0, 1) = t_D(0, 2, 0, 2) = t_D(1, 2, 1, 2) =</div>
<div class="line">          0.5 * (1 - 2 * poisson);</div>
<div class="line">      t_D(0, 0, 1, 1) = t_D(1, 1, 0, 0) = t_D(0, 0, 2, 2) = t_D(2, 2, 0, 0) =</div>
<div class="line">          t_D(1, 1, 2, 2) = t_D(2, 2, 1, 1) = poisson;</div>
<div class="line">      t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= coefficient;</div>
<div class="line"> </div>
<div class="line">      found_block = <span class="keyword">true</span>;</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (!found_block)</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Element not found in any of material blocksets&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> def_val_int = 0;</div>
<div class="line">  <a class="code hl_class" href="class_tag.html">Tag</a> tag_mat;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;MAT_ELASTIC&quot;</span>, 1, MB_TYPE_INTEGER, tag_mat,</div>
<div class="line">                                     MB_TAG_CREAT | MB_TAG_SPARSE, &amp;def_val_int);</div>
<div class="line">  <span class="keywordtype">double</span> detH = 0.;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_invH;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_F;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_stress;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_small_strain;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a> t_stress_symm;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a> t_small_strain_symm;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (isFieldDisp) {</div>
<div class="line">      t_h(0, 0) += 1;</div>
<div class="line">      t_h(1, 1) += 1;</div>
<div class="line">      t_h(2, 2) += 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!isALE) {</div>
<div class="line">      t_small_strain_symm(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_h(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2.;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#aead0511cb3151265a11f19e0e9ff8bc9">determinantTensor3by3</a>(t_H, detH);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a7064ec9e939c81c212cc726272c0e088">invertTensor3by3</a>(t_H, detH, t_invH);</div>
<div class="line">      t_F(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      t_small_strain_symm(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_F(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_F(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2.;</div>
<div class="line">      ++t_H;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    t_small_strain_symm(0, 0) -= 1;</div>
<div class="line">    t_small_strain_symm(1, 1) -= 1;</div>
<div class="line">    t_small_strain_symm(2, 2) -= 1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// symmetric tensors need improvement</span></div>
<div class="line">    t_stress_symm(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_small_strain_symm(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line">    tensor_to_tensor(t_stress_symm, t_stress);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> psi = 0.5 * t_stress_symm(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_small_strain_symm(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_psi, &amp;mapGaussPts[gg], 1, &amp;psi);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_stress, &amp;mapGaussPts[gg], 1,</div>
<div class="line">                                     &amp;t_stress(0, 0));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(tag_mat, &amp;mapGaussPts[gg], 1,</div>
<div class="line">                                     &amp;block_id);</div>
<div class="line"> </div>
<div class="line">    ++t_h;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line">HookeElement::OpAnalyticalInternalStrain_dx&lt;S&gt;::OpAnalyticalInternalStrain_dx(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">    StrainFunction strain_fun)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, row_field, data_at_pts, OPROW, true),</div>
<div class="line">      strainFun(strain_fun) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">HookeElement::OpAnalyticalInternalStrain_dx&lt;S&gt;::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tensor1 = [](VectorDouble &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 0), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 1), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  nF.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">  nF.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">      <a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_fun_strain = strainFun(t_coords);</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a> t_stress;</div>
<div class="line">    t_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_fun_strain(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line">      t_nf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">      ++t_nf;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_coords;</div>
<div class="line">    ++t_D;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line">HookeElement::OpAnalyticalInternalAleStrain_dX&lt;S&gt;::</div>
<div class="line">    OpAnalyticalInternalAleStrain_dX(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line">        StrainFunction strain_fun,</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; mat_pos_at_pts_ptr)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, row_field, data_at_pts, OPROW, true),</div>
<div class="line">      strainFun(strain_fun), matPosAtPtsPtr(mat_pos_at_pts_ptr) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAnalyticalInternalAleStrain_dX&lt;S&gt;::iNtegrate(</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tensor1 = [](VectorDouble &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 0), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 1), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_coords = [&amp;]() { <span class="keywordflow">return</span> getFTensor1FromMat&lt;3&gt;(*matPosAtPtsPtr); };</div>
<div class="line">  <span class="keyword">auto</span> t_coords = get_coords();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  nF.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">  nF.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">      <a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line">  <span class="keyword">auto</span> t_F = getFTensor2FromMat&lt;3, 3&gt;(*(dataAtPts-&gt;FMat));</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_fun_strain = strainFun(t_coords);</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a> t_stress;</div>
<div class="line">    t_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_fun_strain(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_eshelby_stress;</div>
<div class="line">    t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -t_F(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_stress(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      t_nf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">      ++t_nf;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_coords;</div>
<div class="line">    ++t_F;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++t_D;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line">HookeElement::OpAnalyticalInternalAleStrain_dx&lt;S&gt;::</div>
<div class="line">    OpAnalyticalInternalAleStrain_dx(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line">        StrainFunction strain_fun,</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; mat_pos_at_pts_ptr)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, row_field, data_at_pts, OPROW, true),</div>
<div class="line">      strainFun(strain_fun), matPosAtPtsPtr(mat_pos_at_pts_ptr) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> S&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAnalyticalInternalAleStrain_dx&lt;S&gt;::iNtegrate(</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tensor1 = [](VectorDouble &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 0), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 1), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_coords = [&amp;]() { <span class="keywordflow">return</span> getFTensor1FromMat&lt;3&gt;(*matPosAtPtsPtr); };</div>
<div class="line">  <span class="keyword">auto</span> t_coords = get_coords();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  nF.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">  nF.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, S&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">      <a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_fun_strain = strainFun(t_coords);</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a> t_stress;</div>
<div class="line">    t_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_fun_strain(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      t_nf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">      ++t_nf;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_coords;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++t_D;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// __HOOKE_ELEMENT_HPP</span></div>
<div class="ttc" id="a_basic_finite_elements_8hpp_html"><div class="ttname"><a href="_basic_finite_elements_8hpp.html">BasicFiniteElements.hpp</a></div></div>
<div class="ttc" id="a_hooke_element_8hpp_html_a76d1b67e03b64ca1ae3edb7b0788e578"><div class="ttname"><a href="_hooke_element_8hpp.html#a76d1b67e03b64ca1ae3edb7b0788e578">setOperators</a></div><div class="ttdeci">static MoFEMErrorCode setOperators(boost::shared_ptr&lt; ForcesAndSourcesCore &gt; fe_lhs_ptr, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; fe_rhs_ptr, boost::shared_ptr&lt; map&lt; int, BlockData &gt; &gt; block_sets_ptr, const std::string x_field, const std::string X_field, const bool ale, const bool field_disp, const EntityType type=MBTET, boost::shared_ptr&lt; DataAtIntegrationPts &gt; data_at_pts=nullptr)</div></div>
<div class="ttc" id="a_hooke_element_8hpp_html_ab02600da9e2ca129f6258b0e880c1e0e"><div class="ttname"><a href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a></div><div class="ttdeci">#define MAT_TO_DDG(SM)</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00142">HookeElement.hpp:142</a></div></div>
<div class="ttc" id="a_hooke_element_8hpp_html_acbad9d6ebbe635c14d71762f3c5b6fcd"><div class="ttname"><a href="_hooke_element_8hpp.html#acbad9d6ebbe635c14d71762f3c5b6fcd">setBlocks</a></div><div class="ttdeci">static MoFEMErrorCode setBlocks(MoFEM::Interface &amp;m_field, boost::shared_ptr&lt; map&lt; int, BlockData &gt; &gt; &amp;block_sets_ptr)</div></div>
<div class="ttc" id="a_hooke_element_8hpp_html_ad231e62173ae2a67709c00b3c866a198"><div class="ttname"><a href="_hooke_element_8hpp.html#ad231e62173ae2a67709c00b3c866a198">invJac</a></div><div class="ttdeci">MatrixDouble invJac</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00683">HookeElement.hpp:683</a></div></div>
<div class="ttc" id="a_hooke_element_8hpp_html_ada897c167ff3f09114c0d8082e6f8225"><div class="ttname"><a href="_hooke_element_8hpp.html#ada897c167ff3f09114c0d8082e6f8225">addElasticElement</a></div><div class="ttdeci">static MoFEMErrorCode addElasticElement(MoFEM::Interface &amp;m_field, boost::shared_ptr&lt; map&lt; int, BlockData &gt; &gt; &amp;block_sets_ptr, const std::string element_name, const std::string x_field, const std::string X_field, const bool ale)</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8cpp_source.html#l00533">HookeElement.cpp:533</a></div></div>
<div class="ttc" id="a_hooke_element_8hpp_html_adc8b2d0d211d4aa4590cf708695ddcaa"><div class="ttname"><a href="_hooke_element_8hpp.html#adc8b2d0d211d4aa4590cf708695ddcaa">calculateEnergy</a></div><div class="ttdeci">static MoFEMErrorCode calculateEnergy(DM dm, boost::shared_ptr&lt; map&lt; int, BlockData &gt; &gt; block_sets_ptr, const std::string x_field, const std::string X_field, const bool ale, const bool field_disp, SmartPetscObj&lt; Vec &gt; &amp;v_energy_ptr)</div></div>
<div class="ttc" id="a_hooke_element_8hpp_html_aee27a2ebc8f3d34a5c1ce71b2607d1a3"><div class="ttname"><a href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a></div><div class="ttdeci">ForcesAndSourcesCore::UserDataOperator UserDataOperator</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00075">HookeElement.hpp:75</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="aclass_e_l_e_m_e_n_t_html"><div class="ttname"><a href="class_e_l_e_m_e_n_t.html">ELEMENT</a></div></div>
<div class="ttc" id="aclass_entity_handle_html"><div class="ttname"><a href="class_entity_handle.html">EntityHandle</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_christof_html"><div class="ttname"><a href="class_f_tensor_1_1_christof.html">FTensor::Christof</a></div><div class="ttdef"><b>Definition</b> <a href="_christof__value_8hpp_source.html#l00009">Christof_value.hpp:10</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_ddg_html"><div class="ttname"><a href="class_f_tensor_1_1_ddg.html">FTensor::Ddg</a></div><div class="ttdef"><b>Definition</b> <a href="_ddg__value_8hpp_source.html#l00007">Ddg_value.hpp:8</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_index_html"><div class="ttname"><a href="class_f_tensor_1_1_index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition</b> <a href="_index_8hpp_source.html#l00023">Index.hpp:24</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_pack_ptr_html"><div class="ttname"><a href="class_f_tensor_1_1_pack_ptr.html">FTensor::PackPtr</a></div><div class="ttdef"><b>Definition</b> <a href="_f_tensor_8hpp_source.html#l00054">FTensor.hpp:55</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor1_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition</b> <a href="_tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor2__symmetric_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric</a></div><div class="ttdef"><b>Definition</b> <a href="_tensor2__symmetric__value_8hpp_source.html#l00013">Tensor2_symmetric_value.hpp:14</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor2_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition</b> <a href="_tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:17</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor3_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor3.html">FTensor::Tensor3</a></div><div class="ttdef"><b>Definition</b> <a href="_tensor3__value_8hpp_source.html#l00012">Tensor3_value.hpp:13</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor4_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor4.html">FTensor::Tensor4</a></div><div class="ttdef"><b>Definition</b> <a href="_tensor4__value_8hpp_source.html#l00018">Tensor4_value.hpp:19</a></div></div>
<div class="ttc" id="aclass_hooke_element_html"><div class="ttname"><a href="class_hooke_element.html">HookeElement</a></div></div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
<div class="ttc" id="aclass_tag_html"><div class="ttname"><a href="class_tag.html">Tag</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_ad8657a5ec76e12f3066fb4b4eb75ace9"><div class="ttname"><a href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a></div><div class="ttdeci">double D</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00044">initial_diffusion.cpp:44</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_afd53743d1af6bfa2856255b23b5a41a9"><div class="ttname"><a href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a></div><div class="ttdeci">const double n</div><div class="ttdoc">refractive index of diffusive medium</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00038">initial_diffusion.cpp:38</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="_exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a01f67868b6366749021d5258535655cd"><div class="ttname"><a href="namespace_mo_f_e_m.html#a01f67868b6366749021d5258535655cd">MoFEM::type_from_handle</a></div><div class="ttdeci">auto type_from_handle(const EntityHandle h)</div><div class="ttdoc">get type from entity handle</div><div class="ttdef"><b>Definition</b> <a href="_templates_8hpp_source.html#l01898">Templates.hpp:1898</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a0689d2a630ba3cee683b02982b467c77"><div class="ttname"><a href="namespace_mo_f_e_m.html#a0689d2a630ba3cee683b02982b467c77">MoFEM::K</a></div><div class="ttdeci">VectorDouble K</div><div class="ttdef"><b>Definition</b> <a href="_projection10_node_coords_on_field_8cpp_source.html#l00125">Projection10NodeCoordsOnField.cpp:125</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a7064ec9e939c81c212cc726272c0e088"><div class="ttname"><a href="namespace_mo_f_e_m.html#a7064ec9e939c81c212cc726272c0e088">MoFEM::invertTensor3by3</a></div><div class="ttdeci">MoFEMErrorCode invertTensor3by3(ublas::matrix&lt; T, L, A &gt; &amp;jac_data, ublas::vector&lt; T, A &gt; &amp;det_data, ublas::matrix&lt; T, L, A &gt; &amp;inv_jac_data)</div><div class="ttdoc">Calculate inverse of tensor rank 2 at integration points.</div><div class="ttdef"><b>Definition</b> <a href="_templates_8hpp_source.html#l01588">Templates.hpp:1588</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a75aed9eb5f422c1955dbbdacb26c2b38"><div class="ttname"><a href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">MoFEM::th</a></div><div class="ttdeci">Tag th</div><div class="ttdef"><b>Definition</b> <a href="_projection10_node_coords_on_field_8cpp_source.html#l00122">Projection10NodeCoordsOnField.cpp:122</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespace_mo_f_e_m.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l01644">EntitiesFieldData.hpp:1644</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_aead0511cb3151265a11f19e0e9ff8bc9"><div class="ttname"><a href="namespace_mo_f_e_m.html#aead0511cb3151265a11f19e0e9ff8bc9">MoFEM::determinantTensor3by3</a></div><div class="ttdeci">MoFEMErrorCode determinantTensor3by3(T1 &amp;t, T2 &amp;det)</div><div class="ttdoc">Calculate determinant 3 by 3.</div><div class="ttdef"><b>Definition</b> <a href="_templates_8hpp_source.html#l01607">Templates.hpp:1607</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a80e685c1c2056739a335dd39b1981ef7"><div class="ttname"><a href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">convert.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="anamespacesdf__wavy__2d_html_ab736ce7138c0ba29f61877ebea4f2bc6"><div class="ttname"><a href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">sdf_wavy_2d.w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition</b> <a href="sdf__wavy__2d_8py_source.html#l00006">sdf_wavy_2d.py:6</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astruct_block_data_html"><div class="ttname"><a href="struct_block_data.html">BlockData</a></div><div class="ttdef"><b>Definition</b> <a href="_elasticity_mixed_formulation_8hpp_source.html#l00012">ElasticityMixedFormulation.hpp:12</a></div></div>
<div class="ttc" id="astruct_block_data_html_a1fcd0017d588eefcbdc769576213b8f3"><div class="ttname"><a href="struct_block_data.html#a1fcd0017d588eefcbdc769576213b8f3">BlockData::tEts</a></div><div class="ttdeci">Range tEts</div><div class="ttdef"><b>Definition</b> <a href="_elasticity_mixed_formulation_8hpp_source.html#l00017">ElasticityMixedFormulation.hpp:17</a></div></div>
<div class="ttc" id="astruct_convective_mass_element_1_1_block_data_html"><div class="ttname"><a href="struct_convective_mass_element_1_1_block_data.html">ConvectiveMassElement::BlockData</a></div><div class="ttdoc">data for calculation inertia forces</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00061">HookeElement.hpp:61</a></div></div>
<div class="ttc" id="astruct_convective_mass_element_1_1_block_data_html_a0f6b9d30c7356f7bdc43f0e0a6763871"><div class="ttname"><a href="struct_convective_mass_element_1_1_block_data.html#a0f6b9d30c7356f7bdc43f0e0a6763871">ConvectiveMassElement::BlockData::tEts</a></div><div class="ttdeci">Range tEts</div><div class="ttdoc">elements in block set</div><div class="ttdef"><b>Definition</b> <a href="_convective_mass_element_8hpp_source.html#l00119">ConvectiveMassElement.hpp:119</a></div></div>
<div class="ttc" id="astruct_convective_mass_element_1_1_block_data_html_a80d482c09c0814c12ae85e5887dc9cef"><div class="ttname"><a href="struct_convective_mass_element_1_1_block_data.html#a80d482c09c0814c12ae85e5887dc9cef">ConvectiveMassElement::BlockData::rho0</a></div><div class="ttdeci">double rho0</div><div class="ttdoc">reference density</div><div class="ttdef"><b>Definition</b> <a href="_convective_mass_element_8hpp_source.html#l00117">ConvectiveMassElement.hpp:117</a></div></div>
<div class="ttc" id="astruct_convective_mass_element_1_1_block_data_html_a80e4eca8e8e2d8cc16950f37180c33e9"><div class="ttname"><a href="struct_convective_mass_element_1_1_block_data.html#a80e4eca8e8e2d8cc16950f37180c33e9">ConvectiveMassElement::BlockData::a0</a></div><div class="ttdeci">VectorDouble a0</div><div class="ttdoc">constant acceleration</div><div class="ttdef"><b>Definition</b> <a href="_convective_mass_element_8hpp_source.html#l00118">ConvectiveMassElement.hpp:118</a></div></div>
<div class="ttc" id="astruct_convective_mass_element_html"><div class="ttname"><a href="struct_convective_mass_element.html">ConvectiveMassElement</a></div><div class="ttdoc">structure grouping operators and data used for calculation of mass (convective) element \ nonlinear_e...</div><div class="ttdef"><b>Definition</b> <a href="_convective_mass_element_8hpp_source.html#l00028">ConvectiveMassElement.hpp:28</a></div></div>
<div class="ttc" id="astruct_data_at_integration_pts_html"><div class="ttname"><a href="struct_data_at_integration_pts.html">DataAtIntegrationPts</a></div><div class="ttdef"><b>Definition</b> <a href="_elasticity_mixed_formulation_8hpp_source.html#l00020">ElasticityMixedFormulation.hpp:20</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_a0488e04e389071c795c0233b028de015"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">MoFEM::EntitiesFieldData::EntData::getFTensor1DiffN</a></div><div class="ttdeci">FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, Tensor_Dim &gt;, Tensor_Dim &gt; getFTensor1DiffN(const FieldApproximationBase base)</div><div class="ttdoc">Get derivatives of base functions.</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8cpp_source.html#l00526">EntitiesFieldData.cpp:526</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_a6803bfc79169740e108bd5e2666de739"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">MoFEM::EntitiesFieldData::EntData::getN</a></div><div class="ttdeci">MatrixDouble &amp; getN(const FieldApproximationBase base)</div><div class="ttdoc">get base functions this return matrix (nb. of rows is equal to nb. of Gauss pts, nb....</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l01318">EntitiesFieldData.hpp:1318</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition</b> <a href="_volume_element_forces_and_sources_core_8hpp_source.html#l00109">VolumeElementForcesAndSourcesCore.hpp:110</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_block_data_html"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_block_data.html">NonlinearElasticElement::BlockData</a></div><div class="ttdoc">data for calculation heat conductivity and heat capacity elements</div><div class="ttdef"><b>Definition</b> <a href="_non_linear_elastic_element_8hpp_source.html#l00084">NonLinearElasticElement.hpp:84</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_block_data_html_a0d20590055637c87ad4102befe2fbf63"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_block_data.html#a0d20590055637c87ad4102befe2fbf63">NonlinearElasticElement::BlockData::forcesOnlyOnEntitiesRow</a></div><div class="ttdeci">Range forcesOnlyOnEntitiesRow</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00037">HookeElement.hpp:37</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_block_data_html_a13c65beb8ac81c83ea156ea7b2c9e67d"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_block_data.html#a13c65beb8ac81c83ea156ea7b2c9e67d">NonlinearElasticElement::BlockData::PoissonRatio</a></div><div class="ttdeci">double PoissonRatio</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00035">HookeElement.hpp:35</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_block_data_html_a3ace669cc0a863e24507ab148fa076e8"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_block_data.html#a3ace669cc0a863e24507ab148fa076e8">NonlinearElasticElement::BlockData::E</a></div><div class="ttdeci">double E</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00034">HookeElement.hpp:34</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_block_data_html_a5f054b9b0e9aaab6ced590aaf49e8237"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_block_data.html#a5f054b9b0e9aaab6ced590aaf49e8237">NonlinearElasticElement::BlockData::forcesOnlyOnEntitiesCol</a></div><div class="ttdeci">Range forcesOnlyOnEntitiesCol</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00038">HookeElement.hpp:38</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_block_data_html_af42f782f66b80d745ba30bc8f20a6a15"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_block_data.html#af42f782f66b80d745ba30bc8f20a6a15">NonlinearElasticElement::BlockData::tEts</a></div><div class="ttdeci">Range tEts</div><div class="ttdoc">constrains elements in block set</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00036">HookeElement.hpp:36</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_1_1_block_data_html_af5b66ddec9ecb4867174e6472ec3be9d"><div class="ttname"><a href="struct_nonlinear_elastic_element_1_1_block_data.html#af5b66ddec9ecb4867174e6472ec3be9d">NonlinearElasticElement::BlockData::iD</a></div><div class="ttdeci">int iD</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00033">HookeElement.hpp:33</a></div></div>
<div class="ttc" id="astruct_nonlinear_elastic_element_html"><div class="ttname"><a href="struct_nonlinear_elastic_element.html">NonlinearElasticElement</a></div><div class="ttdoc">structure grouping operators and data used for calculation of nonlinear elastic element</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00027">HookeElement.hpp:27</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs__d_x__d_x_html"><div class="ttname"><a href="struct_op_ale_lhs__d_x__d_x.html">OpAleLhs_dX_dX</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00521">HookeElement.hpp:521</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs__d_x__dx_html"><div class="ttname"><a href="struct_op_ale_lhs__d_x__dx.html">OpAleLhs_dX_dx</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00547">HookeElement.hpp:547</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs__dx__d_x_html"><div class="ttname"><a href="struct_op_ale_lhs__dx__d_x.html">OpAleLhs_dx_dX</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00449">HookeElement.hpp:449</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs__dx__dx_html"><div class="ttname"><a href="struct_op_ale_lhs__dx__dx.html">OpAleLhs_dx_dx</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00434">HookeElement.hpp:434</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs_pre__d_x__dx_html"><div class="ttname"><a href="struct_op_ale_lhs_pre__d_x__dx.html">OpAleLhsPre_dX_dx</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00536">HookeElement.hpp:536</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs_with_density__d_x__d_x_html"><div class="ttname"><a href="struct_op_ale_lhs_with_density__d_x__d_x.html">OpAleLhsWithDensity_dX_dX</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00488">HookeElement.hpp:488</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs_with_density__dx__d_x_html"><div class="ttname"><a href="struct_op_ale_lhs_with_density__dx__d_x.html">OpAleLhsWithDensity_dx_dX</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00464">HookeElement.hpp:464</a></div></div>
<div class="ttc" id="astruct_op_ale_rhs__d_x_html"><div class="ttname"><a href="struct_op_ale_rhs__d_x.html">OpAleRhs_dX</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00512">HookeElement.hpp:512</a></div></div>
<div class="ttc" id="astruct_op_ale_rhs__dx_html"><div class="ttname"><a href="struct_op_ale_rhs__dx.html">OpAleRhs_dx</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00425">HookeElement.hpp:425</a></div></div>
<div class="ttc" id="astruct_op_analytical_internal_ale_strain__d_x_html"><div class="ttname"><a href="struct_op_analytical_internal_ale_strain__d_x.html">OpAnalyticalInternalAleStrain_dX</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00586">HookeElement.hpp:586</a></div></div>
<div class="ttc" id="astruct_op_analytical_internal_ale_strain__dx_html"><div class="ttname"><a href="struct_op_analytical_internal_ale_strain__dx.html">OpAnalyticalInternalAleStrain_dx</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00611">HookeElement.hpp:611</a></div></div>
<div class="ttc" id="astruct_op_analytical_internal_strain__dx_html"><div class="ttname"><a href="struct_op_analytical_internal_strain__dx.html">OpAnalyticalInternalStrain_dx</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00563">HookeElement.hpp:563</a></div></div>
<div class="ttc" id="astruct_op_assemble_html"><div class="ttname"><a href="struct_op_assemble.html">OpAssemble</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00340">HookeElement.hpp:340</a></div></div>
<div class="ttc" id="astruct_op_calculate_energy_html"><div class="ttname"><a href="struct_op_calculate_energy.html">OpCalculateEnergy</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00164">HookeElement.hpp:164</a></div></div>
<div class="ttc" id="astruct_op_calculate_eshelby_stress_html"><div class="ttname"><a href="struct_op_calculate_eshelby_stress.html">OpCalculateEshelbyStress</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00177">HookeElement.hpp:177</a></div></div>
<div class="ttc" id="astruct_op_calculate_homogeneous_stiffness_html"><div class="ttname"><a href="struct_op_calculate_homogeneous_stiffness.html">OpCalculateHomogeneousStiffness</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00190">HookeElement.hpp:190</a></div></div>
<div class="ttc" id="astruct_op_calculate_mass_matrix_html"><div class="ttname"><a href="struct_op_calculate_mass_matrix.html">OpCalculateMassMatrix</a></div><div class="ttdoc">Assemble mass matrix for elastic element TODO: CHANGE FORMULA *.</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00212">HookeElement.hpp:213</a></div></div>
<div class="ttc" id="astruct_op_calculate_stiffness_scaled_by_density_field_html"><div class="ttname"><a href="struct_op_calculate_stiffness_scaled_by_density_field.html">OpCalculateStiffnessScaledByDensityField</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00318">HookeElement.hpp:318</a></div></div>
<div class="ttc" id="astruct_op_calculate_strain_ale_html"><div class="ttname"><a href="struct_op_calculate_strain_ale.html">OpCalculateStrainAle</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00130">HookeElement.hpp:130</a></div></div>
<div class="ttc" id="astruct_op_calculate_strain_html"><div class="ttname"><a href="struct_op_calculate_strain.html">OpCalculateStrain</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00119">HookeElement.hpp:119</a></div></div>
<div class="ttc" id="astruct_op_calculate_stress_html"><div class="ttname"><a href="struct_op_calculate_stress.html">OpCalculateStress</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00153">HookeElement.hpp:153</a></div></div>
<div class="ttc" id="astruct_op_lhs__dx__dx_html"><div class="ttname"><a href="struct_op_lhs__dx__dx.html">OpLhs_dx_dx</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00410">HookeElement.hpp:410</a></div></div>
<div class="ttc" id="astruct_op_post_proc_hooke_element_html"><div class="ttname"><a href="struct_op_post_proc_hooke_element.html">OpPostProcHookeElement</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00637">HookeElement.hpp:637</a></div></div>
<div class="ttc" id="astruct_op_rhs__dx_html"><div class="ttname"><a href="struct_op_rhs__dx.html">OpRhs_dx</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00401">HookeElement.hpp:401</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.12.0
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>
